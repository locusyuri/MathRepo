# 微分
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:组合数公式</span>
>从 n 个不同元素中，任取 k(k≤n) 个元素并成一组，叫作从 n 个不同元素中取出 k 个元素的一个组合；从 n 个不同元素中取出 k(k≤n) 个元素的所有组合的个数，叫作 n 个不同元素中取出 k 个元素的组合数。用符号 $\mathrm{C^k_{n}}$ 表示。
>$n,k\in \mathbb{N^*},k\le n$
>$\Large{\mathrm{C_{n}^k}=\frac{\mathrm{A^k_{n}}}{k!}=\frac{n!}{k!(n-k)!}=\frac{n(n-1)\dots(n-k+1)}{k!}}$
>$\mathrm{C^k_{n}}=\mathrm{C^{n-k}_{n}}$
>$\mathrm{C_{n+1}^k}=\mathrm{C_{n}^k}+\mathrm{C^{k-1}_{n}}$
>>[!note] 
>>可以理解为从n+1个中取k个可以先拿出一个元素A：1)包含A的取法$\mathrm{C_{n}^{k-1}}$种； 2)不包含A的取法$\mathrm{C_{n}^k}$种
>$n!! =\begin{cases}n(n-2)(n-4)\dots6\cdot4\cdot2,n=2k\\n(n-2)(n-4)\dots5\cdot3\cdot1,n=2k+1\end{cases}$
>可推广到n不为正整数的情况。



## 1 微商
### 1.1 微分与导数
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：微分」</span>
> <img style="width:60%" src="https://locus622.oss-cn-beijing.aliyuncs.com/img/202410262049513.png">
> 对函数$y=f(x)$定义域中的一点$x_{0}$，若存在一个只与$x_{0}$有关，而与$\Updelta x$无关的数$g(x_{0})$，使得当$\Updelta x\to0$时恒成立关系式:
> $\Updelta y=g(x_{0})\Updelta x+o(\Updelta x)\qquad$($g(x_{0})\Updelta x$称为$\Updelta y$的线性主要部分)
> 则称$f(x)$在$x_{0}$处的微分存在，或$f(x)$在$x_{0}$处可微。
> 若函数$y=f(x)$在某区间的每一点上都可微，则称$f(x)$在该区间上可微
>
> >[!note] 
> >闭区间上的可微性需要引入单侧导数
>
> >[!tip] 
> >显然，$g(x_{0})$是当$\Updelta x\to0$时，因变量的差分与自变量的差分之比$\frac{\Updelta y}{\Updelta x}$的极限值。
>
> 当$f(x)$在$x$处可微且$\Updelta x\to0$时，将$\Updelta x$称为自变量的微分，记为$\mathrm{d}x$;而将$\Updelta y$的线性主要部分$g(x)\Updelta x$称为因变量的微分，记作$\mathrm{d}y$，因而就有：$\mathrm{d}y=g(x)\mathrm{d}x$，**$dy$的几何意义是该点切线的纵坐标增量。**

>[!note] 
>可微必定连续，但连续不一定可微。
>$f(x)$在$x_{0}$处可微，则在$x_{0}$处连续。 

>[!example] 
>Weierstrass函数：$W(x)=\sum\limits_{n=0}^{\infty}a^n\cos(b^n\pi x),a\in(0,1),b=2k+1(k\in \mathbb{N})$
><img style="width:50%" src="https://pics.latexstudio.net/uploads/20210903/6131f2bac94c8/latexc__images/1.png">
>
>处处连续不可微


> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：导数」</span>
> 若函数$y=f(x)$在其定义域中的一点$x_{0}$处极限
> $\huge{\lim_\limits{ \Updelta x \to  0 } \frac{\Updelta y}{\Updelta x}=\lim_\limits{ \Updelta x \to  0 } \frac{f(x_{0}+\Updelta x)-f(x_{0})}{\Updelta x}}$
> 存在，则称$f(x)$在$x_{0}$处可导，并称这个极限值为$f(x)$在$x_{0}$处的导数，记为$f'(x_{0})$(或$y'(x_{0}), \frac{\mathrm{d}f}{\mathrm{d}x}|_{x=x_{0}},\frac{\mathrm{d}y}{\mathrm{d}x}|_{x=x_{0}}$)
> >[!note] 
> >可微和可导都隐含了一个前提条件：函数在$x_{0}$的某个邻域内有定义。
> >若函数$y=f(x)$在某区间的每一点上都可导，则称$f(x)$在该区间上可导
> 
> >[!note] 
> >$f(x)$在$x_{0}$处导数的等价定义：$f'(x_{0})=\lim_\limits{ x \to  x_0 } \frac{f(x)-f(x_{0})}{x-x_{0}}$

>[!tip] 
>约定记号$D_{(a,b)}=\{f(x)在(a,b)上可导\}$(derivative)
>$D_{(a,b)}=\{f(x)在(a,b)上可微\}$(diffential)
>$D^{(2)}_{(a,b)}=\{f(x)在(a,b)上二阶可导\}$


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:可微与可导的等价</span>
>函数$y=f(x)$在$x$处可微的充分必要条件是它在$x$处可导，即对于一元函数，在任一点的可微性与可导性是等价的。

>[!tip] 
>可微和可导中的$\Delta x$均不为零

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\Longrightarrow:$已知函数$f(x)$在$x_{0}$处$\Updelta y=g(x_{0})\Updelta x+o(\Updelta x)$，当$\Updelta x\ne0$时，两边同除以$\Updelta x$，有$\frac{\Updelta y}{\Updelta x}=g(x_{0})+\frac{o(\Updelta x)}{\Updelta x}$，显然$\frac{\Updelta y}{\Updelta x}$极限存在且为$g(x_{0})$
$\Longleftarrow:$设$\lim_\limits{ \Updelta x \to  0 } \frac{\Updelta y}{\Updelta x}=f'(x_{0})$，即$\frac{\Updelta y}{\Updelta x}=f'(x_{0})+o(1)$，故$\Updelta y=f'(x_{0})\Updelta x+o(1)\Updelta x$
证毕
>[!note] 
>极限的无穷小等价表示：$\lim_\limits{ x \to  x_0 }f(x)=A\Longleftrightarrow f(x)=A+o(1)\quad(x\to x_{0})$

>[!note] 
>$\Updelta y=f'(x_{0})\Updelta x+o(\Updelta x)(\Updelta x\to0)$称为**无穷小增量公式**。



> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：单侧导数」</span>
> $f(x)$在$x_{0}$处的左导数：$f_{-}'(x_{0})=\lim_\limits{\Updelta x \to  0- } \frac{f(x)-f(x_{0})}{\Updelta x}$
> $f(x)$在$x_{0}$处的右导数：$f_{+}'(x_{0})=\lim_\limits{\Updelta x \to  0+ } \frac{f(x)-f(x_{0})}{\Updelta x}$
> $f(x)$在$x_{0}$处可导的充分必要条件是该点的左导数和右导数存在且相等。
> 但是$f(x)$在$x_{0}$处连续的充分必要条件是该点的左导数和右导数都存在(无论它们是否相等，比如$f(x)=|x|,x_{0}=0$)


>[!warning] 
>注意区分：
>$f'_{+}(x_{0}):f(x)在x_{0}的右导数;f'(x_{0}^+):导函数在x_{0}的极限$



<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
设函数$f(x)$在$x=0$处连续，并且$\lim_\limits{ x \to  0 } \frac{f(2x)-f(x)}{x}=A$，求证：$f'(0)$存在，且$f'(0)=A$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
即证$\lim_\limits{ x \to 0} \frac{f(x)-f(0)}{x}=A$
由于$\lim_\limits{ x \to  0 } \frac{f(2x)-f(x)}{x}=A$，即$\forall \varepsilon>0,\exists\delta>0,\forall|x|<\delta:A-\frac{\varepsilon}{2}<\frac{f(2x)-f(x)}{x}<A+\frac{\varepsilon}{2}$
特别，且$x_{n}=\frac{x}{2^k}(k\in \mathbb{N})$，上式仍然成立，因此
$\frac{1}{2^k}\left( A-\frac{\varepsilon}{2} \right)<\frac{f\left( \frac{x}{2^{k-1}} \right)-f\left( \frac{x}{2^k} \right)}{x}< \frac{1}{2^k}\left( A+\frac{\varepsilon}{2} \right)$
将此n式相加，有
$\sum\limits_{k=1}^{n}\left[ f\left( \frac{x}{2^{k-1}} \right)-f\left( \frac{x}{2^k} \right) \right]=f(x)-f\left( \frac{x}{2^n} \right)=f(x)-f(x_{n})$
$\sum\limits_{k=1}^{n} \frac{1}{2^k}=1-\frac{1}{2^n}$
有$\left( 1-\frac{1}{2^n} \right)\left( A-\frac{\varepsilon}{2} \right)<\frac{f(x)-f(x_{n})}{x}< \left(1- \frac{1}{2^n} \right)\left( A+\frac{\varepsilon}{2} \right)$
再令$n\to \infty$取极限，这时有$x_{n}=\frac{x}{2^n}\to0$，而$f(x)$在$x=0$处连续，$\lim_\limits{ n \to \infty }f(x_{n})=f(0)$，故：
$A-\frac{\varepsilon}{2}< \frac{f(x)-f(0)}{x} <A+\frac{\varepsilon}{2}$
亦即$|\frac{f(x)-f(0)}{x}-A|\leqslant \frac{\varepsilon}{2}<\varepsilon$，$f'(0)$存在且$f'(0)=A$
证毕

### 1.2 导数的性质与运算
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:导数的线性运算</span>
>设函数$f(x),g(x)$在某一区间上都是可导的，则对于任意常数$c_{1},c_{2}$,它们的线性组合$c_{1}f(x)+c_{2}g(x)$在该区间上也是可导的，且满足：$[c_{1}f(x)+c_{2}g(x)]'=c_{1}f'(x)+c_{2}g'(x)$
>微分形式为：$d[c_{1}f(x)+c_{2}g(x)]=c_{1}d[f(x)]+c_{2}d[g(x)]$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\begin{align}&[c_{1}f(x)+c_{2}g(x)]'\\&=\lim_\limits{ \Updelta x \to  0 } \frac{[c_{1}f(x+\Updelta x)+c_{2}g(x+\Updelta x)]-[c_{1}f(x)+c_{2}g(x)]}{\Updelta x}\\&=c_{1}\lim_\limits{ \Updelta x \to  0 } \frac{f(x+\Updelta x)-f(x)}{\Updelta x}+c_{2}\lim_\limits{ \Updelta x \to  0 } \frac{g(x+\Updelta x)-g(x)}{\Updelta x}\\&=c_{1}f'(x)+c_{2}g'(x)\end{align}$
证毕

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:积函数求导法则</span>
>设函数$f(x),g(x)$在某一区间上都是可导的，则它们的积函数在该区间上也是可导的，且满足：$[f(x)g(x)]'=f'(x)g(x)=f(x)g'(x)$
>微分形式为：$d[f(x)g(x)]=g(x)d[f(x)]+f(x)d[g(x)]$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
由于
$\begin{align}& \frac{f(x+\Updelta x)g(x+\Updelta x)-f(x)g(x)}{\Updelta x}\\&=\frac{f(x+\Updelta x)g(x+\Updelta x)-f(x+\Updelta x)g(x)+f(x+\Updelta x)g(x)-f(x)g(x)}{\Updelta x}\\&=f(x+\Updelta x) \frac{g(x+\Updelta x)-g(x)}{\Updelta x}+g(x) \frac{f(x+\Updelta x)-f(x)}{\Updelta x}\end{align}$
故$[f(x)g(x)]'=\lim_\limits{ \Updelta x \to  0 }f(x+\Updelta x)\lim_\limits{ \Updelta x \to  0 }\frac{g(x+\Updelta x)-g(x)}{\Updelta x}+g(x)\lim_\limits{ \Updelta x \to  0 }\frac{f(x+\Updelta x)-f(x)}{\Updelta x}=f'(x)g(x)+f(x)g'(x)$
证毕


>[!note] 
>上述两个定理可以推广到多个函数的情况：
>1. $\left[ \sum\limits^{n}_{i=1} c_{i}f_{i}(x) \right]'=\sum\limits^{n}_{i=1} c_{i}f_{i}'(x),\qquad c_{i}$为常数
>2. $\left[ \prod\limits_{i=1}^n f_{i}'(x) \right]'=\sum\limits^{n}_{j=1}\left\{ f'_{j}(x)\prod\limits^{n}_{i=1,i\ne j}f_{i}(x) \right\}$
>可以使用数学归纳法证明



><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:倒函数求导法则</span>
>设函数$g(x)$在某一区间上是可导的，且$g(x)\ne0$，则它的倒数在该区间上也是可导的，且满足：$\left[ \frac{1}{g(x)} \right]'=\frac{g'(x)}{[g(x)]^2}$
>微分形式为：$d\left[ \frac{1}{g(x)} \right]=\frac{d[g(x)]}{[g(x)]^2}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\left[ \frac{1}{g(x)} \right]'=\lim_\limits{ \Updelta x \to  0 } \frac{\frac{1}{g(x+\Updelta x)}-\frac{1}{g(x)}}{\Updelta x}=\lim_\limits{ \Updelta x \to  0 } \frac{g(x)-g(x+\Updelta x)}{g(x+\Updelta x)g(x)\Updelta x}=-\frac{1}{g(x)}\left( \lim_\limits{ \Updelta x \to  0 } \frac{g(x+\Updelta x)-g(x)}{\Updelta x} \right)\left( \lim_\limits{ \Updelta x \to  0 } \frac{1}{g(x+\Updelta x)} \right)$
又有$\lim_\limits{ \Updelta x \to  0 }g(x+\Updelta x)=g(x)\ne0$
证毕

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:商函数求导法则</span>
>设函数$f(x),g(x)$在某一区间上都是可导的，且$g(x)\ne0$，则它们的商函数在该区间上也是可导的，且满足：$\left[ \frac{f(x)}{g(x)} \right]'=\frac{f'(x)g(x)-f(x)g'(x)}{[g(x)]^2}$
>微分形式为：$d\left[ \frac{f(x)}{g(x)} \right]=\frac{g(x)d[f(x)]-f(x)d[g(x)]}{[g(x)]^2}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
由积函数和倒函数求导法则易得。
证毕

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:反函数求导法则</span>
>若函数$y=f(x)$在$(a,b)$上连续、严格单调递增、可导，且$f'(x)\ne0$，则它的反函数在$(f(a+),g(b-))$上可导，且有：$[f^{-1}(y)]'=\frac{1}{f'(x)}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
由反函数连续性定理，$x=f^{-1}(y)$在$(f(a+),g(b-))$连续、严格单调递增，这时$\Updelta y=f(x+\Updelta x)-f(x)\ne0$等价于$\Updelta x=f^{-1}(y+\Updelta y)-f^{-1}(y)\ne0$，且$\Updelta y\to0$时有$\Updelta x\to0$，于是：
$[f^{-1}(y)]'=\lim_\limits{ \Updelta y \to  0 } \frac{f^{-1}(y+\Updelta y)-f^{-1}(y)}{\Updelta y}=\lim_\limits{ \Updelta x \to  0 } \frac{\Updelta x}{f(x+\Updelta x)-f(x)}=\frac{1}{f'(x)}$
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
求$y=\arctan x$的导函数
<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Solution：</span>
$x=\tan y$满足反函数求导法则的所有条件，将$y=\arctan x$看作它的反函数，于是有：
$(\arctan x)'=\frac{1}{(\tan y)'}=\frac{1}{\sec^2 y}=\frac{1}{1+\tan^2 x}=\frac{1}{1+x^2}$



><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:复合函数求导法则</span>
>设函数$u=g(x)$在$x=x_{0}$处可导，而函数$y=f(u)$在$u=u_{0}=g(x_{0})$处可导，则复合函数$y=f(g(x))$在$x=x_{0}$处可导，且$[f(g(x))]'_{x=x_{0}}=f'(u_{0})g'(x_{0})=f'(g(x_{0}))g'(x_{0})$
>微分形式为：$\frac{dy}{dx}=\frac{dy}{du}\cdot \frac{du}{dx}$，一般称为链式法则，链式法则也可以推广到多重复合函数的情况。

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
由于函数$y=f(u)$在$u=u_{0}=g(x_{0})$处可导，故在该点可微，即当$\Updelta u\to0$且$\Updelta u\ne0$时：$\Updelta y=f(u_{0}+\Updelta u)-f(u_{0})=f'(u_{0})\Updelta u+o(1)\Updelta u$
其中，$\lim_\limits{ \Updelta u \to  0 }o(1)=0$,由于$\Updelta u=0$时$\Updelta y=0$，补充定义：当$\Updelta u=0$时$o(1)=0$
设$\Updelta u=g(x_{0}+\Updelta x)-g(x_{0})(\Updelta x\ne0)$，上式两边同时除以$\Updelta x$，有： 
$\frac{f(g(x_{0}+\Updelta x))-f(g(x_{0}))}{\Updelta x}=f'(u_{0}) \frac{\Updelta u}{\Updelta x}+o(1)\frac{\Updelta u}{\Updelta x}$
由函数$u=g(x)$在$x=x_{0}$处可导，有$\lim_\limits{ \Updelta x \to  0 } \frac{\Updelta u}{\Updelta x}=g'(x_{0})$,此式也蕴含了$\lim_\limits{ \Updelta x \to  0 }\Updelta u=0$
在$\Updelta x$趋于0的过程中，或者有$\Updelta u=0$，此时有$o(1)=0$；或者有$\Updelta u\ne0$，但$\Updelta u\to0$，因此由$\lim_\limits{ \Updelta u \to  0 }o(1)=0$有$\lim_\limits{ \Updelta x \to  0 }o(1)=0$
于是$\frac{dy}{dx}=f'(u_{0})\lim_\limits{ \Updelta x \to  0 } \frac{\Updelta u}{\Updelta x}+\lim_\limits{ \Updelta x \to  0 }o(1)\lim_\limits{ \Updelta x \to  0 }\frac{\Updelta u}{\Updelta x}=f'(u_{0})g'(x_{0})$
证毕

>[!tip] 
>关键在于由$\lim_\limits{ \Updelta u \to  0 }o(1)=0$得到$\lim_\limits{ \Updelta x \to  0 }o(1)=0$



==导数运算法则==

|      | 导数运算法则                                            | 微分运算法则                                            |
| ---- | ------------------------------------------------- | ------------------------------------------------- |
| 线性组合 | $(c_{1}f+c_{2}g)'=c_{1}f'+c_{2}g'$                | $d(c_{1}f+c_{2}g)=c_{1}df+c_{2}dg$                |
| 乘法   | $(fg)'=f'g+fg'$                                   | $d(fg)=gdf+fdg$                                   |
| 除法   | $\left( \frac{f}{g} \right)'=\frac{f'g-fg'}{g^2}$ | $d\left( \frac{f}{g} \right)=\frac{gdf-fdg}{g^2}$ |
| 反函数  | $[f^{-1}(y)]'=\frac{1}{f'(x)}$                    | $dx=\frac{dy}{f'(x)}=[f^{-1}(y)]'dy$              |
| 复合函数 | $[f(g(x))]'=f'(u)g'(x)$                           | $d[f(g(x))]=f'(u)g'(x)dx$                         |



==常见导数公式==

| 导数                                                        | 微分                                                           |
| --------------------------------------------------------- | ------------------------------------------------------------ |
| $(C)'=0$                                                  | $d(C)=0\cdot dx=0$                                           |
| $(x^\alpha)'=\alpha x^{\alpha-1}$                         | $d(x^\alpha)=\alpha x^{\alpha-1}$                            |
|                                                           |                                                              |
| $(\sin x)'=\cos x$                                        | $d(\sin x)=\cos xdx$                                         |
| $(\cos x)'=-\sin x$                                       | $d(\cos x)=-\sin xdx$                                        |
| $(\tan x)'=\sec^2x$                                       | $d(\tan x)=\sec^2xdx$                                        |
| $(\cot x)'=-\csc^2x$                                      | $d(\cot x)=-\csc^2xdx$                                       |
| $(\sec x)'=\tan x\sec x$                                  | $d(\sec x)=\tan x\sec xdx$                                   |
| $(\csc x)'=-\cot x\csc x$                                 | $d(\csc x)=-\cot x\csc xdx$                                  |
| $(\arcsin x)'=\frac{1}{\sqrt{ 1-x^2 }}$                   | $d(\arcsin x)=\frac{1}{\sqrt{ 1-x^2 }}dx$                    |
| $(\arccos)'=-\frac{1}{\sqrt{ 1-x^2 }}$                    | $d(\arccos)=-\frac{1}{\sqrt{ 1-x^2 }}dx$                     |
| $(\arctan x)'=\frac{1}{1+x^2}$                            | $d(\arctan x)=\frac{1}{1+x^2}dx$                             |
| $(arc\cot x)'=-\frac{1}{1+x^2}$                           | $d(arc\cot x)=-\frac{1}{1+x^2}dx$                            |
|                                                           |                                                              |
| $(a^x)'=\ln a\cdot a^x,(e^x)'=e^x$                        | $d(a^x)=\ln a\cdot a^xdx,d(e^x)=e^xdx$                       |
| $(\log_{a}x)'=\frac{1}{x\ln a},(\ln x)'=\frac{1}{x}$      | $d(\log_{a}x)=\frac{1}{x\ln a}dx,d(\ln x)=\frac{1}{x}dx$     |
|                                                           |                                                              |
| $(\mathrm{sh}\,x)'=\mathrm{ch}\,x$                        | $d(\mathrm{sh}\,x)=\mathrm{ch}\,xdx$                         |
| $(\mathrm{ch}\,x)'=\mathrm{sh}\,x$                        | $d(\mathrm{ch}\,x)=\mathrm{sh}\,xdx$                         |
| $(\mathrm{th}\,x)'=\mathrm{sech}^2\,x$                    | $d(\mathrm{th}\,x)=\mathrm{sech}^2\,xdx$                     |
| $(\mathrm{cth}\,x)'=-\mathrm{csch}^2\,x$                  | $d(\mathrm{cth}\,x)=-\mathrm{csch}^2\,xdx$                   |
| $(\mathrm{arcsh}\,x)'=\frac{1}{\sqrt{ 1+x^2 }}$           | $d(\mathrm{arcsh}\,x)=\frac{dx}{\sqrt{ 1+x^2 }}$             |
| $(\mathrm{arcch}\,x)'=\frac{1}{\sqrt{ x^2-1 }}$           | $d(\mathrm{arcch}\,x)=\frac{dxb}{\sqrt{ x^2-1 }}$            |
| $(\mathrm{arcth})'=(\mathrm{arccth}\,x)'=\frac{1}{1-x^2}$ | $d(\mathrm{arcth})=d(\mathrm{arccth}\,x)=\frac{dx}{1-x^2}$   |
|                                                           |                                                              |
| $[\ln(x+\sqrt{ x^2+a^2 })]'=\frac{1}{\sqrt{ x^2+a^2 }}$   | $d[\ln(x+\sqrt{ x^2+a^2 })]=\frac{dx}{\sqrt{ x^2+a^2 }}$<br> |
|                                                           |                                                              |
|                                                           |                                                              |

>[!note] 
>$\begin{matrix}\sin x= \frac{e^{ix}-e^{-ix}}{2}&\mathrm{sh}\,x=\frac{e^{x}-e^{-x}}{2}\\ \cos x=\frac{e^{ix}+e^{-ix}}{2}&\mathrm{ch}\,x=\frac{e^{ix}+e^{-ix}}{2}\end{matrix}$


>[!note] 
>由此得到几个恒等式：
>$\arcsin x+\arccos x=\frac{\pi}{2},x\in[0,1]$
>$\ln(x+\sqrt{ x^2+1 })=\mathrm{arcsh }x$
>$\ln(x+\sqrt{ x^2-1 })=\mathrm{arcch }x$



><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:一阶微分的形式不变性</span>
>由于$d[f(u)]=f'(u)du$，即无论u是自变量还是中间变量，函数$y=f(u)$的微分形式是一样的，也就是一阶微分的形式不变性。


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
求由方程$\sin y^2=\cos \sqrt{ x }$确定的隐函数$y=y(x)$的导函数。

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Solution1 ：</span>
两边同时对自变量求导
$(\sin y^2)'=(\cos \sqrt{ x })'\Longrightarrow\cos y^2\cdot2y\cdot y'=-\sin \sqrt{ x } \frac{1}{2\sqrt{ x }}\Longrightarrow y'= -\frac{\sin \sqrt{ x }}{4\sqrt{ x }y(\cos y^2)}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Solution2 ：</span>
两边同时求微分
$d(\sin y^2)=d(\cos \sqrt{ x })\Longrightarrow\cos y^2d(y^2)=-\sin \sqrt{ x }d(\sqrt{ x })\Longrightarrow2y\cos y^2dy=-\sin \sqrt{ x } \frac{1}{2\sqrt{ x }}\Longrightarrow \frac{dy}{dx}= -\frac{\sin \sqrt{ x }}{4\sqrt{ x }y(\cos y^2)}$

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:参数方程求导</span>
>设自变量x和因变量y由参数方程$\begin{cases}x=\varphi(t)\\y=\psi(t)\end{cases},\alpha\leq t\leq\beta$确定，其中$\varphi(t),\psi(t)$都是t的可微函数，$\varphi(t)$严格单调且$\varphi(t)\ne0$，则$\Large{\frac{dy}{dx}=\frac{dy}{dt}\cdot \frac{dt}{dx}=\frac{d(\psi(t))}{dt}\cdot \frac{d(\varphi^{-1}(t))}{dx}=\frac{\psi'(t)}{\varphi'(t)}}$
>也可以看作是微分形式$\begin{cases}dy=\psi'(t)dt\\dx=\varphi'(t)dt\end{cases}$相除的结果

### 1.3 高阶导数与高阶微分
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：n阶可导」</span>
> 设函数$y=f(x)$的n-1阶导数$f^{(n-1)}(x)$(或$\frac{d^{n-1}f}{dx^{n-1}},\frac{d^{n-1}y}{dx^{n-1}},n=2,3,4\dots$)仍是个可导函数，则它的导数$f^{(n)}(x)$(或$\frac{d^{n}f}{dx^{n}},\frac{d^{n}y}{dx^{n}}$)被称为$f(x)$的n阶导数。并称$f(x)$是n阶可导函数，或说它的n阶导数存在。
> 显然，若n阶导数存在，则它低于n阶的导数都存在。

>[!note] 
>常见高阶导数：
>$(a^x)^{(n)}=(\ln a)^na^x$
>$(\sin\alpha x)^{(n)}=\alpha^n\sin\left( \alpha x+ \frac{n\pi}{2} \right)$
>$(\cos\alpha x)^{(n)}=\alpha^n\cos\left( \alpha x+ \frac{n\pi}{2} \right)$
>$(\ln x)^{(n)}=(-1)^{n-1} \frac{(n-1)!}{x^n}$

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:高阶导数的线性运算</span>
>设函数$f(x),g(x)$都是n阶可导的，则对于任意常数$c_{1},c_{2}$,它们的线性组合$c_{1}f(x)+c_{2}g(x)$也是n阶可导的，且满足：$[c_{1}f(x)+c_{2}g(x)]^{(n)}=c_{1}f^{(n)}(x)+c_{2}g^{(n)}(x)$


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Leibniz公式</span>
>设函数$f(x),g(x)$都是n阶可导的，则它们的乘积也是n阶可导的，且成立：
>$[f(x)g(x)]^{(n)}=\sum\limits^{n}_{k=0}\mathrm{C^k_{n}}f^{(n-k)}(x)g^{(k)}(x)$
>这与Newton二项式定理形式相近。

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
用弱归纳法
当n=1时，$[f(x)g(x)]'=\mathrm{C^0_{1}}f'(x)g(x)+\mathrm{C^1_{1}}f(x)g'(x)=f'(x)g(x)+f(x)g'(x)$，结论成立。
假设当n=m时结论成立，即$[f(x)g(x)]^{(m)}=\sum\limits^{m}_{k=0}\mathrm{C^k_{m}}f^{(m-k)}(x)g^{(k)}(x)$
当n=m+1时，有
$\begin{align}[f(x)g(x)]^{(m)}&=\sum\limits^{m}_{k=0}\mathrm{C^k_{m}}[f^{(m-k)}(x)g^{(k)}(x)]'\\&=\sum\limits^{m}_{k=0}\mathrm{C^k_{m}}[f^{(m-k+1)}(x)g^{(k)}(x)+f^{(m-k)}(x)g^{(k+1)}(x)]\\&=f^{(m+1)}(x)g^{(0)}(x)+\sum\limits^{m}_{k=1}\mathrm{C^k_{m}}f^{(m-k+1)}(x)g^{(k)}(x)+\sum\limits^{m}_{k=1}\mathrm{C^{k-1}_{m}}f^{(m-k+1)}(x)g^{(k)}(x)+f^{(0)}(x)g^{(m+1)}(x)\\&=\sum\limits^{m}_{k=0}\mathrm{C^k_{m}}f^{(m-k)}(x)g^{(k)}(x)\end{align}$
证毕

>[!tip] 
>$d^ny=f^{(n)}(x)dx^n$
>注意区分，$dx^2$表示自变量的微分的平方，即$(dx)^2$;$d^2x$表示自变量的两次微分$d(dx)$;$d(x^2)$表示$2xdx$.

>[!caution] 
>微分形式不变性只对一阶微分成立，事实上，$d^2y=f''(u)du^2+f'(u)d^2u$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
设$f(x)=\begin{cases}e^{-\frac{1}{x^2}},x\ne0\\0,x=0\end{cases}$，证明$f^{(n)}(0)=0,n\in \mathbb{N_{+}}$

<img style="width:60%" src="https://locus622.oss-cn-beijing.aliyuncs.com/img/202411082227025.png" >

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
对n作数学归纳法
$f'(0)=\lim_\limits{ x \to 0} \frac{e^{-\frac{1}{x^2}}-0}{x-0}=\lim_\limits{ x \to  0 } \frac{\frac{1}{x}}{e^{\frac{1}{x^2}}}\xlongequal{y=\frac{1}{x}}\lim_\limits{ y \to \infty } \frac{y}{e^{y^2}}=0$
假设$f^{(n-1)}(0)=0$，由Leibniz公式，$f^{(n-1)}(x)=p\left( \frac{1}{x} \right)e^{-\frac{1}{x^2}}(x\neq0)$，其中$p\left( \frac{1}{x} \right)$表示关于$\frac{1}{x}$的某个多项式，因此
$f^{(n)}(0)=\lim_\limits{ x \to 0} \frac{p\left( \frac{1}{x} \right)e^{-\frac{1}{x^2}}-0}{x-0}\xlongequal{y=\frac{1}{x}}\lim_\limits{ y \to \infty } \frac{yp(y)}{e^{y^2}}=0$
证毕


>[!note] 
>该函数在$x=0$附近的图像极其平坦
>它说明一个非常值函数也可以在某些点的任意阶导数等于0

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
将$(-\infty,0]$上的常值函数$u(x)\equiv0$和$[1,+\infty)$上的常值函数$v(x)\equiv1$延拓为$(-\infty,+\infty)$上的无限次可微函数，且值域为$[0,1]$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Solution ：</span>
令$g(x)=\left\{\begin{align}&0,&x\leqslant0\\&e^{-\frac{1}{x^2}},&x>0\end{align}\right.$
然后令$f(x)=\frac{g(x)}{g(x)+g(1-x)}$
则$f(x)$满足要求

## 2 微分中值定理
### 2.1 微分中值定理
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：极值」</span>
> 设$f(x)$在$(a,b)$上有定义，$x_{0}\in(a,b)$，如果$\exists U(x_{0},\delta)\subset(a,b),s.t.f(x)\le f(x_{0})\quad(x\in U(x_{0},\delta))$，则称$x_{0}$是$f(x)$的一个极大值点，$f(x_{0})$称为对应的极大值。
> 极小值类似。

>[!example] 
>1. $f(x)$在一个区间中可以有无数个极值点，如$f(x)=\sin \frac{1}{x}(x\in(0,1))$
>2. 极值点的定义不牵涉连续、可微等性质。如，区间$(0,1)$上的Riemann函数$R(x)=\begin{cases} \frac{1}{p},\quad当x=\frac{q}{p}为(0,1)上的既约分数\\0,\quad x为(0,1)上的无理数\end{cases}$
>$(0,1)$上的每个有理点都是它的极大值点，每个无理点都是它的极小值点，证明类似于Riemann函数任意点极限值为0的证明。

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Lemma-Fermat引理</span>
>设$x_{0}$是$f(x)$的一个极值点，且$f(x)$在$x_{0}$处导数存在，则$f'(x_{0})=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
不妨设$x_{0}$是$f(x)$的一个极大值点 
由定义，$\exists U(x_{0},\delta),s.t.f(x)\le f(x_{0})\quad(x\in U(x_{0},\delta))$
当$x<x_{0}$时，有$\frac{f(x)-f(x_{0})}{x-x_{0}}\ge0$；当$x>x_{0}$时，有$\frac{f(x)-f(x_{0})}{x-x_{0}}\le0$。
由于$f(x)$在$x_{0}$可导，所以$f'(x_{0})=f_{+}'(x_{0})=f_{-}'(x_{0})$
由于$f_{-}'(x_{0})=\lim_\limits{ x \to  x_0^- } \frac{f(x)-f(x_{0})}{x-x_{0}}\ge0,f_{+}'(x_{0})=\lim_\limits{ x \to  x_0^+ } \frac{f(x)-f(x_{0})}{x-x_{0}}\le0,$
故$f'(x_{0})=0$
证毕
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Rolle定理</span>
>设$f(x)\in C_{[a,b]},f(x)\in D_{(a,b)}$，且$f(a)=f(b)$，则：
>至少存在一点$\xi\in(a,b),s.t.f'(\xi)=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
由最值定理，$\exists \xi,\eta\in[a,b],s.t.f(\xi)=M,f(\eta)=m$，其中M，m分别是$f(x)$在$[a,b]$上的最大值和最小值
若$M=m,f(x)$在$[a,b]$上为常值函数，结论显然成立。
若$M>m,$这时M,m至少有一个与$f(a)$不相同，不妨设：$M=f(\xi)>f(a)=f(b)$
因此$\xi\in(a,b)$显然就是极大值点，由Fermat引理，$f'(\xi)=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof (Samuleson)：</span>
<img src="https://locus622.oss-cn-beijing.aliyuncs.com/img/202412171924793.jpg" style="width:50%">
作辅助函数$F(x)=f(x)-f\left( x+\frac{b-a}{2} \right)\quad a\leqslant x\leqslant \frac{a+b}{2}$
由于$f(a)=f(b)$，则$F(a)=f(a)-f\left( \frac{a+b}{2} \right)$，$F\left( \frac{a+b}{2} \right)=f\left( \frac{a+b}{2} \right)-f(b)=-F(a)$
在区间$\left[ a, \frac{a+b}{2} \right]$上对函数$F(x)$使用零点存在定理，$\exists a_{1}\in\left[  a,\frac{a+b}{2}  \right],s.t.F(a_{1})=0$，令$b_{1}=a_{1}+\frac{b-a}{2}$
则$f(a_{1})=f(b_{1}),[a_{1},b_{1}]\subset[a,b],b_{1}-a_{1}=\frac{b-a}{2}$
以此类推，得到闭区间套$\{ [a_{n},b_{n}] \}$，它满足$b_{n}-a_{n}=\frac{1}{2^n}(b-a),f(a_{n})=f(b_{n}),n\in \mathbb{N}^+$
由闭区间套定理，存在唯一$\xi$，属于每个$[a_{n},b_{n}]$，即$a_{n}\leqslant\xi\leqslant b_{n},\forall n\in \mathbb{N}^+$
且$\lim_\limits{ n \to \infty }a_{n}=\lim_\limits{ n \to \infty }b_{n}=\xi$
事实上，总可以令$\xi\in(a,b)$，为此只需要令$\{ a_{n} \},\{ b_{n} \}$不是常值数列即可
为避免$\{ a_{n} \}$为常值数列，如果有$a=a_{1}=a_{2}$，则$f(a)=f(a_{1})=f(a_{2})=f(b_{1})=f(b_{2})$，可以用$[b_{2},b_{1}]$代替$[a_{2},b_{2}]$即可
$\{ b_{n} \}$同理
由于$f$在$\xi\in(a,b)$可导，写出无穷小增量公式：
$f(b_{n})=f(\xi)+f'(\xi)(b_{n}-\xi)+o(b_{n}-\xi),\quad(b_{n}\to \xi)$
$f(a_{n})=f(\xi)+f'(\xi)(a_{n}-\xi)+o(a_{n}-\xi),\quad(a_{n}\to \xi)$
代入得$\lim_\limits{ n \to \infty } \frac{f(b_{n})-f(a_{n})}{b_{n}-a_{n}}=\lim_\limits{ n \to \infty } \frac{f'(\xi)(b_{n}-a_{n})+o(b_{n}-\xi)-o(a_{n}-\xi)}{b_{n}-a_{n}}=f'(\xi)$
又由于$f(a_{n})=f(b_{n})$，因此$f'(\xi)=0$
证毕

>[!tip] 
>事实上，在Samuleson证明中得到的$\xi$可以不是极值点，如$f(x)=\left\{\begin{align}&x^2\sin\frac{\pi}{x},&\neq0\\&0,&x=0\end{align}\right.$，取$[a,b]=[-1,1]$，则$f(a)=f(b)=0$，依次取$[a_{n},b_{n}]=\left[ -\frac{1}{2^n}, \frac{1}{2^n} \right]$，则$\xi=0$，但是$\xi$并不是极值点
>
>![image.png](https://locus622.oss-cn-beijing.aliyuncs.com/img/202412172001835.png)
>($x=0$附近的图像)



<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
n次Legendre多项式：$\huge{p_{n}(x)=\frac{1}{2^nn!} \frac{d^n}{dx^n}(x^2-1)^n \quad(n=0,1,2\dots)}$
在$(-1,1)$上恰好有n个不同的根
它的前几项为：
$\begin{matrix}p_{0}(x)=1\\p_{1}(x)=x\\p_{2}(x)=\frac{3x^2-2}{2}\\p_{3}(x)=\frac{5x^3-3x}{2}\\p_{4}(x)=\frac{35x^4-30x^2+3}{8}\\\vdots\end{matrix}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
由高阶函数的Leibniz公式得：
$q_{2n-m}(x)\equiv\frac{\mathrm{d}^m}{\mathrm{d}x^m}(x^2-1)^n \quad(m=0,1,\dots n-1)$中都含有$(x^2-1)$因子，也就是说，当$n<m$时，$q_{2n-m}(x)$都有实根$1,-1$
当$m=0$时，$q_{2n}=(x^2-1)^n$，因此它有且仅有两根$1,-1$；由Rolle定理得，$q_{2n-1}(x)=q'_{2n}(x)$在$(-1,1)$中必有一个根，记为$x_{11}$
在利用Rolle定理，$q_{2n-2}(x)=q'_{2n-1}(x)$在$(-1,x_{11}),(x_{11},1)$上至少各有一个根，记为$x_{21},x_{22}$；以此类推 
下面利用数学归纳法证明，$q_{2n-m}(x)$在$[-1,1]$上至少有m+2个相异的根$-1,x_{m1},x_{m2},\dots x_{mm},1(m=0,1,\dots n-1)$
令$m=n-1$，$q_{n+1}(x)$在$[-1,1]$上至少有n+1个相异的根
令$m=n$，即再利用一次Rolle定理，便知$q_{n}(x)$在$(-1,1)$上至少有n个相异的根
由代数基本定理，$q_{n}(x)$至多有n个根，因此$q_{n}(x)$在$(-1,1)$上恰好有n个不同的根
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
设$f(x)$在闭区间$[0,1]$上有三阶连续导数，且$f(-1)=0,f(1)=1,f'(0)=0$，求证：$\exists \xi\in(-1,1),s.t.f'''(\xi)=3$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
(**待定系数法**)
令$F(x)=f(x)-\frac{1}{2}x^3+ax^2+bx+c$，则$f'''(\xi)=3$等价于$F'''(\xi)=0$
只需要适当地挑选$a,b,c$的值，使得$F(x)$有足够多的零点，就可以确保$F'''(x)$至少存在一个零点
令$x=0$，可知当$c=-f(0)$时，$F(0)=0$
由于$f(-1)=0,f(1)=1$，令$a=f(0)-\frac{1}{2},b=0$，就有$F(1)=F(-1)=0$
此时，$F(x)$有$-1,0,1$三个零点，由Rolle定理得，$\exists \eta_{1}\in(-1,0),\eta_{2}\in(0,1),s.t.F'(\eta_{1})=F'(\eta_{2})=0$
又由于$F'(x)=f'(x)-\frac{3}{2}x^2+2\left( f(0)-\frac{1}{2} \right)x-f(0)$，有$F'(0)=0$，于是$F'(0)$有三个互异零点
由Rolle定理得，$F''(x)$有两个互异零点，从而$F'''(x)$至少有一个零点
证毕


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
设$f(x),g(x)\in C_{[a,b]},D_{(a,b)},\forall x\in(a,b),g'(x)\neq0$，试证：$\exists \xi\in(a,b),s.t. \frac{f'(\xi)}{g'(\xi)}=\frac{f(\xi)-f(a)}{g(b)-g(\xi)}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
构造辅助函数$F(x)=[f(x)-f(a)][g(b)-g(x)]$


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Lagrange中值定理</span>
>设$f(x)\in C_{[a,b]},f(x)\in D_{(a,b)}$，则至少存在一点$\xi\in(a,b),s.t.f'(\xi)=\frac{f(b)-f(a)}{b-a}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
作辅助函数$\varphi(x)=f(x)-f(a)- \frac{f(b)-f(a)}{b-a}(x-a)$
显然该函数满足闭区间连续，开区间可导，$\varphi(a)=\varphi(b)$
由Rolle定理得，$\exists \xi\in(a,b),s.t.\varphi'(\xi)=0$
即得$f'(\xi)= \frac{f(b)-f(a)}{b-a}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span>
![image.png](https://locus622.oss-cn-beijing.aliyuncs.com/img/202411072102293.png)
构造辅助函数$\Updelta(x)=\begin{vmatrix}1&1&1\\a&b&x\\f(a)&f(b)&f(x)\end{vmatrix}=\begin{vmatrix}b-a&x-a\\f(b)-f(a)&f(x)-f(a)\end{vmatrix}$
$\Updelta(x)$的值等于图中三角形面积$S(x)$的两倍
利用$\Updelta(a)=\Updelta(b)=0,$由Rolle定理得$\exists \xi\in(a,b),s.t.\Updelta'(\xi)=0$
由于$\Updelta'(x)=\begin{vmatrix}1&1&1\\a&b&x\\f(a)&f(b)&f(x)\end{vmatrix}=\begin{vmatrix}b-a&x-a\\f(b)-f(a)&f'(x)-f(a)\end{vmatrix}$
就可以从$\Updelta'(\xi)=0$直接得到所求结论。
证毕

>[!note] 
>Lagrange中值定理的结论：$f'(\xi)=\frac{f(b)-f(a)}{b-a},\xi\in(a,b)$通常称为Lagrange公式，它有以下形式，通常称为**有限增量公式**：
>$f(b)-f(a)=f'(\xi)(b-a)$ 
>$f(b)-f(a)=f'(a+\theta(b-a))(b-a),\theta\in(0,1)$
>$\Updelta y=f'(x+\theta\Updelta x)\Updelta x,\theta\in(a,b)$


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Cauchy中值定理</span>
>设$f(x)\in C_{[a,b]},f(x)\in D_{(a,b)}$，且对于$\forall x\in(a,b),g'(x)\ne0$.
>则至少存在一点$\xi\in(a,b),s.t. \frac{f'(\xi)}{g'(\xi)}=\frac{f(b)-f(a)}{g(b)-g(a)}$

>[!note] 
>Cauchy中值定理可以看成Lagrange中值定理的参数方程形式

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1 ：</span>
由闭区间连续函数的性质，以及$g(x)$在开区间连续，闭区间可导，$g'(x)\ne0$，由反证法易得，$g(x)$严格单调，不妨设其严格单增
设$g(a)=\alpha,g(b)=\beta$，由反函数存在性定理以及反函数导数存在定理，
$g^{-1}(y)$在$[\alpha,\beta]$上连续，在$(\alpha,\beta)$上可导，其导数为$[g^{-1}(y)]'=\frac{1}{g'(x)}$，且$g^{-1}(y)$在$[\alpha,\beta]$上严格单增
考虑$[\alpha,\beta]$上的复合函数$F(y)=f(g^{-1}(y))$
显然$F(y)$可以使用Lagrange中值定理，故$\exists \eta\in(\alpha,\beta),s.t.F'(\eta)=\frac{F(\beta)-F(\alpha)}{\beta-\alpha}=\frac{f(g^{-1}(\beta))-f(g^{-1}(\alpha))}{\beta-\alpha}=\frac{f(b)-f(a)}{g(b)-g(a)}$
由$g(x),g^{-1}(y)$的关系，$\exists \xi\in(a,b),$满足$g(\xi)=\eta$，于是
$$\begin{align}
F'(\eta)&=\{f(g^{-1}(y))\}'|_{y=\eta}  \\
&=\{f'(g^{-1}(y))[g^{-1}(y)]'\}|_{y=\eta}  \\
&=\left\{ f'(x) \frac{1}{g'(x)} \right\}|_{x=g^{-1}(\eta)=\xi}  \\
&=\frac{f'(\xi)}{g'(\xi)}
\end{align}$$
证毕

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span> 
作辅助函数$F(x)=f(x)-\left[ \frac{f(b)-f(a)}{g(b)-g(a)}(g(x)-g(a)) \right]-f(a)$，可知$F(a)=F(b)$，利用Rolle定理即得结果
证毕

---


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
$f(x)\in C_{[1,+\infty)},f(x)\in D_{(1,+\infty)}$，且$e^{-x^2}f'(x)$在$(1,+\infty)$上有界，试证明函数$xe^{-x^2}f(x)$在$(1,+\infty)$也有界

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
设$|e^{-x^2}f'(x)|\leqslant M,x\in(1,+\infty)$
先证$e^{-x^2}f(x)$在$(1,+\infty)$上有界： 
$\begin{align}|\frac{f(x)}{e^{x^2}}|&\leqslant|\frac{f(x)-f(1)}{e^{x^2}}|+|\frac{f(1)}{e^{x^2}}|<|\frac{f(x)-f(1)}{e^{x^2}-e}|+|\frac{f(1)}{e}|\\&=|\frac{f'(\xi)}{2\xi e^{\xi^2}}|+|\frac{f(1)}{e}|<|\frac{f'(\xi)}{2e^{\xi^2}}|+|\frac{f(1)}{e}|\leqslant \frac{M}{2}+\frac{|f(1)|}{e}\end{align}$

其中$\xi\in(1,x)$
进一步，对于$xe^{-x^2}f(x)$，也有：
$\begin{align}|xe^{-x^2}f(x)|&\leqslant|\frac{xf(x)-f(1)}{e^{x^2}}|+|\frac{f(1)}{e^{x^2}}|<|\frac{xf(x)-1\cdot f(1)}{e^{x^2}-e}|+|\frac{f(1)}{e}|\\&=|\frac{\xi f'(\xi)+f(\xi)}{2\xi e^{\xi^2}}|+|\frac{f(1)}{e}|<|\frac{f'(\xi)}{2e^{\xi^2}}|+|\frac{f(\xi)}{2e^{\xi^2}}|+|\frac{f(1)}{e}|\leqslant \frac{3M}{4}+\frac{3|f(1)|}{2e}\end{align}$
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
$f(x)\in C_{[a,b]},f(x)\in D_{(a,b)},ab>0$，试证$\exists \xi\in (a,b),s.t. \frac{1}{b-a}\begin{vmatrix}a&b\\f(a)&f(b)\end{vmatrix}=\xi f'(\xi)-f(\xi)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\frac{1}{b-a}\begin{vmatrix}a&b\\f(a)&f(b)\end{vmatrix}=\xi f'(\xi)-f(\xi)\Rightarrow \frac{ \frac{f(b)}{b}- \frac{f(a)}{a}}{ \frac{1}{b}-\frac{1}{a}}=f(\xi)-\xi f'(\xi)$
作$\varphi(x)=\frac{f(x)}{x},\psi(x)=\frac{1}{x}$，显然它们在$[a,b]$连续，$(a,b)$可导，$\psi'(x)\neq0(a<x<b)$使用Cauchy中值定理，
$\exists \xi\in(a,b),s.t.\frac{ \frac{f(b)}{b}- \frac{f(a)}{a}}{ \frac{1}{b}-\frac{1}{a}}=\frac{\frac{f'(\xi)x-f(\xi)}{\xi^2}}{-\frac{1}{\xi^2}}=f(\xi)-\xi f'(\xi)$
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
$f(x)\in C_{[a,b]},f(x)\in D^{(2)}_{(0,1)},ab>0$，试证$\exists \eta\in (a,b),s.t.f(b)+f(a)-2f\left( \frac{a+b}{2} \right)=\left( \frac{b-a}{2} \right)^2f''(\eta)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
设$g(x)=f(x)-f\left( x-\frac{b-a}{2} \right)$
有$g\left( \frac{a+b}{2} \right)=f\left( \frac{a+b}{2} \right)-f(a),g(b)=f(b)-f\left( \frac{a+b}{2} \right)$
在$\left[ \frac{a+b}{2},b \right]$上对$g(x)$使用Lagrange中值定理， 
$\begin{align}f(b)-2f\left( \frac{a+b}{2} \right)+f(a)&=g(b)-g\left( \frac{a+b}{2} \right)=g'(\xi)\left( \frac{b-a}{2} \right)\\&=\left[ f'(\xi)-f'\left( \xi-\frac{b-a}{2} \right) \right]\left( \frac{b-a}{2} \right)\\&=f''(\eta)\left( \frac{b-a}{2} \right)^2\end{align}$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 4 </span>
设$f(x)\in D_{[0,+\infty)},f(0)=0,\exists A>0,s.t.\forall x\in[0,+\infty):|f'(x)|\leqslant A|f(x)|$，试证明：$f(x)\equiv0(x\geqslant0)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof1 ：</span>
由于$|f(x)|$在$\left[ \frac{0,1}{2A} \right]$上连续，故$\exists x_{1}\in\left[ 0, \frac{1}{2A} \right],s.t.|f(x_{1})|=\max\limits_{0\leqslant x\leqslant \frac{1}{2A}}|f(x)|=M$
于是$M=|f(x_{1})|=|f(0)+f'(\xi)(x_{1}-0)|=|f'(\xi)x_{1}|\leqslant A|f(\xi)|x_{1}\leqslant \frac{1}{2}M$
所以$M=0$，$\forall x\in\left[ 0, \frac{1}{2A} \right],f(x)\equiv0$
由数学归纳法证明在一切$\left[ \frac{i-1}{2A}, \frac{i}{2A} \right]$恒有$f(x)\equiv0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof2 ：</span>
假设$f(x)\not\equiv0$，即$\exists x_{0}>0,s.t.f(x_{0})\neq0$，不妨设$f(x_{0})>0$
记$x_{1}=\inf\{ x|(x,x_{0})上f(x)>0 \}$
由连续函数局部保号性，$f(x_{1})=0,(x_{1},x_{0})内f(x)>0$
令$g(x)=\ln f(x)\quad(x\in(x_{1},x_{0}))$
则$|g'(x)|=|\frac{f'(x)}{f(x)}|\leqslant A$
故$g(x)$在有限区间$(x_{1},x_{0})$上有界，但$\lim_\limits{ x \to x_{1}+}f(x)=f(x_{1})=0$
但由$g(x)=\ln f(x)\quad(x\in(x_{1},x_{0}))$得$\lim_\limits{ x \to x_{1}+}g(x)=-\infty$ ，矛盾
证毕

### 2.2 导函数相关定理
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Darboux导函数介值定理</span>
>若$f(x)\in D_{[a,b]},$则$f'(x)$具有介值性质：k为介于$f'_{+}(a),f'_{-}(b)$之间的任一实数，则至少存在一点$\xi\in[a,b],s.t.f'(\xi)=k$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
设$F(x)=f(x)-kx$，则$F(x)\in D_{[a,b]}$，且$F'_{+}(a)F_{-}'(b)\leqslant0$
如果$F'_{+}(a)F_{-}'(b)=0$，则$F'_{+}(a)=0$或$F'_{-}(b)=0$，取$\xi=a\,or\,b$即可
如果$F'_{+}(a)F_{-}'(b)<0$，则不妨设$F'_{+}(a)=\lim_\limits{ x \to a+} \frac{F(x)-F(a)}{x-a}>0,F'_{-}(b)=\lim_\limits{ x \to b-} \frac{F(x)-F(b)}{x-b}<0$
由极限的保号性，$\exists\delta_{1}>0,\forall x\in(a,a+\delta_{1}): \frac{F(x)-F(a)}{x-a}>0;\exists\delta_{2}>0,\forall x\in(b-\delta_{1},b): \frac{F(x)-F(b)}{x-b}>0$
因此$\xi\neq a,b$
又由闭区间上连续函数的最值定理，$\exists \xi\in(a,b)$使得$F(x)$在该点处取得最大值
由Fermat引理得，$F'(\xi)=0$即$f'(\xi)=k$
证毕

---

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:导数极限定理——单侧</span>
>设函数$f(x)\in D_{(a,b)\setminus \{x_{0}\}},f(x)$在$x_{0}$处左连续。若$\lim_\limits{ x \to  x_0- }f'(x)=A$(有限或无限)，则在$x_{0}$处的左导数存在且$f_{-}'(x_{0})=A$.即$f'(x)$在该点左连续，此外，$A$不止可以为有限数
>右导数类似。

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
令$\Updelta x=x-x_{0},\Updelta y=f(x)-f(x_{0})$，写出$f(x)$在$x_{0}$右侧的差商：
$\frac{\Updelta y}{\Updelta x}=\frac{f(x_{0}+\Updelta x)-f(x_{0})}{\Updelta x},\Updelta x>0$
在闭区间$[x_{0},x_{0}+\Updelta x]$上应用Lagrange中值定理，
$\exists \xi\in(x_{0},x_{0}+\Updelta x),s.t.\Updelta y=f(x_{0}+\Updelta x)-f(x_{0})=f'(\xi)\Updelta x$
因此当$\Updelta x>0$时就有$\frac{\Updelta y}{\Updelta x}=f'(\xi)$
现设$\lim_\limits{ x \to  x_0+ }f'(x)=A$(有限)
$\forall \varepsilon>0,\exists\delta>0,\forall0<x-x_{0}<\delta:|f'(x)-A|<\varepsilon$
若有$0<\Updelta x=x-x_{0}<\delta$，则同时有$x_{0}<\xi<x<x_{0}+\delta$
因此当$0<\Updelta x<\delta$时，就有$|\frac{\Updelta y}{\Updelta x}-A|=|f'(\xi)-A|<\varepsilon$ 
左侧同理
证毕
>[!tip] 
>简单来说，就是：
>$\begin{align}f'_{+}(x_{0})&=\lim_\limits{ x \to  x_0^+ } \frac{f(x)-f(x_{0})}{x-x_{0}}\\&=\lim_\limits{ x \to  x_0^+ }f'(\xi)\\&=f'(x_{0}^+)\end{align}$



><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Corollary:导数极限定理</span>
>设函数$f(x)\in D_{(a,b)\setminus \{x_{0}\}},f(x)$在$x_{0}$的某个邻域$U(x_{0})$连续。若$f'$在$x_{0}$处存在极限，则$f$在$x_{0}$处可导，且$f'$在$x_{0}$处连续。 
>由此，若导函数在某点有极限，则它就在该点连续。而一般函数在某点存在极限时却不一定连续。

>[!note] 
>由此可见，导函数在某点有极限，则它就在该点连续，这里甚至不需要事先假定函数在该点可导

>[!note] 
>可记为：“连续+导函数极限存在=可导(一点处)”


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Corollary</span>
>若$f(x)\in D_{(a,b)},$则它的导函数$f'(x)$只可能有第二类间断点。

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
假设$x_{0}$是$f'(x)$的间断点，但不是第二类，即$f'(x_{0}^-),f'(x_{0}^+)$存在且有限
由于$f(x)$在$x_{0}$处可导所以在该点连续，由导数极限定理，有：
$f'(x_{0}^+)=f'_{+}(x_{0})=f'(x_{0})=f'_{-}(x_{0})=f'(x_{0}^-)$
所以$f'(x)$在$x_{0}$处连续，矛盾
证毕
<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span>
假设$x_{0}$是$f'(x)$的间断点，但不是第二类，即$f'(x_{0}^-),f'(x_{0}^+)$存在且有限，且$f'(x_{0}^-)\neq f'(x_{0})$(或者$f'(x_{0}^+)\neq f'(x_{0})$)，不妨设$f'(x_{0}^-)< f'(x_{0})$
对于$\varepsilon_{0}=f'(x_{0})-f'(x_{0}^-)>0,\exists\delta>0,\forall x\in(x_{0}-\delta,x_{0}):|f'(x)-f'(x_{0}^-)|< \frac{\varepsilon_{0}}{2}= \frac{1}{2}[f'(x_{0})-f'(x_{0}^-)]$
则$f'(x)<f'(x_{0}^-)+\frac{1}{2}[f'(x_{0})-f'(x_{0}^-)]=\frac{1}{2}[f'(x_{0})+f'(x_{0}^-)]$
任取$x_{1}\in(x_{0}-\delta,x_{0})$，则有$f'(x_{1})<\frac{1}{2}[f'(x_{0})+f'(x_{0}^-)]$
在$[x_{1},x_{0}]$中无$\xi,s.t.f'(\xi)=\frac{1}{2}[f'(x_{0})+f'(x_{0}^-)]$，这与Darboux导函数介值定理矛盾
证毕

---


>[!example] 
>函数$f(x)=\begin{cases}x^2\sin \frac{1}{x},\quad x\ne0\\0,\quad x=0\end{cases}$，的导函数为$f'(x)=\begin{cases}2x\sin \frac{1}{x}-\cos \frac{1}{x},x\ne0\\0,\quad x=0\end{cases}$
>$x=0$对于导函数来说是第二类间断点(极限$\lim_\limits{ x \to 0}f'(x)$不存在)
><img style="width:50%" src="https://locus622.oss-cn-beijing.aliyuncs.com/img/202411082141446.png" >
>($f(x)$图像)


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
试证明： 
(1)(常函数的导数)若$f(x)\in D_{(a,b)},f'(x)\equiv0,$则$f(x)$在$(a,b)$恒为常数
(2)(不定积分基本定理)$f,g\in C(I)$，除至多有限点外有$f'(x)=g'(x),$则$f(x)=g(x)+C，C$为常数

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
(1)任取两点使用Lagrange中值定理即可
(2)作$F(x)=f(x)-g(x)$，假设函数在$x_{1},x_{2}\dots x_{n}$处$f'(x)\neq g'(x)$，则按照它们分为有限个子区间，每个子区间使用上一小题结论，就有$F(x)$在每一子区间上为常数，又有$F(x)\in C_{(I)}$得到$F(I)$是常值函数
证毕

### 2.3 函数的单调性与凸性
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:一阶导数与单调性</span>
>$f(x)\in D_{(I)},$则$f(x)$在I上单调增加的充要条件是：$\forall x\in I,f'(x)\ge0$
>递减类似

>[!note] 
>若$\forall x\in I,f'(x)\ge0$,则$f(x)$在I上**严格**单调递增。
>但是即便减弱为在I中除了有限点外，都有$f'(x)>0,$"$f(x)$在I上严格单调递增"仍成立。故$f'(x)>0$只是严格递增的充分不必要条件。
>如$f(x)=x^3$。

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\Longleftarrow:$ $\forall x_{1},x_{2}\in I(x_{1}<x_{2})$，在$[x_{1},x_{2}]$上应用Lagrange中值定理，
$\exists \xi\in(x_{1},x_{2}),s.t.f(x_{2})-f(x_{1})=f'(\xi)(x_{2}-x_{1})$
显然，$f(x_{2})-f(x_{1})$与$f'(\xi)$同号，因此，当$f'(\xi)\ge0,f'(\xi)>0$时对应就有$f(x_{2})-f(x_{1})\ge0,f(x_{2})-f(x_{1})>0$
由$x_{1},x_{2}$的任意性，就有$f(x)$在I上单调递增或者严格单调递增
$\Longrightarrow:$ 设$\forall x\in I$，由于$f(x)$在I上单调递增，故对于$\forall x_{0}\in I(x\ne x_{0})$，就成立$\frac{f(x_{0})-f(x)}{x_{0}-x}\ge0$
令$x_{0}\to x$，就有$f'(x)\ge0(x\in I)$
证毕



---


> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：凸性」</span>
>第一定义：$f(x)$在I上有定义，称$f(x)$是I上的下凸函数，如果：
> 对于$\forall x_{1},x_{2}\in I,\forall\lambda\in(0,1),$都有$f(\lambda x_{1}+(1-\lambda)x_{2})\le \lambda f(x_{1})+(1-\lambda)f(x_{2})$
> ![image.png](https://locus622.oss-cn-beijing.aliyuncs.com/img/202411082211570.png)
>  
> 第二定义(Jensen定义)：$f(x)$在I上有定义，称$f(x)$是I上的下凸函数，如果：对于$\forall x_{1},x_{2}\in I,$都有：
> $f\left( \frac{x_{1}+x_{2}}{2} \right)\le \frac{1}{2} [f(x_{1})+f(x_{2})]$
> 第三定义：$f(x)$在I上有定义，称$f(x)$是I上的下凸函数，如果：对于$\forall x_{1},x_{2}\dots x_{n}\in I,$都有：
> $f\left( \frac{x_{1}+x_{2}+\dots x_{n}}{n} \right)\le \frac{1}{n} [f(x_{1})+f(x_{2})+\dots f(x_{n})]$
> 第四定义：$f(x)$在I上有定义，称$f(x)$是I上的下凸函数，如果：曲线$y=f(x)$的切线保持在曲线的下方。此外，如果除了切点外，切线严格保持在曲线下方，则称为严格下凸的
> <span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:凸函数定义的等价</span>
> 定义2，3等价
> 当$f(x)$连续时，定义1，2，3等价
> 当$f(x)$处处可导时，定义1，2，3，4等价


<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$1^\circ$ 定义2，3等价
第三定义到第二定义显然
第二定义到第三定义，使用反向归纳法
$(a)$证明对于$n=2^k(k=1,2\dots)$成立
由于$f\left( \frac{x_{1}+x_{2}}{2} \right)\le \frac{1}{2} [f(x_{1})+f(x_{2})]$，即对于n=2成立
现证n=4时成立：
事实上，$\forall x_{1},x_{2},x_{3},x_{4}\in I$，有
$\begin{align}f\left( \frac{x_{1}+x_{2}+x_{3}+x_{4}}{4} \right)&=f\left( \frac{\frac{x_{1}+x_{2}}{2} + \frac{x_{3}+x_{4}}{2} }{2} \right)\\&\leqslant \frac{f\left( \frac{x_{1}+x_{2}}{2} \right)+f\left( \frac{x_{3}+x_{4}}{2} \right)}{2}\\&\leqslant \frac{f(x_{1})+f(x_{2})+f(x_{3})+f(x_{4})}{4} \end{align}$
重复以上方法，可知，对于任意自然数k，有：
$f\left( \frac{x_{1}+x_{2}+\dots x_{2^k}}{2^k} \right)\leqslant \frac{f(x_{1})+f(x_{2})+\dots f(x_{2^k})}{2^k}$
即对于一切$n=2^k$成立
$(b)$ 证明对于n=k+1成立时，必然对n=k成立
记$A= \frac{x_{1}+x_{2}+\dots x_{k}}{k}$，则$x_{1}+x_{2}+\dots x_{k}=kA$，所以$A=\frac{x_{1}+x_{2}+\dots x_{k}+A}{k+1}$
假设对于k+1成立，即$f(A)=f\left( \frac{x_{1}+x_{2}+\dots x_{k}+A}{k+1} \right)\leqslant \frac{f(x_{1})+f(x_{2})+\dots f(x_{k})+f(A)}{k+1}$
不等式两边同时乘以k+1，减去$f(A)$，最后除以k，得
$f\left( \frac{x_{1}+x_{2}+\dots x_{k}}{k} \right)\le \frac{1}{k} [f(x_{1})+f(x_{2})+\dots f(x_{k})]$


$2^\circ$ 当$f(x)$连续时，定义1，2，3等价。由$1^\circ$ ，只需证定义2，3等价即可
第一定义到Jensen定义显然
Jensen定义到第一定义：由Jensen不等式，$f\left( \frac{x_{1}+x_{2}+\dots x_{n}}{n} \right)\leqslant \frac{f(x_{1})+f(x_{2})+\dots f(x_{n})}{n}$
先证明$\lambda'=\frac{m}{n}\in(0,1)$为有理数时成立.事实上有：
$$\begin{align}
f(\lambda' x_{1}+(1-\lambda')x_{2})&=f\left[ \frac{m}{n}x_{1}+\left( 1-\frac{m}{n}x_{2} \right) \right] \\
&=f\left[ \frac{mx_{1}+(n-m)x_{2}}{n} \right] \\
&\leqslant \frac{mf(x_{1})+(n-m)f(x_{2})}{n} \\
&=\lambda' f(x_{1})+(1-\lambda')f(x_{2})
\end{align}$$
$\lambda'$为有理数时得证。
若$\lambda\in(0,1)$为无理数，则存在有理数列$\lambda'_{n}\in(0,1)(n=1,2\dots)s.t.\lambda'_{n}\to\lambda(n\to \infty)$
有$f(x)$的连续性有$f(\lambda x_{1}+(1-\lambda)x_{2})=f\{\lim_\limits{ n \to \infty }[\lambda'_{n}x_{1}+(1-\lambda'_{n})x_{2}]\}=\lim_\limits{ n \to \infty }f[\lambda'_{n}x_{1}+(1-\lambda')x_{2}]$
由于上面已经证明$f(\lambda' x_{1}+(1-\lambda')x_{2})\leqslant \lambda' f(x_{1})+(1-\lambda')f(x_{2})$
左右取极限即得结果
$3^\circ$ 当$f(x)$处处可导时，定义1，2，3，4等价

证毕


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:二阶导数与凸性</span>
>$f(x)\in D^{(2)}_{(I)},$则$f(x)$在I上是下凸函数的充要条件是：$\forall x\in I,f''(x)\ge0$
>上凸类似


>[!note] 
>若$\forall x\in I,f''(x)\ge0$,则$f(x)$在I上**严格**下凸。
>但是即便减弱为在I中除了有限点外，都有$f''(x)>0,$"$f(x)$在I上严格下凸"仍成立。故$f''(x)>0$只是严格递增的充分不必要条件。


<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\Longrightarrow:$ 由于$f(x)$下凸，$\forall x\in I,\Updelta x>0,x+\Updelta x,x-\Updelta x\in I$，有：
$\frac{f(x+\Updelta x)+f(x-\Updelta x)}{2}\ge f\left(  \frac{x+\Updelta x}{2}+ \frac{x-\Updelta x}{2} \right)=f(x)$
故$f(x+\Updelta x)-f(x)\ge f(x)-f(x-\Updelta x)$
对于$\forall x_{1},x_{2}\in I(x_{1}<x_{2})$，令$\Updelta x_{n}=\frac{x_{2}-x_{1}}{n}$，反复利用上式，就有：
$$\begin{align}
f(x_{2})-f(x_{2}-\Updelta x_{n})&\ge f(x_{2}-\Updelta x_{n})-f(x_{2}-2\Updelta x_{n}) \\
&\ge f(x_{2}-\Updelta 2x_{n})-f(x_{2}-3\Updelta x_{n}) \\
&\ge\dots  \\
&\ge f(x_{2}-(n-1)\Updelta x_{n})-f(x_{2}-n\Updelta x_{n}) \\
&=f(x_{1}+\Updelta x_{n})-f(x_{1})
\end{align}$$
因此就有$\frac{f(x_{2}+(-\Updelta x_{n})-f(x_{2})}{(-\Updelta x_{n})}\ge \frac{f(x_{1}+\Updelta x_{n})-f(x_{1})}{\Updelta x_{n}}$
由于$f(x)$在$x_{1},x_{2}$可导，令$n\to+ \infty$即$\Updelta x_{n}\to0$就有$f'(x_{2})\ge f'(x_{1})$
即$f'(x)$在I上单调递增，因此就有$f''(x)\ge0$
$\Longleftarrow:$ 由于$f''(x)>0$，故$f(x)$在I上单调递增 
$\forall x_{1},x_{2}\in I(x_{1}<x_{2}),\forall \lambda\in(0,1)$，取$x_{0}=\lambda x_{1}+(1-\lambda)x_{2}$，那么就有$x_{1}<x_{0}<x_{2}$且
$x_{1}-x_{0}=(1-\lambda)(x_{1}-x_{2}),x_{2}-x_{0}=\lambda(x_{2}-x_{1})$
在$[x_{1},x_{0}],[x_{0},x_{2}]$上分别使用Lagrange中值定理，
$\exists \eta_{1}\in(x_{1},x_{0}),\eta_{2}\in(x_{0},x_{2}),s.t.f(x_{1})-f(x_{0})=f'(\eta_{1})(x_{1}-x_{0}),f(x_{2})-f(x_{0})=f'(\eta_{2})(x_{2}-x_{0})$
利用$f'(x)$在I上单增得：
$f(x_{1})\ge f(x_{0})+f'(x_{0})(x_{1}-x_{0})=f(x_{0})+(1-\lambda)f'(x_{0})(x_{1}-x_{2})$
$f(x_{2})\ge f(x_{0})+f'(x_{0})(x_{2}-x_{0})=f(x_{0})+\lambda f'(x_{0})(x_{2}-x_{1})$
分别用$\lambda,1-\lambda$乘上两式相加得：
$\lambda f(x_{1})+(1-\lambda)f(x_{2})\ge f(\lambda x_{1}+(1-\lambda)x_{2})$
即它是下凸函数
证毕
>[!tip] 
>此证明的关键是$f'(x)$递增

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:拐点的性质</span>
>曲线上凸与下凸的分界点称为曲线的拐点。
>设$f(x)$在$(x_{0}-\delta,x_{0}),(x_{0},x_{0}+\delta)$上二阶可导，若$f''(x)$在$(x_{0}-\delta,x_{0}),(x_{0},x_{0}+\delta)$上的符号相反，则$(x_{0},f(x_{0}))$是曲线$y=f(x)$的拐点；若相同，不是拐点。
>设$f(x)$在$(x_{0}-\delta,x_{0}+\delta)$上二阶可导，若$(x_{0},f(x_{0}))$是曲线$y=f(x)$的拐点，则$f''(x_{0})=0$


>[!note] 
>求拐点时，既要考虑$f''(x)=0$的点，也要考虑$f''(x)$不存在的点



><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Jensen不等式</span>
>若$f(x)$是区间I上的下凸函数，则对于任意满足$\sum\limits^n_{i=1}\lambda_{i}=1$的$\lambda_{i}>0(i=1,2,\dots n)$，成立：
>$f(\sum\limits^n_{i=1}\lambda_{i}x_{i})\le\sum\limits^n_{i=1}\lambda_{i}f(x_{i})$
>特别的，当$\lambda_{i}=\frac{1}{n}(i=1,2\dots n)$，就有：
>$f\left( \frac{1}{n}\sum\limits^n_{i=1}x_{i} \right)\le \frac{1}{n}\sum\limits^n_{i=1}f(x_{i})$
>上凸类似

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1(Taylor)：</span>
记$x_{1},\dots x_{n}$的加权平均值$\bar{x}=\lambda_{1}x_{1}+\dots\lambda_{n}x_{n}$
Taylor展开$f(x_{i})=f(\bar{x})+f'(\bar{x})(x_{i}-\bar{x})+\frac{f''(\xi_{i})}{2!}(x_{i}-\bar{x})^2,i=1,2\dots n$
将这n个式子分别乘以$\lambda_{1},\dots\lambda_{n}$后相加，利用条件$\sum\limits^n_{i=1}\lambda_{i}=1$和二阶导数非负，就得到Jensen不等式
证毕
<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2(MI) ：</span>



## 3 Taylor 公式
### 3.1 L'Hôpital法则
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:L'Hôpital法则</span> 
>设函数$f(x),g(x)$在$(a,a+d]$(d为常数)上可导，且$g'(x)\ne0$.
>若此时有$\lim_\limits{ x \to a+}f(x)=\lim_\limits{ x \to a+}g(x)=0$或者$\lim_\limits{ x \to a+}g(x)=\infty$
>且$\lim_\limits{ x \to a+} \frac{f'(x)}{g'(x)}$存在(有限或$\infty$)，则成立：
>$\lim_\limits{ x \to a+} \frac{f(x)}{g(x)}=\lim_\limits{ x \to a+} \frac{f'(x)}{g'(x)}$

>[!tip] 
>L'Hôpital法则要求在该点的(单侧)去心邻域有定义

>[!tip] 
>$\lim_\limits{ x \to a+} \frac{f'(x)}{g'(x)}$不存在与$\lim_\limits{ x \to a+} \frac{f(x)}{g(x)}$是否存在无关，它仅表示是否能够使用L'Hospital法则.


<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$1^\circ$先证明$\lim_\limits{ x \to a+}f(x)=\lim_\limits{ x \to a+}g(x)=0$的情况
设函数$\bar{f}(x)=\begin{cases}0,x=a\\f(x),x>a\end{cases}$，$\bar{g}(x)$同理
显然$\bar{f}(x),\bar{g}(x)$在$[a,a+d]$连续，$(a,a+d)$可导，由Cauchy中值定理
由$x\to a+$有$x\ne a$，故$\frac{f(x)}{g(x)}=\frac{\bar{f}(x)}{\bar{g}(x)}=\frac{\bar{f}(x)-\bar{f}(a)}{\bar{g}(x)-\bar{g}(x)}=\frac{f'(\xi)}{g'(\xi)}(\xi\in(a,a+d))$
当$x\to a+$显然有$\xi\to a+$，又由于$\lim_\limits{ x \to a+} \frac{f'(x)}{g'(x)}$存在，有
$\lim_\limits{ x \to a+} \frac{f(x)}{g(x)}=\lim_\limits{ \xi \to a+} \frac{f'(\xi)}{g'(\xi)}=\lim_\limits{ x \to a+} \frac{f'(x)}{g'(x)}$

$2^\circ$再证明$\lim_\limits{ x \to a+}g(x)=\infty$的情况
设$x_{0}$是$(a,a+d]$中任意一个固定点，则当$x\ne x_{0}$时，有 
$$\begin{align}
\frac{f(x)}{g(x)}&=\frac{f(x)-f(x_{0})}{g(x)}+\frac{f(x_{0})}{g(x)} \\
&=\frac{g(x)-g(x_{0})}{g(x)}\cdot \frac{f(x)-f(x_{0})}{g(x)-g(x_{0})}+\frac{f(x_{0})}{g(x)} \\
&=\left[ 1-\frac{g(x_{0})}{g(x)} \right]\frac{f(x)-f(x_{0})}{g(x)-g(x_{0})}+\frac{f(x_{0})}{g(x)} 
\end{align}$$
于是，$$\begin{align}
|\frac{f(x)}{g(x)}-A|&=|\left[ 1-\frac{g(x_{0})}{g(x)} \right]\frac{f(x)-f(x_{0})}{g(x)-g(x_{0})}+\frac{f(x_{0})}{g(x)} -A| \\
&\le | 1-\frac{g(x_{0})}{g(x)} |\cdot|\frac{f(x)-f(x_{0})}{g(x)-g(x_{0})}-A|+|\frac{f(x_{0})-Ag(x)}{g(x_{0})}|
\end{align}$$
由于$\lim_\limits{ x \to a+} \frac{f'(x)}{g'(x)}=A$,因此$\forall \varepsilon>0,\exists \rho>0,\forall0<x-a<\rho:|\frac{f'(x)}{g'(x)}-A|<\varepsilon$
取$x_{0}=a+\rho$，由Cauchy中值定理，$\forall x\in(a,x_{0}),\exists \xi\in(x,x_{0})\subset(a,a+\rho)$满足$\frac{f'(\xi)}{g'(\xi)}=\frac{f(x)-f(x_{0})}{g(x)-g(x_{0})}$
于是得到$|\frac{f(x)-f(x_{0})}{g(x)-g(x_{0})}-A|=|\frac{f'(\xi)}{g'(\xi)}-A|<\varepsilon$
又由于$\lim_\limits{ x \to a+}g(x)=\infty$，总是可以找到整数$\delta<\rho,$当$0<x-a<\delta$时，有
$|1-\frac{g(x_{0})}{g(x)}|<2,|\frac{f(x_{0})-Ag(x)}{g(x)}|<\varepsilon$
综上所述，$\forall \varepsilon>0,\exists\delta>0,\forall0<x-a<\delta:$
$$\begin{align}
|\frac{f(x)}{g(x)}-A|
&\le | 1-\frac{g(x_{0})}{g(x)} |\cdot|\frac{f(x)-f(x_{0})}{g(x)-g(x_{0})}-A|+|\frac{f(x_{0})-Ag(x)}{g(x_{0})}| \\
&<2\varepsilon+\varepsilon \\
&=3\varepsilon
\end{align}$$

证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
$f(x)\in D_{\mathbb{R}}$，试证明若$\lim_\limits{ x \to +\infty}[f(x)+f'(x)]=A$，则$\lim_\limits{ x \to +\infty}f(x)=A,\lim_\limits{ x \to +\infty}f'(x)=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\lim_\limits{ x \to +\infty}f(x)=\lim_\limits{ x \to +\infty} \frac{e^xf(x)}{e^x}\xlongequal{L'Hospital}\lim_\limits{ x \to +\infty}[f(x)+f'(x)]=A$
证毕

>[!note] 
>若条件改为$\lim_\limits{ x \to +\infty}\left[ f(x)+ \frac{1}{q} f'(x) \right]=A(q>0)$，可以令$\lim_\limits{ x \to +\infty}f(x)=\lim_\limits{ x \to +\infty} \frac{e^{qx}f(x)}{e^{qx}}\xlongequal{L'Hospital}\lim_\limits{ x \to +\infty}\left[ f(x)+ \frac{1}{q}f'(x) \right]=A$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
$f(x)\in D^{(3)}_{\mathbb{R}}$，如果$\lim_\limits{ x \to +\infty}f(x),\lim_\limits{ x \to +\infty}f'''(x)$都存在且有限，试证明$\lim_\limits{ x \to +\infty}f'(x)=\lim_\limits{ x \to +\infty}f''(x)=\lim_\limits{ x \to +\infty}f'''(x)=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$1^\circ$ 先证明$\lim_\limits{ x \to +\infty }[f'(x)-f''(x)]=-\lim_\limits{ x \to +\infty }f'''(x)$
$\begin{align}\lim_\limits{ x \to +\infty }[f(x)-f'(x)+f''(x)]&=\lim_\limits{ x \to +\infty } \frac{e^x}{e^x} [f(x)-f'(x)+f''(x)]\\&\xlongequal{L'Hospital} \lim_\limits{ x \to +\infty }\{[f(x)-f'(x)+f''(x)]+[f'(x)-f''(x)+f'''(x)]\}\\&=\lim_\limits{ x \to +\infty }[f(x)+f'''(x)]\end{align}$
又由于$f(x),f'''(x)$极限存在，故$\lim_\limits{ x \to +\infty }[f'(x)-f''(x)+f'''(x)]=0$
从而$\lim_\limits{ x \to +\infty }[f'(x)-f''(x)]=-\lim_\limits{ x \to +\infty }f'''(x)$
$2^\circ$ 对于$f'(x)-\frac{1}{p}f''(x)$利用$1^\circ$ 中的方法，则$\forall p>0,$有
$\begin{align}\lim_\limits{ x \to +\infty }\left[ f'(x)-\frac{1}{p}f''(x) \right]&=\lim_\limits{ x \to +\infty } \frac{e^{qx}}{e^{qx}} \left[ f'(x)-\frac{1}{p}f''(x) \right]\\&\xlongequal{L'Hospital}\lim_\limits{ x \to +\infty }\left[ f'(x)+\left( \frac{1}{q}-\frac{1}{p} \right)f''(x)-\frac{1}{pq}f'''(x) \right]\end{align}$
解特征方程$x^2+x-1=0$得$p=\frac{\sqrt{ 5 }-1}{2},q=\frac{\sqrt{ 5 }+1}{2}$，故$pq=1,p-q=-1$
因此$\lim_\limits{ x \to +\infty }\left[ f'(x)-\frac{1}{p}f''(x) \right]=\lim_\limits{ x \to +\infty }\left[ f'(x)-f''(x)-f'''(x) \right]\xlongequal{1^\circ结论}-2\lim_\limits{ x \to +\infty }f'''(x)$
由例一，$\lim_\limits{ x \to +\infty }\left[ f'(x)-\frac{1}{p}f''(x) \right]'=\lim_\limits{ x \to +\infty }\left[ f''(x)-\frac{1}{p}f'''(x) \right]=0$
故$\lim_\limits{ x \to +\infty }f''(x)\xlongequal{存在且相等}\lim_\limits{ x \to +\infty } \frac{1}{p}f'''(x)$
又由$1^\circ$结论得$\lim_\limits{ x \to +\infty }f'(x)$存在，于是$\lim_\limits{ x \to +\infty }[f'(x)+f''(x)]$存在
再由$\lim_\limits{ x \to +\infty }f'(x)=\lim_\limits{ x \to +\infty } \frac{e^x}{e^x} f'(x)=\lim_\limits{ x \to +\infty }[f''(x)+f'''(x)]$存在
因此$\lim_\limits{ x \to +\infty }f''(x)=0$，故$\lim_\limits{ x \to +\infty }f'''(x)=0$，故$\lim_\limits{ x \to +\infty }f'(x)=0$


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
$f(x)\in C_{[0,1]},f(x)\in D_{(0,1)}$，且$f(0)=f(1)=0,f\left( \frac{1}{2} \right)=1$，试证： 
1)存在$\xi\in\left( \frac{1}{2},1 \right),s.t.f(\xi)=\xi$
2)$\forall\lambda\in \mathbb{R},\exists \eta\in(0,\xi),s.t.f'(\eta)-\lambda[f(\eta)-\eta]=1$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
1)作$g(x)=f(x)-x$，运用零点存在定理即可
2)作$\varphi(x)=e^{-\lambda x}[f(x)-x]$，有$\varphi'(x)=-\lambda e^{-\lambda x}[f(x)-x]+e^{-\lambda x}[f'(x)-1]$
运用Rolle定理即可
证毕

### 3.2 Taylor公式 
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:带Peano余项的Taylor公式</span>
>设函数$f(x)$在$x_{0}$处有n阶导数，则存在$x_{0}$的一个邻域，对于该邻域中的任意一点，有：
>$f(x)=p_{n}(x)+r_{n}(x)$
>其中，$p_{n}(x)=f(x_{0})+f'(x_{0})(x-x_{0})+ \frac{f''(x_{0})}{2!}(x-x_{0})^2+\dots+\frac{f^{(n)}(x_{0})}{n!}(x-x_{0})^n$称为$f(x)$的n次Taylor公式，
>$r_{n}(x)=o((x-x_{0})^n)$称为Peano余项

>[!note] 
>从函数$f(x)$在$x_{0}$处可导即$f'(x_{0})$存在($f'(x_{0})=\lim_\limits{ x \to  x_0 } \frac{f(x)-f(x_{0})}{x-x_{0}}$)可知，$f(x)$在$x_{0}$的某个邻域有定义。
>从函数$f(x)$在$x_{0}$处有n阶导数可知，$f(x)$在该点的某个邻域内存在所有的$k(k\le n-1)$阶导数，但是$f^{(n)}(x)$只知道在$x_{0}$一点处存在

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
考虑$r_{n}(x)=f(x)-\sum\limits_{k=0}^{n} \frac{1}{k!}f^{(k)}(x_{0})(x-x_{0})^k$，只要证明$r_{n}(x)=o((x-x_{0})^n)$
显然$r_{n}(x_{0})=r'(x_{0})=\dots r^{(n-1)}(x_{0})=0$
反复应用L'Hospital法则，有：
$$\begin{align}
\lim_\limits{ x \to  x_0 } \frac{r_{n}(x)}{(x-x_{0})^n}&=\lim_\limits{ x \to  x_0 } \frac{r_{n}'(x)}{n(x-x_{0})^{n-1}}=\dots  \\
&=\lim_\limits{ x \to  x_0 } \frac{r_{n}^{(n-1)}(x)}{n(n-1)\dots 2(x-x_{0})} \\
&=\frac{1}{n!}\lim_\limits{ x \to  x_0 } \left[ \frac{f^{(n-1)}(x)-f^{(n-1)}(x_{0})-f^{(n)}(x_{0})(x-x_{0})}{x-x_{0}} \right] \\
&=\frac{1}{n!}\lim_\limits{ x \to  x_0 } \left[ \frac{f^{(n-1)}(x)-f^{(n-1)}(x_{0})}{x-x_{0}}-f^{(n)}(x_{0}) \right]  \\
&=\frac{1}{n!}[f^{(n)}(x_{0})-f^{(n)}(x_{0})] \\
&=0
\end{align}$$
因此，$r_{n}(x)=o((x-x_{0})^n)$

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:带Lagrange余项的Taylor公式</span>
>设$f(x)$在$[a,b]$上有n阶连续导数，在$(a,b)$上有n+1阶导数。设$x_{0}\in[a,b]$，则对于$\forall x\in [a,b]$，成立： 
>$f(x)=p_{n}(x)+r_{n}(x)$
>>[!note] 
>>即$f^{(n)}(x)$在$[a,b]$连续，$(a,b)$可导
>其中，$p_{n}(x)=f(x_{0})+f'(x_{0})(x-x_{0})+ \frac{f''(x_{0})}{2!}(x-x_{0})^2+\dots+\frac{f^{(n)}(x_{0})}{n!}(x-x_{0})^n$称为$f(x)$的n次Taylor公式，
>$r_{n}(x)=\frac{f^{(n+1)}(\xi)}{(n+1)!}(x-x_{0})^{n+1},\xi\in(x,x_{0})$称为Lagrange余项

>[!note] 
>当n=0时，就有$f(x)=f(x_{0})+f'(\xi)(x-x_{0}),\xi\in(x,x_{0})$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
反复使用Cauchy中值定理，最后一次使用Lagrange中值定理
$$\begin{align}
\lim_\limits{ x \to  x_0 } \frac{r_{n}(x)}{(x-x_{0})^{n+1}}&=\lim_\limits{ x \to  x_0 } \frac{r_{n}(x)-r_n(x_{0})}{(x-x_{0})^{n+1}-(x_{0}-x_{0})^{n+1}}= \lim_\limits{ x \to  x_0 } \frac{r_{n}'(\xi_{1})}{(n+1)(\xi_{1}-x_{0})^{n}}  \\
&=\lim_\limits{ x \to  x_0 } \frac{r_{n}'(\xi_1)-r_n'(x_{0})}{(n+1)(\xi_{1}-x_{0})^{n}-(n+1)(x_{0}-x_{0})^{n}}= \lim_\limits{ x \to  x_0 } \frac{r_{n}''(\xi_{2})}{(n+1)n(\xi_{2}-x_{0})^{n-1}}\\
&=\dots \dots\\
&=\lim_\limits{ x \to  x_0 } \frac{r_{n}^{(n)}(\xi_{n})-r_n^{(n)}(x_{0})}{(n+1)!(\xi_{n}-x_{0})}= \lim_\limits{ x \to  x_0 } \frac{r_{n}'(\xi_{1})}{(n+1)(\xi_{1}-x_{0})^{n}} \\
&=\frac{r^{(n+1)}(\xi)}{(n+1)!} \\
\end{align}$$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
$f(x)\in D^{(3)}_{[a,b]}$，试证：$\exists c\in(a,b),s.t.f(b)=f(a)+f'\left( \frac{a+b}{2} \right)(b-a)+\frac{1}{24}f'''(c)(b-a)^3$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
**待定常数法**
设k为使下式成立的常数：$f(b)=f(a)+f'\left( \frac{a+b}{2} \right)(b-a)+\frac{1}{24}k(b-a)^3$
因此，即证：$\exists c\in(a,b),s.t.f'''(c)=k$
令$g(x)=f(x)-f(a)-f'\left( \frac{a+x}{2} \right)(x-a)+\frac{1}{24}k(x-a)^3$
则$g(a)=g(b)=0$
由Rolle定理得，$\exists \xi\in(a,b),s.t.g'(\xi)=0$，即$f'(\xi)-f'\left( \frac{a+\xi}{2} \right)-f''\left( \frac{a+\xi}{2} \right)\frac{\xi-a}{2}+\frac{1}{8}k(\xi-a)^2=0$
得到一个关于k的方程
注意到$f'(x)$在点$\frac{a+\xi}{2}$处的Taylor公式：$f'(\xi)=f'\left( \frac{a+\xi}{2} \right)+f''\left( \frac{a+\xi}{2} \right) \frac{\xi-a}{2}+\frac{1}{2}f'''(c)\left( \frac{\xi-a}{2} \right)^2$，其中$c\in(a,b)$
比较两式即得$f'''(c)=k$

### 3.3 函数的Maclaurin公式
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem</span>
>设$f(x)$在$x_{0}$的某个邻域有n+2阶导数存在，则它的n+1阶Taylor多项式的导数恰为$f'(x)$的n次Taylor多项式


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>常见函数的Maclaurin公式</span>
>函数$f(x)$在$x=0$处的Taylor公式又称函数$f(x)$的Maclaurin公式$\theta\in(0,1)$
>
>$e^x=1+x+\frac{x^2}{2!}+\frac{x^2}{3!}+\dots+\frac{x^n}{n!}+o(x^n)|| \frac{e^{\theta x}}{(n+1)!}x^{n+1}$
>$ln(1+x)=x-\frac{x^2}{2}+\frac{x^3}{3}-\dots+(-1)^{n-1} \frac{x^n}{n}+o(x^n)$
>
>
>
>$sin x=x- \frac{x^2}{3!}+\frac{x^5}{5!}+\dots+(-1)^{n} \frac{x^{2n+1}}{(2n+1)!}+o(x^{2n+2})|| \frac{x^{2n+3}}{(2n+3)!}\sin\left( \theta x+ \frac{2n+3}{2}\pi \right)$
>$cos x=1- \frac{x^2}{2}+ \frac{x^4}{4!}-\dots(-1)^n \frac{x^{2n}}{(2n)!}+o(x^{2n+1})|\frac{x^{2n+2}}{(2n+2)!}\cos\left( \theta x+ \frac{2n+2}{2}\pi \right)$
>
>
>
>$\arctan x=\sum\limits_{n=0}^{\infty} \frac{(-1)^{n}}{2 n+1} x^{2 n+1}=x-\frac{1}{3} x^{3}+\frac{1}{5} x^{5}-\cdots, x \in[-1,1]$
>$\arcsin x=\sum\limits_{n=0}^{\infty} \frac{(2 n) !}{4^{n}(n !)^{2}(2 n+1)} x^{2n+1}=x+\frac{1}{6} x^{3}+\frac{3}{40} x^{5}+\frac{5}{112} x^{7}+\frac{35}{1152} x^{9}+\cdots+, x \in(-1,1)$
>
>
>$(1+x)^\alpha=\mathrm{C_{\alpha}^0}x^0+\mathrm{C_{\alpha}^1}x^1+\mathrm{C_{\alpha}^2}x^2+\dots\mathrm{C_{\alpha}^n}x^n+o(x^n)||\mathrm{C_{\alpha}^{n+1}}x^{n+1}(1+\theta x)^{\alpha-(n+1)}\cdot x^{n+1}$
>	$1^\circ$ $\alpha$为正整数，即为Newton二项式定理：$(1+x)^n=\sum\limits_{k=0}^{n}\mathrm{C_{n}^k}x^k$
>	$2^\circ$ $\alpha=-1$，由于$\mathrm{C_{-1}^k}=(-1)^k$，故$\frac{1}{1+x}=1-x+x^2-x^3+\dots+(-1)^nx^n+o(x^n)||(-1)^{n+1} \frac{x^{n+1}}{(1+\theta x)^{n+2}}$
>	同时有：$\frac{1}{1-x}=1+x+x^2+x^3+\dots+x^n+o(x^n)|| \frac{x^{n+1}}{(1+\theta x)^{n+2}}$
>	$3^\circ$ $\alpha= \frac{1}{2}$，由于$\mathrm{C^k_{\frac{1}{2}}}=\begin{cases} \frac{1}{2},k=1\\(-1)^{k-1} \frac{(2k-3)!!}{(2k)!!},k>1\end{cases}$，故$\sqrt{ 1+x }=1+ \frac{1}{2}x- \frac{1}{8}x^2+\dots+(-1)^{n-1}\frac{(2n-3)!!}{(2n)!!}x^n+o(x^n)||(-1)^n \frac{(2n-1)!!}{(2n+2)!!} \frac{x^{n+1}}{(1+\theta x)^{n+ \frac{1}{2}}}$
>	$4^\circ$ $\alpha= -\frac{1}{2}$，由于$\mathrm{C^k_{-\frac{1}{2}}}=(-1)^{k-1} \frac{(2k-1)!!}{(2k)!!}$，故$\frac{1}{\sqrt{ 1+x }}=1- \frac{1}{2}x+\frac{3}{8}x^2-\dots+(-1)^{n-1}\frac{(2n-1)!!}{(2n)!!}x^n+o(x^n)||(-1)^n \frac{(2n+1)!!}{(2n+2)!!} \frac{x^{n+1}}{(1+\theta x)^{n+ \frac{3}{2}}}$
>


> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：Euler数」</span>
> $\begin{align}\sec x&=E_{0}-\frac{E_{2}}{2!}x^2+\frac{E_{4}}{4!}-\dots+(-1)^n \frac{E_{2n}}{(2n)!}x^{2n}+o(x^{2n+1})\\&=1+\frac{1}{2}x^2+\frac{5}{24}x^4+\frac{61}{720}x^6+\dots\end{align}$
> 其中$E_{2n}$为Euler数，定义为：$E_{2n}=\begin{cases}1,n=0\\-\sum\limits_{k=0}^{n-1}(-1)^k\mathrm{C_{2n}^{2k}}E_{k},n\geqslant1\end{cases}$



> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：Bernoulli数」</span>
> $\begin{align}\tan x&=\sum\limits_{n=0}^{\infty} \frac{B_{2n}(-4)^n(1-4^n)}{(2n)!}x^{2n-1}\\&=x+\frac{1}{3}x^3+\frac{2}{15}x^5+\dots\end{align}$
> 其中$B_{2n}$为Bernoulli数，定义为：$B_{n}=\lim_\limits{ x \to 0} \frac{d^n}{dx^n}\left[ \frac{x}{e^x-1} \right]$
> 令$B_{2n}=(-1)^{n-1}\bar{B}_{n}(n\geqslant1)$，也有称$\bar{B}_{n}$为Bernoulli数的，注意到$\bar{B}_{n}>0$
> Bernoulli数还出现在以下无穷级数的求和公式中：$\sum\limits_{n=1}^{\infty} \frac{1}{n^{2k}}=\frac{\bar{B}_{k}}{2}\cdot \frac{(2\pi)^{2k}}{(2k)!}(k\in \mathbb{N}_{+})$
> 因此就有$\sum\limits_{n=0}^{\infty} \frac{1}{n^2}=1+\frac{1}{4}+\frac{1}{9}+\dots+\frac{1}{n^2}+\dots=\frac{\pi^2}{6}$，这就是著名的Basel问题




### 3.4 Taylor公式的应用
#### 3.4.1 求极限
<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>


#### 3.4.2 证明不等式

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 (Hölder Inequality)</span>
设$a,b\ge0,p,q>0,$且满足$\frac{1}{p}+\frac{1}{q}=1$，试证明：$ab\le \frac{1}{p}a^p+ \frac{1}{q}b^q$
推广形式：设$x_{1},x_{2}\dots x_{n};y_{1},y_{2}\dots y_{n}$均为非负数，又有$p,q>0$且满足共轭条件$\frac{1}{p}+\frac{1}{q}=1$，则有：$\sum\limits_{k=1}^{n}x_{k}y_{k}\le \left( \sum\limits_{k=1}^{n}x_{k}^p \right)^{\frac{1}{p}}\left( \sum\limits_{k=1}^{n}y_{k}^q \right)^{\frac{1}{q}}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 (Minkowski Inequality)</span>
设$x_{1},x_{2}\dots x_{n};y_{1},y_{2}\dots y_{n}$均为非负数，又有$p\ge1$，则成立：
$\left[ \sum\limits_{k=1}^{n}(x_{k}+y_{k})^p \right]^{\frac{1}{p}}\le\left( \sum\limits_{k=1}^{n}x_{k}^p \right)^{\frac{1}{p}}+\left( \sum\limits_{k=1}^{n}y_{k}^p \right)^{\frac{1}{p}}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>

---

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
设$f(x)$在$(0,+\infty)$单调下降，可微，如果当$x\in(0,+\infty)$成立$0<f(x)<|f'(x)|$，试证明：当$0<x<1$时，必有$xf(x)> \frac{1}{x}f\left( \frac{1}{x} \right)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
即证在$(0,1)$上，$\frac{f\left( \frac{1}{x} \right)}{f(x)}<x^2\Longleftrightarrow\ln\frac{f\left( \frac{1}{x} \right)}{f(x)}<\ln x^2=2\ln x$
又由于$f(x)$单调递减，故$f'(x)=-|f'(x)|$
$\ln\frac{f\left( \frac{1}{x} \right)}{f(x)}=\ln f\left( \frac{1}{x} \right)-\ln f(x)\xlongequal{Lagrange中值定理} \frac{f'(\xi)}{f(\xi)}\left( \frac{1}{x}-x \right)$
注意到：$x-\frac{1}{x}<2\ln x(0<x<1)$
又有$\frac{f'(x)}{f(x)}<-1, \frac{1}{x}-x>0(0<x<1)$
因此$\frac{f'(x)}{f(x)}<2\ln x$



#### 3.4.3 近似计算


#### 3.4.4 函数的局部性质
##### 3.4.4.1 极值点

>函数$f(x)$的全部极值点必定都在使$f'(x)=0$(驻点)和使得$f'(x)$不存在的点集之中。
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:极值点判定定理</span>
>设函数$f(x)$在$x_{0}$的某一邻域中有定义，且$f(x)$在$x_{0}$连续。 
>**第一判据**：设$\exists\delta>0,s.t.f(x)\in D_{(x_{0}-\delta,x_{0})\cup(x_{0},x_{0}+\delta)}$
>(i)若在$(x_{0}-\delta,x_{0})$上有$f'(x)\geqslant0$，在$(x_{0},x_{0}+\delta)$上有$f'(x)\leqslant0$，则$x_{0}$是$f(x)$的极大值点。
>(ii)若在$(x_{0}-\delta,x_{0})$上有$f'(x)\leqslant0$，在$(x_{0},x_{0}+\delta)$上有$f'(x)\geqslant0$，则$x_{0}$是$f(x)$的极小值点。
>(iii)若$f'(x)$在$(x_{0}-\delta,x_{0}),(x_{0},x_{0}+\delta)$上同号，则$x_{0}$不是$f(x)$的极值点。
>**第二判据**：设$f'(x)=0,f(x)\in D^{(2)}_{\{x_{0}\}}$ 
>(i)若$f''(x_{0})<0$，则$x_{0}$是$f(x)$的极大值点。 
>(ii)若$f''(x_{0})>0$，则$x_{0}$是$f(x)$的极小值点。 
>(iii) 若$f''(x_{0})=0$，判据失效，无法判断。
>**第三判据**：设$f(x)$在$x_{0}$附近有n+1阶连续导数，且$f'(x_{0})=f''(x_{0})=\dots f^{(n)}(x_{0})=0,f^{(n+1)}(x_{0})\neq0$
>(i)若n为偶数，则$x_{0}$不是$f(x)$的极值点。 
>(i)若n为奇数，则$x_{0}$是$f(x)$的严格极值点。 且当$f^{(n+1)}(x_{0})>0$时，$x_{0}$是$f(x)$的严格极小值点；当$f^{(n+1)}(x_{0})<0$时，$x_{0}$是$f(x)$的严格极大值点。

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
对$f(x)$在$x_{0}$处作带Peano余项的Taylor展开：
$f(x)=f(x_{0})+0+0+\dots+\frac{f^{(n+1)}(x_{0})}{(n+1)!}(x-x_{0})^n+o((x-x_{0})^n)$
于是$f(x)-f(x_{0})=\left( \frac{f^{(n+1)}(x_{0})}{(n+1)!}+ \frac{o((x-x_{0})^n)}{(x-x_{0})^n}  \right)(x-x_{0})^n$
由于$\lim_\limits{ x \to  x_0 }[\frac{f^{(n+1)}(x_{0})}{(n+1)!}+ \frac{o((x-x_{0})^n)}{(x-x_{0})^n}]=\frac{f^{(n+1)}(x_{0})}{(n+1)!}$
故$\exists\delta>0,s.t.$在$(x_{0}-\delta,x_{0}+\delta)$中$\frac{f^{(n+1)}(x_{0})}{(n+1)!}+ \frac{o((x-x_{0})^n)}{(x-x_{0})^n}$与$\frac{f^{(n+1)}(x_{0})}{(n+1)!}$同号
若n为偶数，则由$(x-x_{0})^{n+1}$在$x_{0}$附近变号可知$f(x)-f(x_{0})$也变号，故则$x_{0}$不是$f(x)$的极值点。 
若n为奇数，可作类似分析。
证毕

##### 3.4.4.2 界的估计
>[!note] 
>常表现为由$f(x),f''(x)$的界确定$f'(x)$的界。

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
$f(x)\in D^{(2)}_{[0,1]}$，且在$[0,1]$上有$|f(x)|\leqslant A,|f''(x)|\leqslant B$，试证明：$|f'(x)|\leqslant 2A+\frac{1}{2}B,x\in[a,b]$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
在$x=c$处展开，$f(x)=f(c)+f'(c)(x-c)+\frac{1}{2}f''(\xi)(x-c)^2,x\in[0,1]$($\xi$在$x,c$之间)
特别的有：
$\begin{align}&f(0)=f(c)+f'(c)(0-c)+\frac{1}{2}f''(\xi_{1})(0-c)^2\\&f(1)=f(c)+f'(c)(1-c)+\frac{1}{2}f''(\xi_{2})(1-c)^2\end{align}$
其中$\xi_{1},\xi_{2}\in[0,1]$
两式相减有：$f'(c)=f(1)-f(0)-\frac{1}{2}[f''(\xi_{2})(1-c)^2-f''(\xi_{1})c^2]$
于是$|f'(c)|\leqslant|f(1)|+|f(0)|+\frac{1}{2}[|f''(\xi_{2})|(1-c)^2+|f''(\xi_{1})|c^2]$
又有$(1-x)^2+x^2\leqslant1-x+x=1(x\in[0,1])$
因此$|f'(c)|\leqslant2A+\frac{1}{2}B$
由c的任意性，即得结论
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
$f(x)\in D^{(2)}_{(-\infty,+\infty)}$，$M_{0}=\sup\limits_{-\infty<x<+\infty}|f(x)|<+\infty,M_{1}=\sup\limits_{-\infty<x<+\infty}|f''(x)|<+\infty$，试证：$M_{1}=\sup\limits_{-\infty<x<+\infty}|f'(x)|<+\infty$且$M_{1}^2\leqslant2M_{0}M_{2}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$$\begin{align}
f(x+h)=f(x)+f'(x)h+\frac{1}{2}f''(\xi)h^2\quad(\xi在x与x+h之间) \\
f(x-h)=f(x)-f'(x)h+\frac{1}{2}f''(\eta)h^2\quad(\eta在x与x-h之间) 
\end{align}$$
两式相减，$f(x+h)-f(x-h)=2f'(x)h+\frac{h^2}{2}[f''(\xi)-f''(\eta)]$
即$2f'(x)h=f(x+h)-f(x-h)-\frac{h^2}{2}[f''(\xi)-f''(\eta)]$
因此$2|f'(x)|h\leqslant|f(x+h)|+|f(x-h)|+\frac{1}{2}h^2(|f''(\xi)|+|f''(\eta)|)\leqslant2M_{0}+h^2M_{2}$
即$|f'(x)|\leqslant \frac{M_{0}}{h}+\frac{hM_{2}}{2},\forall h>0$
取上确界，有$|M_{1}|\leqslant\sqrt{ 2M_{1}M_{2} }$
即$M_{1}^2\leqslant2M_{0}M_{2}$
证毕


---

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
$\varphi(x)\in D^{(2)}_{[0,+\infty)}$，若$\lim_\limits{ x \to +\infty}\varphi(x)$存在，且$\varphi''(x)$在$[0,+\infty)$上有界。试证：$\lim_\limits{ x \to +\infty}\varphi'(x)=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$\forall h>0,\varphi(x+h)=\varphi(x)+\varphi'(x)h+\frac{1}{2}\varphi''(\xi)h^2$
即$\varphi'(x)=\frac{1}{h}[\varphi(x+h)-\varphi(x)]-\frac{1}{2}\varphi''(\xi)h$
记$A=\lim_\limits{ x \to +\infty}\varphi(x)$
由于$\varphi''(x)$在$[0,+\infty)$上有界，$\exists M>0,s.t.|\varphi''(x)|\leqslant M$
因此，$|\varphi'(x)|\leqslant \frac{1}{h}[|\varphi(x+h)-A|+|A-\varphi(x)|]+\frac{1}{2}Mh$
$\forall \varepsilon>0,$首先取$h>0$充分小，使得$\frac{1}{2}Mh<\frac{\varepsilon}{2}$
固定h，由于$A=\lim_\limits{ x \to +\infty}\varphi(x)$，所以$\exists\Updelta>0,\forall x>\Updelta:\frac{1}{h}[|\varphi(x+h)-A|+|A-\varphi(x)|]< \frac{\varepsilon}{2}$
合起来就得到，$|\varphi'(x)|<\varepsilon$
证毕

#### 3.4.5 函数作图
##### 3.4.5.1 渐近线

> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：曲线的渐近线」</span>
> 若曲线$y=f(x)$上的点$(x,f(x))$到直线$y=ax+b$的距离在$x\to +\infty||-\infty$时趋于0，则称直线$y=ax+b$是曲线$y=f(x)$的一条渐近线。
> 当a=0时称为水平渐近线，否则称为斜渐近线。
> 
> 直线$y=ax+b$是曲线$y=f(x)$的渐近线的充要条件是：
> $\lim_\limits{ x \to +\infty}[f(x)-(ax+b)]=0$或$\lim_\limits{ x \to +\infty}[f(x)-(ax+b)]=0$
> 因此，$a=\lim_\limits{ x \to +\infty} \frac{f(x)}{x},\quad b=\lim_\limits{ x \to  +\infty }[f(x)-ax]$($-\infty$同理)
> 如果上述极限运算对于$x\to \infty$成立，说明直线关于曲线在$x\to+\infty$和$x\to-\infty$两个方向上都是渐近线。
> 除此以外，若$\lim_\limits{ x \to a+}f(x)=\pm \infty$或$\lim_\limits{ x \to a-}f(x)=\pm \infty$，则称直线$x=a$是曲线的一条垂直渐近线。


# 积分
## 1 不定积分 
### 1.1 不定积分
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：不定积分」</span>
> 若在某个区间上，有$F'(x)=f(x)$即$d(F(x))=f(x)dx$，则称$F(x)$是$f(x)$在这个区间上的原函数。
> 一个函数$f(x)$的原函数的全体称为这个函数的不定积分，记作$\displaystyle\int f(x)dx$
> 其中，$\displaystyle\int$称为积分号，$f(x)$称为被积函数，$x$称为积分变量
> 
> ==🖇️Properties：==
> 线性性：若函数$f(x),g(x)$的原函数都存在，则对于任意常数$k_{1},k_{2}$，函数$k_{1}f(x)+k_{2}g(x)$的原函数也存在，且有$\displaystyle\int[k_{1}f(x)+k_{2}g(x)]dx=k_{1}\displaystyle\int f(x)dx+k_{2}\displaystyle\int g(x)dx$
> 此式应当理解为等式两端代表的函数族相同.另外，当$k_{1}=k_{2}=0$时，等式右端应该理解为常数C.

### 1.2 两种积分法
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>换元积分法</span>
>(1)第一换元法——凑微分法，也称直接代换法：设$\displaystyle\int f(u)du=F(u)+C,u=u(x)$可微，则$\displaystyle\int f(u(x))u'(x)dx=F(u(x))+C$
>(2)第二换元法——代入换元法，也称逆代换法：设$\displaystyle\int f(x)dx$存在，$x=x(t)$可微且存在反函数$t=t(x)$，又若$\displaystyle\int f(x(t))x'(t)dt=F(t)+C$，则$\displaystyle\int f(x)dx=F(t(x))+C$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
求基本三角函数的不定积分

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Solution：</span>
$\displaystyle\int \tan x\mathrm{d}x=\displaystyle\int \frac{\sin x}{\cos x}\mathrm{d}x=-\displaystyle\int \frac{(\cos x)'\mathrm{d}x}{\cos x}=-\displaystyle\int \frac{\mathrm{d}(\cos x)}{\cos x}=-\ln|\cos x|+C$
$\begin{align}\displaystyle\int \sec x\mathrm{d}x&=\displaystyle\int \frac{1}{\cos x}\mathrm{d}x=\displaystyle\int \frac{\cos x}{\cos^2 x}\mathrm{d}x=\displaystyle\int \frac{d(\sin x)}{1-\sin^2 x}=\displaystyle\int \frac{d(\sin x)}{(1-\sin x)(1+\sin x)}=\frac{1}{2}\ln \frac{1+\sin x}{1-\sin x}+C\\&=\ln| \frac{1+\sin x}{\cos x}|+C=\ln|\sec x+\tan x|+C\end{align}$
...

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>分部积分法</span>
>设$u(x),v(x)$可微，且在$u(x)v'(x),u'(x)v(x)$中至少有一个存在原函数，则$\displaystyle\int u(x)v'(x)=u(x)v(x)-\displaystyle\int v(x)u'(x)dx$

>[!note] 
>“反对幂三指”，一般将排列次序在后面的函数优先与$\mathrm{d}x$结合

>[!important] 
>若被积函数中含有诸如$\sqrt{ a^2- x^2},\sqrt{ x^2-a^2 },\sqrt{ x^2+a^2 }$这样形式的根式，可以分别考虑将变换取为$x=a\sin t,x=a\sec t,x=a\tan t$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
求不定积分：1)$\displaystyle\int \sqrt{ a^2-x^2 }\mathrm{d}x$ 
2)$\displaystyle\int \sqrt{ x^2+a^2 }\mathrm{d}x$ 或$\displaystyle\int \sqrt{ x^2-a^2 }\mathrm{d}x$
3)(**递推法**)$I_{n}=\displaystyle\int \frac{\mathrm{d}x}{(x^2+a^2)^n}$
4)(**配对法**)$\displaystyle\int \frac{\mathrm{d}x}{1+x^4}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Solution ：</span>
1)
$\begin{align}\displaystyle\int \sqrt{ a^2-x^2 }\mathrm{d}x &\xlongequal{x=a\sin t}a^2\displaystyle\int \cos^2t\mathrm{d}t=\frac{a^2}{2}\displaystyle\int(1+\cos2t)\mathrm{d}t\\&=\frac{a^2}{2}\left( t+\frac{\sin2t}{2} \right)+C\\&=\frac{1}{2}x\sqrt{ a^2-x^2 }+\frac{a^2}{2}\arcsin \frac{x}{a}+C\end{align}$
2)
$\begin{align}\displaystyle\int \sqrt{ x^2+a^2 }\mathrm{d}x&=x\sqrt{ x^2+a^2 }-\displaystyle\int \frac{x^2}{\sqrt{ x^2+a^2 }}\mathrm{d}x\\&=x\sqrt{ x^2+a^2 }-\displaystyle\int \frac{x^2+a^2-a^2}{\sqrt{ x^2+a^2 }}\mathrm{d}x\\&=x\sqrt{ x^2+a^2 }+\displaystyle\int \frac{a^2}{\sqrt{ x^2+a^2 }}\mathrm{d}x-\displaystyle\int \sqrt{ x^2+a^2 }\mathrm{d}x\end{align}$
解得，$\displaystyle\int \sqrt{ x^2+ a^2 }\mathrm{d}x=\frac{1}{2}(x\sqrt{ x^2+ a^2 }+ a^2\ln|x+\sqrt{ x^2+ a^2 }|)+C$
3)当$n=1$时，$I_{1}=\displaystyle\int \frac{\mathrm{d}x}{x^2+a^2}=\frac{1}{a}\arctan \frac{x}{a}+C$ 
当$n\geqslant2$时，$I_{n}=\displaystyle\int \frac{\mathrm{d}x}{(x^2+a^2)^n}=\frac{1}{a^2}I_{n}=\displaystyle\int \frac{x^2+a^2-x^2}{(x^2+a^2)^n}\mathrm{d}x=\frac{I_{n-1}}{a^2}+\frac{1}{a^2}\displaystyle\int \frac{-x^2\mathrm{d}x}{(x^2+a^2)^n}$
对后一项使用分部积分，得$I_{n}=\frac{2n-3}{2a^2(n-1)}I_{n-1}+\frac{1}{2a^2(n-1)}\cdot \frac{x}{(x^2+a^2)^{n-1}}$
故得到递推关系：
$\begin{cases}I_{n}=\frac{2n-3}{2a^2(n-1)}I_{n-1}+\frac{1}{2a^2(n-1)}\cdot \frac{x}{(x^2+a^2)^{n-1}},n\geqslant2\\I_{1}=\frac{1}{a}\arctan \frac{x}{a}+C\end{cases}$
4)令$M(x)=\displaystyle\int \frac{\mathrm{d}x}{1+x^4},N(x)=\displaystyle\int \frac{x^2\mathrm{d}x}{1+x^4}$，则有：
$\begin{align}M(x)-N(x)&=\displaystyle\int\frac{1-x^2}{1+x^4}\mathrm{d}x=-\displaystyle\int \frac{1-\frac{1}{x^2}}{x^2+\frac{1}{x^2}}\mathrm{d}x\\&=-\displaystyle\int \frac{\mathrm{d}\left( x+\frac{1}{x} \right)}{\left( x+\frac{1}{x} \right)^2-2}=-\frac{1}{2\sqrt{ 2 }}\ln\frac{x^2-\sqrt{ 2 }x+1}{x^2+\sqrt{ 2 }x+1}+C\end{align}$
$\begin{align}M(x)+N(x)&=\displaystyle\int\frac{1+x^2}{1+x^4}\mathrm{d}x=\displaystyle\int \frac{1+\frac{1}{x^2}}{x^2+\frac{1}{x^2}}\mathrm{d}x\\&=\displaystyle\int \frac{\mathrm{d}\left( x-\frac{1}{x} \right)}{\left( x-\frac{1}{x} \right)^2+2}=\frac{1}{\sqrt{ 2 }}\arctan  \frac{x^2-1}{\sqrt{ 2 }x}+C\end{align}$
解得：$M(x)=-\frac{1}{4\sqrt{ 2 }}+\ln\frac{x^2-\sqrt{ 2 }x+1}{x^2+\sqrt{ 2 }x+1}+\frac{1}{2\sqrt{ 2 }}\arctan  \frac{x^2-1}{\sqrt{ 2 }x}+C$


| 基本积分表                                                                                                                     |
| ------------------------------------------------------------------------------------------------------------------------- |
| $\displaystyle\int \ln x\mathrm{d}x=x\ln x-x+C$                                                                           |
|                                                                                                                           |
| $\displaystyle\int \frac{\mathrm{d}x}{\sqrt{ a^2-x^2 }}=\arcsin \frac{x}{a}+C$                                            |
| $\displaystyle\int \frac{\mathrm{d}x}{\sqrt{ x^2\pm a^2 }}=\ln\|x+\sqrt{ x^2\pm a^2 }\|+C$                                |
|                                                                                                                           |
| $\displaystyle\int \frac{\mathrm{d}x}{x^2-a^2}=\frac{1}{2a}\ln\| \frac{x-a}{x+a}\|+C$                                     |
| $\displaystyle\int \frac{\mathrm{d}x}{x^2+a^2}=\frac{1}{a}\arctan  \frac{x}{a}+C$                                         |
|                                                                                                                           |
| $\displaystyle\int \sqrt{ a^2-x^2 }\mathrm{d}x=\frac{1}{2}x\sqrt{ a^2-x^2 }+\frac{a^2}{2}\arcsin  \frac{x}{a}+C$          |
| $\displaystyle\int \sqrt{ x^2\pm a^2 }\mathrm{d}x=\frac{1}{2}(x\sqrt{ x^2\pm a^2 }\pm a^2\ln\|x+\sqrt{ x^2\pm a^2 }\|)+C$ |
|                                                                                                                           |
| $\displaystyle\int \tan x\mathrm{d}x=-\ln\|\cos x\|+C$                                                                    |
| $\displaystyle\int \cot x\mathrm{d}x=\ln\|\sin x\|+C$                                                                     |
|                                                                                                                           |
| $\displaystyle\int \sec x\mathrm{d}x=\ln\|\sec x+\tan x\|+C$                                                              |
| $\displaystyle\int \csc x\mathrm{d}x=\ln\|\csc x-\cot x\|+C$                                                              |

### 1.3 几类可积函数
#### 1.3.1 有理函数
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:有理函数的积分</span>
>有理函数都可以分解为多项式加上有理真分式的形式，多项式的积分是显然的，因此只需要考虑有理真分式的积分即可
>由有理真分式的分解定理，$\huge{\frac{p_{m}(x)}{q_{n}(x)}}=\sum\limits_{k=1}^{i}\sum\limits_{r=1}^{m_{k}} \frac{\lambda_{kr}}{(x-\alpha_{k})^r}+\sum\limits_{k=1}^{j}\sum\limits_{r=1}^{n_{k}} \frac{\mu_{kr}x+\nu_{kr}}{(x^2+2\xi_{k}x+\eta_{k}^2)^r}$
>这里只涉及到两种类型：
>$1^\circ$ $\displaystyle\int \frac{\mathrm{d}x}{(x-\alpha)^n}=\begin{cases}\ln|x-\alpha|+C,&n=1\\-\frac{1}{n-1}\cdot \frac{1}{(x-\alpha)^{n-1}},&n\geqslant2\end{cases}$
>$2^\circ$ $I_{n}=\displaystyle\int \frac{\mu x+\nu}{(x^2+2\xi x+\eta^2)}\mathrm{d}x$



#### 1.3.2 三角有理函数
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:三角有理函数的积分</span>
>对于$R(\sin x,\cos x)$类型的积分，利用万能公式$\tan \frac{x}{2}=t$进行代换，有：
>$\sin x=\frac{2t}{1+t^2},\cos t=\frac{1-t^2}{1+t^2}$
>于是，$\displaystyle\int R(\sin x,\cos x)\mathrm{d}x=\displaystyle\int R\left( \frac{2t}{1+t^2},\frac{1-t^2}{1+t^2} \right) \frac{2}{1+t^2}\mathrm{d}t$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
1)(Poisson积分)$\displaystyle\int \frac{1-r^2}{1-2r\cos x+r^2}\mathrm{d}x(-1<r<1)$

#### 1.3.3 无理函数积分的例子


## 2 定积分
### 2.1 Riemann积分与可积性理论
#### 2.1.1 Riemann积分
 ><span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：定积分」</span>
 >设$f(x)$是定义在$[a,b]$上的有界函数，在$[a,b]$上任意取分点$\{ x_{i} \}^n_{i=0}$形成一种划分$P:a=x_{0}<x_{1}<\dots<x_{n}=b$，并任意取点$\xi_{i}\in[x_{i-1},x_{i}]$。记小区间$[x_{i-1},x_{i}]$的长度为$\Delta x_{i}=x_{i}-x_{i-1}$，令$\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})$，若当$\lambda \to0$时，极限$\lim_\limits{ \lambda \to 0 }\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}$存在，且极限值既与划分$P$无关，又与对$\xi_{i}$的取法无关，则称$f(x)$在$[a,b]$上Riemann可积。
 >>[!note] 
 >>划分$\to$介点$\to$求和$\to$取极限
 >和式$S_{n}=\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}$称为Riemann和，其极限值$I$称为$f(x)$在$[a,b]$上的定积分，记作$I=\displaystyle\int_{a}^b f(x) \mathrm{d}x$，这里的$a,b$分别称为定积分的上限和下限。
 >也可以表述为：$\exists I,\forall \varepsilon>0,\exists\delta>0,s.t.\forall P(\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta),\forall \{ \xi_{i}\}:|\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}-I|<\varepsilon$，则称$f(x)$在$[a,b]$上Riemann可积，称$I$是$f(x)$在$[a,b]$上的定积分。
 >
 >==🖇️Properties：==
 >1)(**唯一性**)
 >
 >2)(**有界性**)若$f(x)$在$[a,b]$上Riemann可积，则$f(x)$在$[a,b]$上有界。
 > >[!note] 
 > >有界函数不一定Riemann可积，如Dirichlet函数

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
1)
**唯一性**
假设有两个积分值，证明它们相等即可($|I_{1}-I_{2}|<\varepsilon$)，证明方法类似于数列极限唯一性

2)
**有界性**
反证
设$\lim_\limits{ \lambda \to 0 }\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}=I$，则
取$\varepsilon=1,\exists\delta>0,\forall P(\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta),\forall\xi_{i}\in[x_{i-1},x_{i}]:|I|-1<|\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}|<|I|+1$
若$f(x)$在$[a,b]$上无界，不妨设$f(x)$在$[x_{0},x_{1}]$上无界，
则有$\xi_{1}$使得$|f(\xi_{1})\Delta x_{1}|>|I|+|\sum\limits_{j=2}^nf(\xi_{j})\Delta x_{j}|+1$，则
$\begin{align}|I|+1&>|\sum\limits_{j=1}^{n}f(\xi_{j})\Delta x_{j}|\geqslant|f(\xi_{1})\Delta x_{1}|-|\sum\limits_{j=2}^nf(\xi_{j})\Delta x_{j}|\\&\geqslant|I|+|\sum\limits_{j=2}^nf(\xi_{j})\Delta x_{j}|+1-|\sum\limits_{j=2}^nf(\xi_{j})\Delta x_{j}|=|I|+1\end{align}$

矛盾


#### 2.1.2 Riemann可积的充要条件

 > <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：Darboux和」</span>
 > 记$f(x)$在$[a,b]$上的上确界和下确界分别为$M,m$，显然有$m\leqslant f(x)\leqslant M$
 > 记$f(x)$在$[x_{i-1},x_{i}]$上的上确界和下确界分别为$M_{i},m_{i}(i=1,2,\dots n)$，即$M_{i}=\sup\{ f(x)|x\in[x_{i-1},x_{i}] \},m=\inf\{ f(x)|x\in[x_{i-1},x_{i}] \}$
 > 取定划分$P$后，定义和式$\bar{S}(P)=\sum\limits_{i=1}^{n}M_{i}\Delta x_{i},\underline{S}(P)=\sum\limits_{i=1}^{n}m_{i}\Delta x_{i}$，它们分别被称为对应于划分$P$的Darboux大和和Darboux小和
 > 
 > ==🖇️Properties：==
 > 1)$\underline{S}(P)\leqslant\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}\leqslant \bar{S}(P)$
 > 2)若在原划分中加入分点形成新的划分，则大和不增，小和不减
 > 3)记$\boldsymbol{\bar{S}}$是Darboux大和的集合，$\boldsymbol{\underline{S}}$是Darboux小和的集合。$\forall \bar{S}(P_{1})\in \boldsymbol{\bar{S}},\underline{S}(P_{2})\in \boldsymbol{\underline{S}},$恒有：$m(b-a)\leqslant \underline{S}(P_{2})\leqslant \bar{S}(P_{1})\leqslant M(b-a)$
 > 4)记$L=\inf\{ \bar{S}(P)|\bar{S}(P)\in \boldsymbol{\bar{S}} \},l=\sup\{ \underline{S}(P)|\underline{S}(P)\in \boldsymbol{\underline{S}} \}$，分别称为上积分和下积分，恒有：$l\leqslant L$
 > 5)(**Darboux定理**)$\forall f(x)\in B[a,b]$，恒有：$\lim_\limits{ \lambda \to  0 }\bar{S}(P)=L,\lim_\limits{ \lambda \to  0 }\underline{S}(P)=l$
 
<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>

**2)**
设$\bar{S}(P)$和$\underline{S}(P)$分别是对应于某一划分$P$的Darboux大和和Darboux小和，设相应的分点为$\{ x_{i} \}_{i=1}^n$
不失一般性，我们证明对这种划分新增一个新的分点后得到的新划分$P'$有：$\bar{S}(P')\leqslant \bar{S}(P),\underline{S}(P')\geqslant \underline{S}(P)$
设增加的新分点为$x'\in (x_{i-1},x_{i})$，记$f(x)$在$[x_{i-1},x'],[x',x_{i}]$上的上确界分别为$M'_{i},M''_{i}$，则显然有：$M_{i}'<M_{i},M_{i}''<M_{i}$
于是$M_{i}'(x'-x_{i-1})+M''_{i}(x_{i}-x')\leqslant M_{i}(x'-x_{i-1})+M_{i}(x_{i}-x')=M_{i}(x_{i}-x_{i-1})$
而此时$\bar{S}(P)$和$\bar{S}(P')$中的其他项都没有变化，因此$\bar{S}(P')\leqslant \bar{S}(P)$
同理可证$\underline{S}(P')\geqslant \underline{S}(P)$

**3)**
任意一种划分都可以看成是由$n=1$的划分$a=x_{0}<x_{1}<b$中插入若干分点所产生的新划分，由Lemma-1，有$m(b-a)\leqslant \underline{S}(P_{2})$和$\bar{S}(P_{1})\leqslant M(b-a)$
对于$\underline{S}(P_{2})\leqslant \bar{S}(P_{1})$:
若$P_{1}$和$P_{2}$是同一种划分，则已成立；
若不是，将它们的分点合起来得到一种新的划分$P$，有$\underline{S}(P_{2})\leqslant \underline{S}(P)\leqslant \bar{S}(P)\leqslant \bar{S}(P_{1})$

**Darboux定理**
只对大和进行证明，小和可类似证明
$1^\circ$由于L是$\boldsymbol{\bar{S}}$的下确界，$\forall \varepsilon>0,\exists \bar{S}(P')\in \boldsymbol{\bar{S}},s.t.L\leqslant \bar{S}(P')<L+ \frac{\varepsilon}{2}$
设对应于$P'$的划分为$P':a=x_{0}'<x_{1}'<\dots<x'_{p}=b$
$2^\circ$取$\delta=\min\left\{  \Delta x_{1}',\Delta x_{2}',\dots\Delta x'_{p}, \frac{\varepsilon}{2(p-1)(M-m)}  \right\}$
$3^\circ$对于任何一个满足$\lambda=\min\limits_{1\leqslant i\leqslant n}\{ \Delta x_{i} \}<\delta$的划分：$P:a=x_{0}<x_{1}<\dots<x_{n}=b$
$4^\circ$在$\{ x_{i} \}_{i=1}^n$中插入$\{ x_{j} \}_{j=0}^p$(即将$P'$和$P$合并)，形成新的划分$P^*$，由Lemma-1，有$\bar{S}(P')\geqslant \bar{S}(P^*)$
将对应于$P$的区间$x_{i-1},x_{i}$分为两类：
(1)$(x_{i-1},x_{i})$中不含有新插入的分点，这时$\bar{S}(P)$和$\bar{S}(P^*)$中对应项同为$M_{i}\Delta x_{i}$
(2)$(x_{i-1},x_{i})$中含有新插入的分点，这样的区间至多只有$p-1$个
由于$\forall i,j:\Delta x_{i}\leqslant\delta\leqslant\Delta x_{j}',\quad(i=1,2\dots n;j=1,2\dots p)$，所以在$[x_{i-1},x_{i}]$中只有一个新插入的分点$x_{j}'$
这时$\bar{S}(P)$和$\bar{S}(P^*)$中对应项的差为：
$M_{i}(x_{i}-x_{i-1})-[M_{i}'(x_{j}'-x_{i-1})+M''_{i}(x_{i}-x_{j}')]\leqslant(M-m)(x_{i}-x_{i-1})<(M-m)\delta$
于是$\bar{S}(P)-\bar{S}(P^*)<(p-1)(M-m)\delta\leqslant \frac{\varepsilon}{2}$
于是$0\leqslant \bar{S}(P)-L=[\bar{S}(P)-\bar{S}(P^*)]+[\bar{S}(P^*)-\bar{S}(P')]+[\bar{S}(P')-L]< \frac{\varepsilon}{2}+\frac{\varepsilon}{2}=\varepsilon$
证毕

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Riemann可积的充要条件</span>
>有界函数$f(x)$在$[a,b]$上Riemann可积的充要条件是：
>**第一充要条件** 上下积分相等，即$\forall P(\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta):\lim_\limits{ \lambda \to  0 } \bar{S}(P)=L=l= \lim_\limits{ \lambda \to  0 } \underline{S}(P)$
>
>记$\omega_{i}=M_{i}-m_{i}$为$f(x)$在$[x_{i-1},x_{i}]$上的振幅，有：
>**第二充要条件**  振幅和极限为零，即$\forall P(\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta):\lim_\limits{ \lambda \to  0 } \sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}=0$
>**Corollary-1** 闭区间上的连续函数必定可积
>**Corollary-2** 闭区间上的单调函数必定可积
>
>**第三充要条件** $\forall \varepsilon>0,\exists P:\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}<\varepsilon$
>**Corollary-1** 振幅不能任意小的区间总长度可以任意小，即$\forall \varepsilon,\eta>0,\exists P$，使得振幅$\omega$不小于$\eta$的子区间的长度之和小于$\varepsilon$ 
>**Corollary-2** 闭区间上只有有限个不连续点的有界函数必定可积
>

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
**第一充要条件**
$\Longleftarrow$ 
由Darboux和的定义，对于任意一种划分$P$，有：
$\underline{S}(P)\leqslant\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}\leqslant \bar{S}(P)$
若$\lim_\limits{ \lambda \to  0 } \bar{S}(P)= \lim_\limits{ \lambda \to  0 } \underline{S}(P)=I$，则两侧取极限，有：
$\lim_\limits{ \lambda \to  0 } \sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}=I$
$\Longrightarrow$
设$f(x)$可积且积分值为I
$\forall \varepsilon>0,\exists\delta>0,\forall P(\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta)$，取$\xi_{i}$是$[x_{i-1},x_{i}]$中满足$0\leqslant M_{i}-f(\xi_{i})< \frac{\varepsilon}{2(b-a)}$的点(由于$M_{i}$是$f(x)$在$[x_{i-1},x_{i}]$中的上确界，因此这样的$\xi_{i}$总是可以取到)，则有：
$|\sum\limits_{i=1}^{n}f(\xi_{i}\Delta x_{i})-I|< \frac{\varepsilon}{2}$
又有：
$|\bar{S}(P)-\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}|=\sum\limits_{i=1}^{n}[M_{i}-f(\xi_{i})]\Delta x_{i}< \frac{\varepsilon}{2(b-a)}(b-a)= \frac{\varepsilon}{2}$
于是：
$|\bar{S}(P)-I|\leqslant|\sum\limits_{i=1}^{n}f(\xi_{i}\Delta x_{i})-I|+|\bar{S}(P)-\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}|< \frac{\varepsilon}{2}+\frac{\varepsilon}{2}=\varepsilon$
这就是$\lim_\limits{ \lambda \to  0 } \bar{S}(P)=I$
同理可证$\lim_\limits{ \lambda \to  0 } \underline{S}(P)=I$

**第二充要条件**
由第一充要条件，
$\lim_\limits{ \lambda \to 0} \sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}=\lim_\limits{ \lambda \to 0} \sum\limits_{i=1}^{n}(M_{i}-m_{i})\Delta x_{i}=\lim_\limits{ \lambda \to 0} [\sum\limits_{i=1}^{n}M_{i}\Delta x_{i}-\sum\limits_{i=1}^{n}m_{i}\Delta x_{i}]=\lim_\limits{ \lambda \to 0} \sum\limits_{i=1}^{n}M_{i}\Delta x_{i}-\lim_\limits{ \lambda \to 0} \sum\limits_{i=1}^{n}m_{i}\Delta x_{i}$

**Corollary-1**

**Corollary-2**

**第三充要条件**
$\Longleftarrow$ 
由第二充要条件，$\lim_\limits{ \lambda \to  0 } \sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}=0$
即$\forall \varepsilon>0,\exists\delta>0,\forall P(\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta):-\varepsilon<\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}<\varepsilon$
因此划分的存在性已证
$\Longrightarrow$
$1^\circ$ $\forall \varepsilon>0,\exists P':\sum\limits_{i=1}^{p}\omega_{i}'\Delta x_{i}'< \frac{\varepsilon}{3}$即$\bar{S}(P')-\underline{S}(P')< \frac{\varepsilon}{3}$
$2^\circ$ 取$\delta=\min\left\{  \Delta x_{1}',\Delta x_{2}',\dots\Delta x_{p}', \frac{\varepsilon}{3(p-1)(M-m)}  \right\}$
$3^\circ$ 对于任意一个满足$\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta$的划分$P':a=x_{0}<x_{1}\dots<x_{n}=b$
$4^\circ$ 将$P,P'$的分点组合在一起获得新的划分$P^*$
仿照Darboux定理的证明，有：
$\begin{align}0\leqslant \bar{S}(P)-\underline{S}(P)&=[\bar{S}(P)-\bar{S}(P^*)]+[\bar{S}(P^*)-\bar{S}(P')]+[\bar{S}(P')-\underline{S}(P')]+[\underline{S}(P')-\underline{S}(P^*)]+[\underline{S}(P^*)-\underline{S}(P)]\\&< \frac{\varepsilon}{3}+0+\frac{\varepsilon}{3}+0+\frac{\varepsilon}{3}\\&=\varepsilon\end{align}$

**Corollary-1**
设在$[a,b]$上有$m\leqslant f(x)\leqslant M$
$\Longleftarrow$ 
对于$\forall \varepsilon>0$，取$\varepsilon'= \frac{\varepsilon}{2(M-m)},\eta= \frac{\varepsilon}{2(b-a)}$
根据条件，$\exists P$，使得振幅不小于$\eta$的子区间的长度之和小于$\varepsilon'$
有
$\begin{align}\sum\limits_{\omega_{i}\geqslant\eta}\omega_{i}\Delta x_{i}+\sum\limits_{\omega_{i}<\eta}\omega_{i}\Delta x_{i}&\leqslant(M-m)\sum\limits_{\omega_{i}\geqslant\eta}\Delta x_{i}+\eta\sum\limits_{\omega_{i}<\eta}\Delta x_{i}\\&\leqslant(M-m)\varepsilon'+\eta(b-a)\\&<\varepsilon\end{align}$
由第三充要条件即证
$\Longrightarrow$
由第二充要条件，$\forall \varepsilon,\eta>0,\exists P:\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}<\varepsilon\eta$
因此有：
$\eta \sum\limits_{\omega_{i}\geqslant\eta}\Delta x_{i}\leqslant\sum\limits_{\omega_{i}\geqslant\eta}\omega_{i}\Delta x_{i}\leqslant\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}<\varepsilon\eta$
即$\sum\limits_{\omega_{i}\geqslant\eta}\Delta x_{i}<\varepsilon$，即振幅不小于$\eta$的子区间的长度之和小于$\varepsilon$

**Corollary-2**






>[!info] 
>**可积性的证明方法**
>1)若$\sum\limits_{i=1}^{n}\omega_{i}$有界，可以利用$\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}\leqslant(b-a)\sum\limits_{i=1}^{n}\omega_{i}$(如证明单调函数的可积性)
>2)证明$\omega_{i}<\varepsilon(i=1,2\dots)$，从而$\sum\omega_{i}\Delta x_{i}<\varepsilon\sum\Delta x_{i}<\varepsilon(b-a)$
>3)拆分振幅和：$\sum\omega_{i}\Delta x_{i}=\sum'\omega_{i}\Delta x_{i}+\sum''\omega_{i}\Delta x_{i}$
>$\sum'$中，$\omega_{i}< \frac{\varepsilon}{b-a}$
>$\sum''$中，$\sum''\Delta x_{i}< \frac{\varepsilon}{\Omega}$($\Omega$代表整个区间的振幅)
>4)利用$\omega_{i}^f\leqslant\omega^g_{i}$(分别代表$f,g$在第i个小区间的振幅)，然后由$g$的可积性推出$f$的可积性(比如根据$f$的可积性推出$|f|$的可积性)



#### 2.1.3 Lebesgue定理


> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：零测集」</span>
> 设$A$为实数集，如果$\forall \varepsilon>0$，存在至多可数个开区间$\{ I_{n}:n\in \mathbb{N}^* \}$组成$A$的一个开覆盖，并且$\sum\limits_{n=1}^{\infty}|I_{n}|\leqslant \varepsilon$($|I_{n}|$表示开区间的长度)，那么$A$称为零测度集，简称零测集。
> 如果某个性质在一个零测度集外成立，就说这个性质几乎处处成立。
> ==🖇️Properties：==
> 1)若$A$是至多可数集，那么$A$一定是零测集
> 2)至多可数个零测集的并集是零测集
> 3)设$A$为零测集，若$B\subset A$，那么$B$也是零测集
> 
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Lebesgue定理</span>
>**Lemma-1** 设$\omega$是有界函数$f(x)$在$[a,b]$上的振幅，那么：
>$\omega=\sup\{ |f(y_{1})-f(y_{2})|:y_{1},y_{2}\in[a,b] \}$
>
>**Lemma-2** 函数$f(x)$在点$x\in I$处连续的充要条件是$\omega_{f}(x)=0$
>
>记$D(f)$为$f(x)$在$[a,b]$上不连续点的全体
>对于$\delta>0$，记$D_{\delta}=\{ x\in[a,b]:\omega_{f}(x)\geqslant\delta \}$
>**Lemma-3** $D(f)=\bigcup\limits_{n=1}^\infty D_{\frac{1}{n}}$
>
>**Lemma-4** 一元实函数$f(x)$在$[a,b]$上，如果存在一列区间$(\alpha_{j},\beta_{j})(j=1,2,\dots),s.t.D(f)\subset\bigcup\limits_{j=1}^\infty(\alpha_{j},\beta_{j})$，记$K=[a,b]\setminus\bigcup\limits_{j=1}^\infty(\alpha_{j},\beta_{j})$，那么：
>$\forall \varepsilon>0,\exists\delta>0,\forall x\in K,y\in[a,b](|x-y|<\delta):|f(x)-f(y)|<\varepsilon$
>
>**Lebesgue定理** 设$f(x)\in B_{[a,b]}$，那么$f(x)\in R_{[a,b]}$的充要条件是：$f(x)$在$[a,b]$上几乎处处连续

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
**Lemma-1**
用$M,m$表示$f(x)$在$[a,b]$上的上下确界，那么按定义$\omega=M-m$
$\forall y_{1},y_{2}\in[a,b]:m\leqslant f(y_{i})\leqslant M\,(i=1,2)$
所以有$|f(y_{1})-f(y_{2})|\leqslant M-m=\omega\quad(1)$
又有$M=\sup\{ f(y):y\in[a,b] \},m=\inf\{ f(y):y\in[a,b] \}$
因此，$\forall \varepsilon>0,\exists y_{1},y_{2},s.t.f(y_{1})>M- \frac{\varepsilon}{2};f(y_{2})<m+ \frac{\varepsilon}{2}$
由此：$|f(y_{1})-f(y_{2})|\geqslant f(y_{1})-f(y_{2})>M-m-\varepsilon=\omega-\varepsilon \quad(2)$
由$(1),(2)$，可得$\omega=\sup\{ |f(y_{1})-f(y_{2})|:y_{1},y_{2}\in[a,b] \}$

**Lemma-2**
$\Longrightarrow$
设$f(x)$在$x$处连续，于是$\forall \varepsilon>0,\exists\delta>0,\forall y\in U(x,\delta):|f(y)-f(x)|< \frac{\varepsilon}{2}$
因此，$\forall y_{1},y_{2}\in U(x.\delta)$时，有：
$\begin{align}|f(y_{1})-f(y_{2})|&\leqslant|f(y_{1})-f(x)|+|f(x)-f(y_{2})|\\&< \frac{\varepsilon}{2}+ \frac{\varepsilon}{2}=\varepsilon\end{align}$
由此可得$\omega_{f}(x,\delta)\leqslant\varepsilon$，令$\delta\to0^+$，得到$0\leqslant\omega_{f}(x)\leqslant \varepsilon$，即$\omega_{f}(x)=0$

$\Longleftarrow$
由于$\omega_{f}(x)=0$，由定义得：$\forall \varepsilon>0,\exists\delta>0,s.t.\omega(x,\delta)<\varepsilon$
因此$\forall y\in U(x,\delta)$，有：
$|f(x)-f(y)|\leqslant\omega_{f}(x,\delta)<\varepsilon$
即函数$f(x)$在$x$点连续

**Lemma-3**
由Lemma-2，$D_{\frac{1}{n}}$中的点都是$f(x)$的不连续点，因此：$\bigcup\limits_{n=1}^{\infty}D_{\frac{1}{n}}\subset D(f)$
反之，任取$x\in D(f)$，由于$f(x)$在$x$处不连续，因此$\omega_{f}(x)>0$
取$m$充分大，使得$\omega_{f}(x)\geqslant \frac{1}{m}$，即$x\in D_{\frac{1}{m}}$，因而$D(f)\subset \bigcup\limits_{n=1}^{\infty} D_{\frac{1}{n}}$
因此，$D(f)=\bigcup\limits_{n=1}^\infty D_{\frac{1}{n}}$

**Lemma-4**
反证
假设结论不成立，于是$\exists \varepsilon_{0}>0,\forall\delta_{n}=\frac{1}{n},\exists s_{n}\in K,t_{n}\in[a,b]\left( |s_{n}-t_{n}|< \frac{1}{n} \right):|f(s_{n})-f(t_{n})|\geqslant \varepsilon_{0}$
由于$\{ s_{n} \}\subset K\subset[a,b]$，故由聚点原理，存在$\{ s_{n} \}$的子列$\{ s_{k_{n}} \},s.t.\lim_\limits{ n \to \infty }s_{k_{n}}=s^*$
显然，$s^*\in K$，又有：
$\begin{align}|t_{s_{n}}-s^*|&\leqslant|t_{s_{k_{n}}}-s_{k_{n}}|+|s_{k_{n}}-s^*|\\&< \frac{1}{k_{n}}+|s_{k_{n}}-s^*|\\&< \frac{1}{n}+|s_{k_{n}}-s^*|\end{align}$
由此知$t_{k_{n}}\to s^*(n\to \infty)$
又有$|f(s_{k_{n}})-f(t_{k_{n}})|\geqslant \varepsilon_{0}$
由于$s^*\in K$，故$f(x)$在$s^*$处连续，在上式的左边令$n\to \infty$，得：
$0=|f(s^*)-f(s^*)|\geqslant \varepsilon_{0}$
矛盾

**Lebesgue定理**
$\Longrightarrow$
只需证对于任意的$\delta>0,D_{\delta}$是零测集，从而$D_{1},D_{\frac{1}{2}}\dots$都是零测集，由Lemma-3得$D(f)$是零测集
由可积，得$\forall \varepsilon>0,\exists P(a=x_{0}<x_{1}<\dots<x_{m}=b):\sum\limits_{i=1}^{m}\omega_{i}\Delta x_{i}< \frac{\delta \varepsilon}{2}$
设$x\in D_{\delta}$，如果$x$不是$x_{0},x_{1},\dots x_{m}$中的一个，则$\exists i\in \{ 1,2,\dots m \},s.t.x\in(x_{i-1},x_{i});\exists r>0,s.t.(x-r,x+r)\subset(x_{i-1},x_{i})$
于是$f(x)$在$[x_{i-1},x_{i}]$上的振幅$\omega_{i}\geqslant \omega_{f}(x,r)\geqslant \omega_{f}(x)\geqslant\delta$
用$\sum',\bigcup'$表示对于满足$D_{\delta}\cap(x_{i-1},x_{i})\neq \phi$的$i$的求和和求并，那么：
$\frac{\delta \varepsilon}{2}>\sum\limits_{i=1}^{m}\omega_{i}\Delta x_{i}\geqslant\sum'\omega_{i}\Delta x_{i}\geqslant\delta\sum'\Delta x_{i}$
由此得：$\sum'\Delta x_{i}< \frac{\varepsilon}{2}$
于是$D_{\delta}\subset(\bigcup'(x_{i-1},x_{i}))\cup \{ x_{0},x_{1},\dots x_{m} \}$
自然更有：$D_{\delta}\subset\left( \bigcup'(x_{i-1},x_{i}) \right)\cup\left( \bigcup\limits_{j=0}^m\left( x_{j}- \frac{\varepsilon}{4(m+1)},x_{j}+\frac{\varepsilon}{4(m+1)}, \right) \right)$
又有$\sum'\Delta x_{i}+(m+1) \frac{2\varepsilon}{4(m+1)}< \frac{\varepsilon}{2}+ \frac{\varepsilon}{2}=\varepsilon$
这就证明了$D_{\delta}$是零测集

$\Longleftarrow$
设$D(f)$是零测集，并且$\forall \varepsilon>0,\exists \{ (\alpha_{i},\beta_{i})|i=1,2,\dots \},s.t.D(f)\subset \bigcup\limits_{i=0}^\infty(\alpha_{i},\beta_{i}),\quad\sum\limits_{i=1}^{\infty}(\beta_{i}-\alpha_{i})< \frac{\varepsilon}{2\omega}$(这里的$\omega$是$f(x)$在$[a,b]$上的振幅)
令$K=[a,b]\setminus \bigcup\limits_{i=0}^\infty(\alpha_{i},\beta_{i})$
由Lemma-4，对于上述的$\varepsilon>0,\exists\delta>0,\forall|x-y|<\delta(x\in K,y\in[a,b]):|f(x)-f(y)|< \frac{\varepsilon}{4(b-a)}$
取分划$P:a=x_{0}<x_{1}<\dots x_{n}=b,s.t.\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta$
记$\sum\limits_{i=1}^{\infty}\omega_{i}\Delta x_{i}=\sum_{1}\omega_{i}\Delta x_{i}+\sum_{2}\omega_{i}\Delta x_{i}$
其中$\sum_{1}$表示对于满足$K\cap(x_{i-1},x_{i})\neq \phi$的$i$求和，$\sum_{2}$表示对于满足$K\cap(x_{i-1},x_{i})= \phi$的$i$求和，
- 对于$\sum_{1}$中的项，由于$K\cap(x_{i-1},x_{i})\neq \phi$，任取$y_{i}\in K\cap(x_{i-1},x_{i})$，有：
$\begin{align}\omega_{i}&=\sup\{ |f(z_{1})-f(z_{2})| :z_{1},z_{2}\in[x_{i-1},x_{i}] \}\\&\leqslant\sup\{ |f(z_{1})-f(y_{i})| +|f(z_{2})-f(y_{i})|:z_{1},z_{2}\in[x_{i-1},x_{i}],y_{i}\in K\cap(x_{i-1},x_{i}) \}\\&\leqslant \frac{\varepsilon}{2(b-a)}\end{align}$
因此$\sum_{1}\omega_{i}\Delta x_{i}< \frac{\varepsilon}{2(b-a)}(b-a)= \frac{\varepsilon}{2}$
- 对于$\sum_{1}$中的项，由于$\omega_{i}\leqslant\omega$，于是$\sum_{2}\omega_{i}\Delta x_{i}\leqslant\omega\sum_{2}\Delta x_{i}$
当$x\in(x_{i-1},x_{i})$时，$x\not\in K$，因而$x\in\bigcup\limits_{i=0}^\infty(\alpha_{i},\beta_{i})$，即$(x_{i-1},x_{i})\subset\bigcup\limits_{i=0}^\infty(\alpha_{i},\beta_{i})$，因而：
$\sum_{2}\Delta x_{2}\leqslant\sum\limits_{i=1}^{\infty}(\beta_{i}-\alpha_{i})< \frac{\varepsilon}{2\omega}$
两式综合有：$\sum_{2}\omega_{i}\Delta x_{i}\leqslant \frac{\varepsilon}{2}$
于是$\sum\limits_{i=1}^{\infty}\omega_{i}\Delta x_{i}<\varepsilon$
于是$f(x)$在$[a,b]$上可积
证毕
### 2.2 定积分的性质
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:定积分的性质</span>
>1)(**线性性质**)设$f(x),g(x)\in R[a,b]$，$k_{1},k_{2}$是常数，则函数$k_{1}f(x)+k_{2}g(x)\in R[a,b]$，且有：
>$\displaystyle\int_{a}^b[k_{1}f(x)+k_{2}g(x)]\mathrm{d}x=k_{1}\displaystyle\int_{a}^bf(x)\mathrm{d}x+k_{2}\displaystyle\int_{a}^bg(x)\mathrm{d}x$
>
>2)(**乘积可积性**)设$f(x),g(x)\in R[a,b]$，$k_{1},k_{2}$，则$f(x)\cdot g(x)\in R[a,b]$
>>[!note] 
>>一般来说，$\displaystyle\int_{a}^b f(x)g(x)\mathrm{d}x\neq\left( \displaystyle\int_{a}^b f(x)\mathrm{d}x \right)\cdot\left( \displaystyle\int_{a}^b g(x)\mathrm{d}x \right)$
>
>3)(**保序性**)设$f(x),g(x)\in R[a,b]$，且在$[a,b]$上恒有$f(x)\geqslant g(x)(f(x)>g(x))$，则成立$\displaystyle\int_{a}^b f(x)\mathrm{d}x\geqslant\displaystyle\int_{a}^b g(x)\mathrm{d}x(\displaystyle\int_{a}^b f(x)\mathrm{d}x>\displaystyle\int_{a}^b g(x)\mathrm{d}x)$
>**Corollary** 设$f(x)\in C[a,b],f(x)\geqslant0,f(x)\not\equiv0$，那么$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x>0$
>
>4)(**绝对值可积性**)设$f(x)\in R[a,b]$，则$|f(x)|\in R[a,b]$，且$|\displaystyle\int_{a}^b f(x)\mathrm{d}x|\leqslant\displaystyle\int_{a}^b |f(x)|\mathrm{d}x$
>>[!note] 
>>该性质的逆命题是不成立的
>
>5)(**区间可加性**)设$f(x)\in R[a,b]$，则对于任意点$c\in[a,b]$，$f(x)$在$[a,b]$和$[c,d]$上都可积；反过来，$f\in R[a,c]\cup[c,b]$，则$f(x)$在$[a,b]$上可积，此时成立：$\displaystyle\int_{a}^b f(x)\mathrm{d}x=\displaystyle\int_{a}^c f(x)\mathrm{d}x+\displaystyle\int_{c}^b f(x)\mathrm{d}x$
>
>6)(**积分第一中值定理**)设$f(x),g(x)\in R[a,b]$，且$g(x)$在$[a,b]$上不变号，则存在$\eta\in[m,M]$，使得$\displaystyle\int_{a}^b f(x)g(x)\mathrm{d}x=\eta \displaystyle\int_{a}^b g(x)\mathrm{d}x$
>这里的$m,M$分别表示$f(x)$在$[a,b]$上的下确界和上确界
>特别的，若$f(x)\in C[a,b]$，则$\exists \xi\in[a,b],s.t.\displaystyle\int_{a}^b f(x)g(x)\mathrm{d}x=f(\xi)\displaystyle\int_{a}^b g(x)\mathrm{d}x$
>另一种特殊情况是，$f(x)\in C[a,b],g(x)\equiv1$，那么$\displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x=f(\xi)\displaystyle\int_{a}^{b} g(x) \, dx$
>
>**Corollary** 若$f(x)\in C[a,b]$，则$\exists \xi\in(a,b),s.t.\displaystyle\int_{a}^b f(x)g(x)\mathrm{d}x=f(\xi)\displaystyle\int_{a}^b g(x)\mathrm{d}x$
>>[!note] 
>>$f(x)\in C[a,b]$改为$f(x)\in R[a,b]$结论不成立
>>$f(x)\in R[a,b]$且$\displaystyle\int f(x)\mathrm{d}x$存在结论成立
>
>7)(**积分第二中值定理**)设$f(x)\in R[a,b]$，
>$1^\circ$ 如果$g(x)\downarrow\in[a,b],g(x)\geqslant0(x\in[a,b]):\exists \xi\in[a,b],s.t.\displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x=g(a)\displaystyle\int_{a}^{\xi} f(x) \, \mathrm{d}x$
>$2^\circ$ 如果$g(x)\uparrow\in[a,b],g(x)\geqslant0(x\in[a,b]):\exists \eta\in[a,b],s.t.\displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x=g(b)\displaystyle\int_{\eta}^{b} f(x) \, \mathrm{d}x$
>(**一般形式的积分第二中值定理**) 设$f(x)\in R[a,b]$，$g(x)$为单调函数，则$\exists \xi\in[a,b],s.t.\displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x=g(a)\displaystyle\int_{a}^{\xi} f(x) \, \mathrm{d}x+g(b)\displaystyle\int_{\xi}^{b} f(x) \, \mathrm{d}x$




<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
**线性性质**
对于$[a,b]$的任意一个划分，$a=x_{0}<x_{1}<\dots<x_{n}=b$和任意点$\xi_{i}\in[x_{i-1},x_{i}]$，成立：
$\sum\limits_{i=1}^{n}[k_{1}f(\xi_{i})+k_{2}g(\xi_{i})]\Delta x_{i}=k_{1}\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}+k_{2}\sum\limits_{i=1}^{n}g(\xi_{i})\Delta x_{i}$
两边令$\lambda=\max\limits_{1\leqslant i\leqslant n}\{ \Delta x_{i} \}\to0$，由于$f(x),g(x)\in R[a,b]$，因此有：
$\begin{align}&\lim_\limits{ \lambda \to  0 }\sum\limits_{i=1}^{n}[k_{1}f(\xi_{i})+k_{2}g(\xi_{i})]\Delta x_{i}\\&=k_{1}\lim_\limits{ \lambda \to  0 }\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}+k_{2}\lim_\limits{ \lambda \to  0 }\sum\limits_{i=1}^{n}g(\xi_{i})\Delta x_{i}\\&=k_{1}\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x+\displaystyle\int_{a}^{b} g(x) \, \mathrm{d}x\end{align}$

由定义，函数$k_{1}f(x)+k_{2}g(x)\in R[a,b]$，且有：
$\displaystyle\int_{a}^b[k_{1}f(x)+k_{2}g(x)]\mathrm{d}x=k_{1}\displaystyle\int_{a}^bf(x)\mathrm{d}x+k_{2}\displaystyle\int_{a}^bg(x)\mathrm{d}x$


**乘积可积性**
由于$f(x),g(x)\in R[a,b]$，因此$f(x),g(x)\in B[a,b]$，因此$\exists M,s.t.|f(x)|\leqslant M,|g(x)|\leqslant M,\quad x\in[a,b]$
对于$[a,b]$的任意划分$a=x_{0}<x_{1}<\dots<x_{n}=b$
设$\hat{x},\tilde{x}$是$[x_{i-1},x_{i}]$中的任意两点，则有：
$\begin{align}&\qquad|f(\hat{x})g(\hat{x})-f(\tilde{x})g(\tilde{x})|\\&\leqslant|f(\hat{x})-f(\tilde{x})|\cdot|g(\hat{x})|+|f(\tilde{x})|\cdot|g(\hat{x})-g(\tilde{x})|\\&\leqslant M[|f(\hat{x})-f(\tilde{x})|+|g(\hat{x})-g(\tilde{x})|]\end{align}$
记$f(x)\cdot g(x)$在$[x_{i-1},x_{i}]$上的振幅为$\omega_{i}$，$f(x),g(x)$在上面的振幅分别为$\omega_{i}',\omega_{i}''$
则上式就意味着：$\omega_{i}\leqslant M(\omega_{i}'+\omega_{i}'')$
因此$0\leqslant \sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}\leqslant M(\sum\limits_{i=1}^{n}\omega_{i}'\Delta x_{i}+\sum\limits_{i=1}^{n}\omega_{i}''\Delta x_{i})$
由于$f(x),g(x)\in R[a,b]$，因而当$\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})\to0$时，上述不等式的右侧趋于0，由极限的夹逼性，$\lim_\limits{ \lambda \to  0 }\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}=0$



**保序性**
对于$\geqslant$
只需证明对于$[a,b]$上的非负函数$f(x)$，成立：$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x\geqslant0$
易得，对于$[a,b]$的任意一个划分，$a=x_{0}<x_{1}<\dots<x_{n}=b$和任意分点$\xi_{i}\in[x_{i-1},x_{i}]$，有$\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}\geqslant0$
令$\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})\to0$，就有：
$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=\lim_\limits{ \lambda \to  0 }\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}\geqslant0$

对于$>$
用闭区间套原理
由保序性可知$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x\geqslant0$，只需证$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x\neq0$
假设$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=0$，那么有$\lim_\limits{ \lambda \to  0 }\sum\limits_{i=1}^{n}M_{i}\Delta x_{i}=0$
即$\forall \varepsilon>0,\exists\delta>0,\forall P(\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})<\delta):\sum\limits_{i=1}^{n}M_{i}\Delta x_{i}<(b-a)\varepsilon$
于是至少存在一个小区间$[x_{i-1},x_{i}]$，在上面有：$0\leqslant M_{i}<\varepsilon$
事实上，由可加性，$\forall[c,d]\subset[x_{i-1},x_{i}]$，有$\displaystyle\int_{c}^{d} f(x) \, \mathrm{d}x=0$
取$\varepsilon_{1}=1$，令$\delta\in(0,1)$，设$[x_{i-1},x_{i}]$为$[a_{1},b_{1}]$，则在$[a_{1},b_{1}]$上有$0\leqslant M_{i}<1$，即$0\leqslant f(x)<1$，且$b_{1}-a_{1}<\delta<1$
取$\varepsilon_{2}=\frac{1}{2}$，令$\delta\in\left( 0, \frac{1}{2} \right)$，存在$[a_{2},b_{2}]\subset[a_{1},b_{1}]$，在$[a_{2},b_{2}]$上有$0\leqslant M_{i}< \frac{1}{2}$，即$0\leqslant f(x)< \frac{1}{2}$，且$b_{1}-a_{1}<\delta< \frac{1}{2}$
$\dots$
以此类推，有$[a_{n},b_{n}]\subset\dots[a_{1},b_{1}]$，$b_{n}-a_{n}< \frac{1}{n}$，在$[a_{n},b_{n}]$上，有$0<f(x)< \frac{1}{n}$
由闭区间套原理，存在唯一$\xi\in[a_{n},b_{n}]$，且$0<f(\xi)< \frac{1}{n}$
由$n\to \infty$，有$f(\xi)=0$
矛盾

Corollary
设$x_{0}\in[a,b]:f(x_{0})>0$
由连续函数的性质，$\exists[\alpha,\beta](x_{0}\in[\alpha,\beta]\subset[a,b]),\forall x\in[\alpha,\beta]:f(x)\geqslant \frac{1}{2}f(x_{0})$
由积分的可加性，
$\begin{align}\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x&=\displaystyle\int_{a}^{\alpha} f(x) \, \mathrm{d}x+\displaystyle\int_{\alpha}^{\beta} f(x) \, \mathrm{d}x+\displaystyle\int_{\beta}^{b} f(x) \, \mathrm{d}x\\&\geqslant\displaystyle\int_{\alpha}^{\beta} f(x) \, \mathrm{d}x\\&\geqslant\displaystyle\int_{\alpha}^{\beta} \frac{f(x_{0})}{2} \, \mathrm{d}x\\&= \frac{f(x_{0})}{2}(\beta-\alpha)>0\end{align}$


**绝对值可积性**
对于任意两点$\hat{x},\tilde{x}$，都有：$||f(\hat{x})|-|f(\tilde{x})||\leqslant |f(\hat{x})-f(\tilde{x})|$
仿照乘积可积性的证明可得$|f(x)|\in R[a,b]$
又由于$-|f(x)|\leqslant f(x)\leqslant|f(x)|$
由保序性：$|\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x|\leqslant \displaystyle\int_{a}^{b} |f(x)| \, \mathrm{d}x$

**区间可加性**
设$f(x)\in R[a,b]$，$c$是$[a,b]$中任意给定的一点
有可积充要条件：$\forall \varepsilon>0,\exists P:a=x_{0}<\dots<x_{n}=b,s.t.\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}<\varepsilon$
总是可以假定$c$是其中的一个分点$x_{k}$，否则在原有划分中插入分点$c$形成新的划分，由大和不增，小和不减，上述不等式仍然成立
将$a=x_{0}<\dots<x_{k}=c$和$c=x_{k}<x_{k+1}<\dots<x_{n}=b$看成是对$[a,c],[c,b]$的划分，显然有：$\sum\limits_{i=1}^{k}\omega_{i}\Delta x_{i}<\varepsilon,\sum\limits_{i=k+1}^{n}\omega_{i}\Delta x_{i}<\varepsilon,$
由可积充要条件，$f(x)\in R[a,c],R[c,b]$
反过来的证明是类似的
在$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x,\displaystyle\int_{a}^{c} f(x) \, \mathrm{d}x,\displaystyle\int_{c}^{b} f(x) \, \mathrm{d}x$都存在的条件下，由定积分的定义，容易得到，$\displaystyle\int_{a}^b f(x)\mathrm{d}x=\displaystyle\int_{a}^c f(x)\mathrm{d}x+\displaystyle\int_{c}^b f(x)\mathrm{d}x$


**积分第一中值定理**
由于$g(x)$在$[a,b]$上不变号，不妨设$g(x)\geqslant0,\,x\in[a,b]$，于是有：
$mg(x)\leqslant f(x)g(x)\leqslant Mg(x)$
由保序性，$m\displaystyle\int_{a}^{b} g(x) \, \mathrm{d}x\leqslant \displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x\leqslant M\displaystyle\int_{a}^{b} g(x) \, \mathrm{d}x$
由于$\displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x$和$\displaystyle\int_{a}^{b} g(x) \, \mathrm{d}x$都是常数，因而必然$\exists \eta\in[m,M],s.t.\displaystyle\int_{a}^b f(x)g(x)\mathrm{d}x=\eta \displaystyle\int_{a}^b g(x)\mathrm{d}x$
若$f(x)$在$[a,b]$上连续，由闭区间上连续函数的介值定理，$\exists \xi\in[a,b],s.t.f(\xi)=\eta$
于是，$\displaystyle\int_{a}^b f(x)g(x)\mathrm{d}x=f(\xi)\displaystyle\int_{a}^b g(x)\mathrm{d}x$

**Corollary** 
推论的不同之处在于，$\xi$可在$(a,b)$开区间取到
以下情况是平凡的：
$1^\circ$ $\displaystyle\int_{a}^{b} g(x) \, \mathrm{d}x=0$，由积分第一中值定理有$\displaystyle\int_{a}^b f(x)g(x)\mathrm{d}x=f(\xi)\displaystyle\int_{a}^b g(x)\mathrm{d}x=0$，此时$\xi$任取
$2^\circ$ $f(x)$在$[a,b]$上的最大值等于最小值，即$M=m$，即$f(x)$在上面为常值函数，$\xi$任取
$3^\circ$ 虽然$m<M$，但是$\eta\in(m,M)$，则从连续函数的介值性，$\exists \xi\in(a,b),s.t.f(\xi)=\eta$
要讨论的是这三种情况以外的情况
不妨设$g(x)\geqslant0$，于是由保序性，$\displaystyle\int_{a}^{b} g(x) \, \mathrm{d}x\geqslant0$，排除情况$1^\circ$，有$\displaystyle\int_{a}^{b} g(x) \, \mathrm{d}x>0$
排除情况$2^\circ$ ，令$m<M$
排除情况$3^\circ$，不妨令$\eta=m$
由eg.1得$\exists[c,d]\subset[a,b],\mu>0,s.t.g(x)\geqslant\mu>0(x\in [c,d])$
又由于$f(x)-m,g(x)$在$[a,b]$上都非负，因此由积分第一中值定理，
$0=\displaystyle\int_{a}^{b} [f(x)-m]g(x) \, \mathrm{d}x\geqslant\displaystyle\int_{c}^{d} [f(x)-m]g(x) \, \mathrm{d}x\geqslant\mu \displaystyle\int_{c}^{d} [f(x)-m] \, \mathrm{d}x\geqslant0$
于是$\displaystyle\int_{c}^{d} [f(x)-m] \, \mathrm{d}x=0$，又由于$f(x)\in C[c,d]$，于是在$[c,d]$上有$f(x)\equiv m$
因此在$(c,d)\subset(a,b)$上任取一点作为$\xi$即可

**积分第二中值定理**
作分划$a=x_{0}<x_{1}<\dots<x_{n}=b$，于是：
$I=\displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x=\sum\limits_{i=0}^{n-1}\displaystyle\int_{x_{i}}^{x_{i+1}} f(x)g(x) \, \mathrm{d}x=\sum\limits_{i=0}^{n-1}\displaystyle\int_{x_{i}}^{x_{i+1}} f(x)(g(x)-g(x_{i})) \, \mathrm{d}x+\sum\limits_{i=0}^{n-1}\displaystyle\int_{x_{i}}^{x_{i+1}} f(x)g(x_{i}) \, \mathrm{d}x \xlongequal{let}I_{1}+I_{2}$
由于$f(x)\in R[a,b]$，故$f(x)\in B[a,b]$，即$\exists L>0,|f(x)|\leqslant L(\forall x\in[a,b])$
由于$g(x)\downarrow\in[a,b]$，故$0\leqslant\sum\omega_{i}^g\leqslant g(a)-g(b)\xlongequal{let}R$
$\lambda \xlongequal{let}\max\limits_{i}\Delta x_{i},\Delta x_{i}=x_{i+1}-x_{i}$，得
$|I_{1}|\leqslant\sum\limits_{i=0}^{n-1}\displaystyle\int_{x_{i}}^{x_{i+1}} |f(x)||g(x)-g(x_{i})| \, \mathrm{d}x\leqslant L\sum\limits_{i=0}^{n-1}\omega_{i}^g\Delta x_{i}\leqslant LR\lambda\to0(\lambda\to0)$
令$F(x)=\displaystyle\int_{a}^{x} f(x) \, \mathrm{d}x$，则$\displaystyle\int_{x_{i}}^{x_{i+1}} f(x) \, \mathrm{d}x=F(x_{i+1})-F(x_{i}),F(x_{0})=F(a)=0$
于是$I_{2}=\sum\limits_{i=0}^{n-1}(F(x_{i+1})-F(x_{i}))G(x_{i})\xlongequal{Abel\;Transform}\sum\limits_{i=1}^{n-1}F(x_{i})(g(x_{i+1})-g(x_{i}))+F(x_{n})g(x_{n-1})$
若$f(a)=0$，即$f(x)\equiv0$，已证；
若$f(a)\neq0$，
由于$f(x)\in R[a,b]$，所以$F(x)=\displaystyle\int_{a}^{x} f(x) \, \mathrm{d}x\in C[a,b]$，
由闭区间上连续函数的最值定理，$F(x)$在$[a,b]$上有最大值($M$)和最小值($m$)：$m\leqslant F(x_{i})\leqslant M(i=0,1,\dots n)$
由于$g(x)\downarrow\in[a,b]$，故$g(x_{i-1})-g(x_{i})\geqslant0$，故$m(g(x_{i-1})-g(x_{i}))\leqslant F(x_{i})(g(x_{i-1})-g(x_{i}))<M(g(x_{i-1})-g(x_{i}))\;(i=0,1,\dots n)$
$mg(a)=m\left[ \sum\limits_{i=1}^{n-1}(g(x_{i-1})-g(x_{i}))+g(x_{n-1}) \right]\leqslant I_{2}\leqslant M\left[ \sum\limits_{i=1}^{n-1}(g(x_{i-1})-g(x_{i}))+g(x_{n-1}) \right]=mg(a)$
即$mg(a)\leqslant I_{2}\leqslant Mg(a)$，亦即$m\leqslant \frac{I_{2}}{g(a)}\leqslant M$
由于$F(x)\in C[a,b]$，由闭区间上连续函数的介值定理：$\exists \xi\in[a,b],s.t.F(\xi)=\displaystyle\int_{a}^{\xi} f(x) \, \mathrm{d}x= \frac{I_{2}}{g(a)}$
两边同时乘以$g(a)$即可

**一般形式的积分第二中值定理**
若$g(x)\downarrow$，令$\tilde{g}(x)=g(x)-g(b)$，再利用积分第二中值定理即可；
若$g(x)\uparrow$，令$\tilde{g}(x)=g(x)-g(a)$，再利用积分第二中值定理即可
证毕

---

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:复合函数的可积性问题</span>
>==外层连续，内层可积== 设$f(x)\in R[a,b],A\leqslant f(x)\leqslant B,g(u)\in C[A,B]$，则复合函数$g(f(x))\in R[a,b]$
>==外层可积，内层连续== 此时不一定可积
>==内外均可积== 此时不一定可积

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
由于$g(u)\in C[A,B]$，设$g(u)\leqslant M$，且$g(u)$在$[A,B]$上一致连续，于是
$\forall \varepsilon>0,\exists\delta>0,\forall u',u''\in[A,B](|u'-u''|<\delta):|g(u')-g(u'')|< \frac{\varepsilon}{2(b-a)}$
由于$f(x)\in R[a,b]$，对上述的$\varepsilon,\delta,\exists P,s.t.\sum\limits_{\omega_{i}(f)\geqslant\delta}\Delta x_{i}< \frac{\varepsilon}{4M}$
于是：
$\begin{align}\sum\limits_{i=1}^{n}\omega_{i}(g\circ f)\Delta x_{i}&=\sum\limits_{\omega_{i}(f)<\delta}\omega_{i}(g\circ f)\Delta x_{i}+\sum\limits_{\omega_{i}(f)\geqslant\delta}\omega_{i}(g\circ f)\Delta x_{i}\\&< \frac{\varepsilon}{2(b-a)}\sum\limits_{\omega_{i}(f)<\delta}\Delta x_{i}+2M\sum\limits_{\omega_{i}(f)\geqslant\delta}\Delta x_{i}\\&< \frac{\varepsilon}{2(b-a)}(b-a)+2M \frac{\varepsilon}{4M}=\varepsilon\end{align}$
即$g(f(x))\in R[a,b]$
证毕
<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span>
由于$f(x)\in R[a,b]$，因此$D_{f}$是零测集
由于$g(u)\in C[A,B]$，因此$D_{g\circ f}\subset_{f}$
因此$D_{g\circ f}$也是零测集，因此可积

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Counter-Example 1：</span>

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Counter-Example 2：</span>


---


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
设$f(x)\in R[a,b],I=\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x>0,\exists[c,d]\subset[a,b],\mu>0:f(x)\geqslant\mu(x\in[c,d])$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7
px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
由极限的保序性，$\exists P:x_{0}<x_{1}<\dots<x_{n},\forall \{ \xi_{i} \}:\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}> \frac{I}{2}>0$
对于此式取下确界，有：$\sum\limits_{i=1}^{n}m_{i}\Delta x_{i}\geqslant \frac{I}{2}>0$
显然在和式中至少有一项大于0，不妨设这是第k项，则可以取$\mu=m_{k},[c,d]=[x_{k-1},x_{k}]$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span>
假设结论不成立，则$\forall[c,d]\subset[a,b],\mu>0,\exists \xi\in[c,d]:f(\xi)<\mu$

在$f(x)$的Riemann和式中对于任何分划都取满足这个要求的介点集，这样就得到：$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x\leqslant\mu(b-a)$
由于$\mu$任意，因此只能得到$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x\leqslant0$
矛盾
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
证明Dirichlet积分:$\displaystyle\int_{0}^{\pi} \frac{\sin\left( n+ \frac{1}{2} \right)x}{\sin \frac{x}{2}} \, \mathrm{d}x=\pi,\quad n=0,1,2,\dots$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
证明Fejèr积分:$\displaystyle\int_{0}^{\pi} \left( \frac{\sin \frac{nx}{2}}{\sin \frac{x}{2}} \right)^2 \, \mathrm{d}x=n\pi,\quad n=0,1,2,\dots$



---



### 2.3 微积分基本定理
#### 2.3.1 Newton-Leibniz公式
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：变限积分」</span>
> 设$f(x)\in R[a,b]$，则记$F(x)=\displaystyle\int_{a}^{x} f(t) \, \mathrm{d}t,F(x)=\displaystyle\int_{x}^{b} f(t) \, \mathrm{d}t$分别称为变上限积分和变下限积分
> 
> >[!note] 
> >求导使函数光滑性变差(原函数可导，导函数可以有第二类间断点)，反之光滑性变好
> 
> ==🖇️Properties：==
> 1)$F(x)\in C[a,b]$(变上限积分为满足Lipschitz条件的函数，在闭区间上一致连续)
> 2)(**微积分基本定理**)设$x_{0}\in[a,b]$是$f(x)$的连续点，则$F'(x_{0})=f(x_{0})$
> 2.1)(**原函数存在定理**)若$f(x)\in C[a,b]$，则$F(x)\in D[a,b],F'(x)=f(x)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
1)
由题意得$F(x)$在$[a,b]$上有定义，由定积分的区间可加性：
$F(x+\Delta x)-F(x)=\displaystyle\int_{a}^{x+\Delta x} f(t) \, \mathrm{d}t-\displaystyle\int_{a}^{x} f(t) \, \mathrm{d}t=\displaystyle\int_{x}^{x+\Delta x} f(t) \, \mathrm{d}t$
记$M,m$分别为$f(x)$在$[a,b]$上的上下确界，由积分第一中值定理有：
$F(x+\Delta x)-F(x)=\begin{cases}&\eta\Delta x\quad(\eta\in[m,M])&f(x)\in R[a,b]\\&f(\xi)\Delta x\quad(\xi在x和x+\Delta x之间)&f(x)\in C[a,b]\end{cases}$
无论在哪一种情况下，当$\Delta x\to0$时都有$F(x+\Delta x)-F(x)\to0$，即$F(x)$在$[a,b]$上连续

2)
由1)得，$F(x_{0}+h)-F(x_{0})=\displaystyle\int_{x_{0}}^{x_{0}+h} f(t) \, \mathrm{d}t$
于是
$\begin{align} \frac{F(x_{0}+h)-F(x_{0})}{h}-f(x_{0})&= \frac{1}{h}\displaystyle\int_{x_{0}}^{x_{0}+h} f(t) \, \mathrm{d}t+\frac{1}{h}\displaystyle\int_{x_{0}}^{x_{0}+h} f(x_{0}) \, \mathrm{d}t\\&=\frac{1}{h}\displaystyle\int_{x_{0}}^{x_{0}+h} (f(t)-f(x_{0})) \, \mathrm{d}t\end{align}$
由于$f(x)$在$x_{0}$处连续，即$\forall \varepsilon>0,\exists\delta>0,\forall t\in(a,b)(|t-x_{0}|<\delta):|f(t)-f(x_{0})|<\varepsilon$
取$0<|h|<\delta$，就有：
$\begin{align}|\frac{F(x_{0}+h)-F(x_{0})}{h}-f(x_{0})|&\leqslant\frac{1}{|h|}\displaystyle\int_{x_{0}}^{x_{0}+h} |f(t)-f(x_{0})| \, \mathrm{d}t\\&< \frac{1}{|h|}\varepsilon|h|\\&=\varepsilon\end{align}$
这就是$F'(x_{0})=\lim_\limits{ h \to 0} \frac{F(x_{0}+h)-F(x_{0})}{h}=f(x_{0})$
证毕


>[!note] 
>Riemann函数的变限积分为0，不是它的原函数。事实上，由于它的间断点为可去间断点，因而它没有原函数

>[!note] 
>如果一个可积函数有原函数，则必为它的积分上限函数(加一个常数)

>[!example] 
>由原函数存在定理，若$f(x)$在$[a,b]$上可积且连续，则在上面一定有原函数，但是就算不连续，也不一定没有原函数。比如
>令$f(x)=\begin{cases}&\sin \frac{1}{x},&x\neq0\\&0,&x=0\end{cases},g(x)=\begin{cases}&x^2\cos \frac{1}{x},&x\neq0\\&0,&x=0\end{cases},h(x)=\begin{cases}&2x\cos \frac{1}{x},&x\neq0\\&0,&x=0\end{cases}$
>函数$f(x)$有断点$x=0$，但是它有原函数$F(x)=g(x)-\displaystyle\int_{0}^{x} h(t) \, \mathrm{d}t$

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Newton-Leibniz公式</span>
>设$f(x)\in C[a,b]$，$F(x)$是$f(x)$在$[a,b]$上的一个原函数，则$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=F(b)-F(a)$
>
>**Corollary：广义Newton-Leibniz公式** 
>设$f(x)\in R[a,b],F(x)\in C[a,b]$，且除了有限个点外满足$F'(x)=f(x)$，则$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=F(b)-F(a)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
设$F(x)$是$f(x)$在$[a,b]$上的一个原函数，则根据变限积分可将其记为$\displaystyle\int_{a}^{x} f(t) \, \mathrm{d}t=F(x)+C$，即相差一个常数
令$x=a$解得$C=-F(a)$
再令$x=b$，得$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=F(b)-F(a)$

**Corollary**
对$[a,b]$作划分$P:a=x_{0}<x_{1}<\dots<x_{n}=b$，那些不满足$F'(x)=f(x)$的点(有限的)应该被包含在其中
对于任意一个小区间$[x_{i-1},x_{i}]$，$F(x)$在上面满足闭区间连续，开区间可导，由Lagrange中值定理，
$\exists \xi_{i}\in(x_{i-1},x_{i}),s.t.F(x_{i})-F(x_{i-1})=F'(\xi_{i})(x_{i}-x_{i-1})=f(\xi_{i})\Delta x_{i}$
于是$F(b)-F(a)=\sum\limits_{i=1}^{n}[F(x_{i})-F(x_{i-1})]=\sum\limits_{i=1}^{n}f(\xi_{i})\Delta x_{i}$
令$\lambda=\max\limits_{1\leqslant i\leqslant n}(\Delta x_{i})\to0$，就有：$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=F(b)-F(a)$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
设$f(x)\in R[A,B],a,b\in(A,B)$是$f(x)$的两个连续点，试证：$\lim_\limits{ h \to  0 }\displaystyle\int_{a}^{b} \frac{f(x+h)-f(x)}{h} \, \mathrm{d}x=f(b)-f(a)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
$$\begin{align}
\lim_\limits{ h \to 0} \displaystyle\int_{a}^{b} \frac{f(x+h)-f(x)}{h} \, \mathrm{d}x&= \lim_\limits{ h \to 0} \frac{1}{h}\left( \displaystyle\int_{a}^{b} f(x+h) \, \mathrm{d}x-\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x   \right)   \\
&=\lim_\limits{ h \to 0} \frac{1}{h}\left( \displaystyle\int_{a+h}^{b+h} f(x) \, \mathrm{d}x-\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x   \right) \\
&=\lim_\limits{ h \to 0} \frac{1}{h}\left( \displaystyle\int_{b}^{b+h} f(x) \, \mathrm{d}x-\displaystyle\int_{a}^{a+h} f(x) \, \mathrm{d}x   \right) \\
&=f(b)-f(a)
\end{align}$$

这里用到了变限积分的性质2
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
==导函数Riemann可积的充要条件==
设$F'(x)$存在，则$F'(x)\in R[a,b]\Longleftrightarrow \exists g(x)\in R[a,b],s.t.F(x)-F(a)=\displaystyle\int_{a}^{x} g(t) \, \mathrm{d}t$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
$\Longrightarrow$
取$g(x)=F'(x)$即可

$\Longleftarrow$
由于$g(x)\in R[a,b]$，故$g(x)$在$[a,b]$上有界，设$M,m$分别为$g(x)$在$[a,b]$上的上下确界
作函数：$G(x)=F(x)-F(a)-m(x-a)=\displaystyle\int_{a}^{x} [g(t)-m] \, \mathrm{d}t$
有$g(t)-m\geqslant0$，因此随着$x$的增大，$G(x)$是不断增大的，根据导数与单调性的关系有$G'(x)=F'(x)-m\geqslant0$
即$F'(x)\geqslant m$
同理可证$F'(x)\leqslant M$
这就是说，在同一区间上$F'(x)$的振幅不超过$g(x)$的振幅，由$g(x)\in R[a,b]$有$F'(x)\in R[a,b]$
证毕

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span>
这里只证充分性
设$P:a=x_{0}<x_{1}<\dots<x_{n}=b$，记$m_{i}^g=\inf\limits_{x_{i-1}\leqslant x\leqslant x_{i}}g(x),M_{i}^g=\sup\limits_{x_{i-1}\leqslant x\leqslant x_{i}}g(x)$，则$\omega_{i}^g=M_{i}^g-m_{i}^g$
设$\forall x\in[x_{i-1},x_{i}],x+\Delta x\in[x_{i-1},x_{i}]$，则由于$F(x)-F(a)=\displaystyle\int_{a}^{x} g(t) \, \mathrm{d}t$，有：
$\frac{\Delta F}{\Delta x}=\frac{F(x+\Delta x)-F(x)}{\Delta x}=\frac{1}{\Delta x} \displaystyle\int_{x}^{x+\Delta x} g(x) \, \mathrm{d}x$
注意到$m_{i}^g\leqslant g(x)\leqslant M_{i}^g$，所以$m_{i}^g\leqslant \frac{\Delta F}{\Delta x}\leqslant M_{i}^g$
令$\Delta x\to0$，得$m_{i}^g\leqslant F'(x)\leqslant M_{i}^g$
因此，$F'(x)$在$[x_{i-1},x_{i}]$上的振幅$\omega_{i}^{F'}=\sup\limits_{x_{i-1}\leqslant x\leqslant x_{i}}F'(x)-\inf\limits_{x_{i-1}\leqslant x\leqslant x_{i}}F'(x)\leqslant M_{i}^g-m_{i}^g=\omega_{i}^g$
故$0\leqslant \sum\limits_{i=1}^{n}\omega_{i}^{F'}\Delta x_{i}\leqslant\sum\limits_{i=1}^{n}\omega_{i}^g\Delta x_{i}$
由于$g(x)\in R[a,b]$，所以$F'(x)\in R[a,b]$
证毕

#### 2.3.2 Riemann引理
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Riemann引理</span>
>设$f(x)\in R[a,b]$，$g(x)$以T为周期且在$[0,T]$上可积，则有：$\lim_\limits{ p \to +\infty }\displaystyle\int_{a}^{b} f(x)g(px) \, \mathrm{d}x= \frac{1}{T}\displaystyle\int_{0}^{T} g(x) \, \mathrm{d}x \displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$




#### 2.3.3 一致收敛
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：函数列的一致收敛」</span>
> $f_{n}(x)$为一实函数列，如果$\forall \varepsilon>0,\exists N\in \mathbb{N},\forall n>N:|f_{n}(x)-f(x)|<\varepsilon$，则称$f_{n}(x)$一致收敛于$f(x)$，记作$f_{n}(x)\rightrightarrows f(x)(n\to \infty)$
>
>
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:一致收敛控制连续</span>
>设实函数列$f_{n}(x)\rightrightarrows f(x)(n\to \infty),x\in X$，如果$f_{n}(x)$在$x_{0}\in X$处连续$(n=1,2,3\dots)$，则$f(x)$在$x_{0}$处也连续
>特别的，当$f_{n}(x)\in C_{X}$时，$f(x)\in C_{X}$
>
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:一致收敛控制可积</span>
>设$f_{n}(x)\in R[a,b],f_{n}(x)\rightrightarrows f(x)(n\to \infty),x\in[a,b]$，则$f(x)\in R[a,b]$，且$\lim_\limits{ n \to \infty }\displaystyle\int_{a}^{b} f_{n}(x) \, \mathrm{d}x=\displaystyle\int_{a}^{b} \lim_\limits{ n \to \infty }f_{n}(x) \, \mathrm{d}x=\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
**控制连续**
由于$f_{n}(x)\rightrightarrows f(x)(n\to \infty),x\in X$，因此：$\forall \varepsilon>0,\exists N\in \mathbb{N},\forall n>N:|f_{n}(x)-f(x)|< \frac{\varepsilon}{3}$
对于$f_{N+1}(x)$，由于它在$x_{0}$处连续，对于上述的$\varepsilon$，$\exists\delta>0,\forall x\in X(|x-x_{0}|<\delta):|f_{N+1}(x)-f_{N+1}(x_{0})|< \frac{\varepsilon}{3}$
因此：
$\begin{align}|f(x)-f(x_{0})|&\leqslant|f(x)-f_{N+1}(x)|+|f_{N+1}(x)-f_{N+1}(x_{0})|+|f_{N+1}(x_{0})-f(x_{0})|\\&< \frac{\varepsilon}{3}+\frac{\varepsilon}{3}+\frac{\varepsilon}{3}=\varepsilon\end{align}$
即$f(x)$在$x_{0}$处连续

**控制可积**
由于$f_{n}(x)\in R[a,b]$，由Lebesgue定理，$D_{f_{n}}$为零测集
由一致收敛控制连续，可知$D_{f}\subset \bigcup\limits_{n=1}^\infty D_{f_{n}}$，由零测集的性质，可知$D_{f}$也是零测集
由于$f_{n}(x)\rightrightarrows f(x)(n\to \infty),x\in [a,b]$，因此：$\forall \varepsilon>0,\exists N\in \mathbb{N},\forall n>N:|f_{n}(x)-f(x)|< \frac{\varepsilon}{b-a}$
于是$f_{N+1}(x)- \frac{\varepsilon}{b-a}<f(x)<f_{N+1}(x)+ \frac{\varepsilon}{b-a}$，即$f(x)$在$[a,b]$上有界
于是由Lebesgue定理，$f(x)\in R[a,b]$
进而有：
$|\displaystyle\int_{a}^{b} f_{n}(x) \, \mathrm{d}x-\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x|$
$\begin{align}|\displaystyle\int_{a}^{b} f_{n}(x) \, \mathrm{d}x-\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x|&=|\displaystyle\int_{a}^{b} [f_{n}(x)-f(x)] \, \mathrm{d}x|\\&\leqslant\displaystyle\int_{a}^{b} |f_{n}(x)-f(x)| \, \mathrm{d}x\\&\leqslant \frac{\varepsilon}{b-a}(b-a)=\varepsilon\end{align}$
即$\lim_\limits{ n \to \infty }\displaystyle\int_{a}^{b} f_{n}(x) \, \mathrm{d}x=\displaystyle\int_{a}^{b} \lim_\limits{ n \to \infty }f_{n}(x) \, \mathrm{d}x=\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$
证毕

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
证明==Riemann积分的连续性==：设$f(x),f(x+h)\in R[a,b]$，则有：$\lim_\limits{ h \to  0 }\displaystyle\int_{a}^{b} |f(x+h)-f(x)| \, \mathrm{d}x=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
由于$f(x+h)\in R[a,b]$，可知$\exists\delta>0,s.t.f(x)\in R[a-\delta,b+\delta]$
设$|f(x)|\leqslant M(x\in[a-\delta,b+\delta])$，由于$f(x)\in R[a,b]$，$\forall \varepsilon>0,\exists P:a=x_{0}<x_{1}<\dots<x_{n}=b$($P$是对区间$[a,b]$的n等分)，使得当$\frac{b-a}{n}< \frac{\varepsilon}{8M}$时，成立：$\sum\limits_{i=1}^{n}\omega_{i}\Delta x_{i}< \frac{\varepsilon}{6}\left( \Delta x_{i}= \frac{b-a}{n},i=1,2,\dots n \right)$
另外，当$\frac{b-a}{n}<\delta$时，记$\omega_{0},\omega_{n+1}$分别是$f(x)$在区间$\left[ a- \frac{b-a}{n},a \right],\left[ b, b+\frac{b-a}{n} \right]$上的振幅，则$\omega_{0}\leqslant2M,\omega_{n+1}\leqslant2M$
由于$\displaystyle\int_{a}^{b} |f(x+h)-f(x)| \, \mathrm{d}x=\sum\limits_{i=1}^{n}\displaystyle\int_{x_{i-1}}^{x_{i}} |f(x+h)-f(x)| \, \mathrm{d}x$
且当$|h|< \frac{b-a}{n}<\min\left\{  \frac{\varepsilon}{8M},\delta  \right\}$时，由$x\in [x_{i-1},x_{i}]$，可知$x+h\in[x_{i-2},x_{i-1}]\cup[x_{i-1},x_{i}]\cup[x_{i},x_{i+1}]$
其中$x_{-1}=a- \frac{b-a}{n},x_{n+1}=b+ \frac{b-a}{n}$，从而有：$|f(x+h)-f(x)|\leqslant\omega_{i-1}+\omega_{i}+\omega_{i+1}$，于是：
$\begin{align}\displaystyle\int_{a}^{b} f(x+h)-f(x) \, \mathrm{d}x&\leqslant\sum\limits_{i=1}^{n}(\omega_{i-1}+\omega_{i}+\omega_{i+1})\Delta x_{i}\\&< \frac{\varepsilon}{2}+(\omega_{0}+\omega_{n+1}) \frac{b-a}{n}\\&< \frac{\varepsilon}{2}+ \frac{\varepsilon}{2}=\varepsilon\end{align}$
所以$\lim_\limits{ h \to  0 }\displaystyle\int_{a}^{b} |f(x+h)-f(x)| \, \mathrm{d}x=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span>

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
设$p:[a,b]\to \mathbb{R}$，如果有分割$a=x_{0}<x_{1}<\dots<x_{n}=b$，使得在每一个子区间$(x_{i-1},x_{i}),i=1,2,\dots n$上，$p$为常值函数，则称$p$为$[a,b]$上的阶梯函数.又设$f(x)$在$[a,b]$上Riemann可积，证明：$\forall \varepsilon>0,$存在$[a,b]$上的阶梯函数$p,q$，使得在$[a,b]$上有$p\leqslant f\leqslant q$，并且$\displaystyle\int_{a}^{b} [q(x)-p(x)] \, \mathrm{d}x<\varepsilon$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
设$f(x)\in R[a,b]$.试证：$\forall \varepsilon>0,\exists p,q\in C[a,b],s.t.p(x)\leqslant f(x)\leqslant q(x)\quad(x\in[a,b]),\displaystyle\int_{a}^{b} [q(x)-p(x)] \, \mathrm{d}x<\varepsilon$


#### 2.3.4 关于积分的常见问题

>[!note] 
>有关积分有以下几类问题：
>- A：积分值的估计
>	- A1：利用Darboux和估计积分值
>	- A2：利用变形求估计及积分估计的应用(利用变量替换、分部积分、缩放被积函数或积分区间、微分中值定理或Taylor公式进行变形)
>- B：积分不等式
>	- B1：用微分学方法证明积分不等式
>	- B2：利用被积函数的不等式证明积分不等式
>	- B3：在不等式两边取变限积分证明积分不等式
>- C：其它问题
>	- C1：综合问题
>	- C2：用积分解函数方程
>	- C3：凸函数的积分性质
>- D：技巧性问题
>	- D1：单调性
>	- D2：对称性
>	- D3：求导变成微分方程
>	- D4：极值原理
>	- D5：被积函数零点问题
>	- D6：对数导数


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. (A2) </span>
设$f(x)$在$[0,1]$上有二阶连续导数，
1)$f(0)=f(1)=0,f(x)\neq0\quad(x\in(0,1))$，试证：$\displaystyle\int_{0}^{1} |\frac{f''(x)}{f(x)}| \, \mathrm{d}x\geqslant4$
2)$f(0)=f(1)=0$，试证：$\displaystyle\int_{0}^{1} |f'(x)| \, \mathrm{d}x\leqslant\displaystyle\int_{0}^{1} |f''(x)| \, \mathrm{d}x+2\displaystyle\int_{0}^{1} |f(x)| \, \mathrm{d}x$
3)试证：$\displaystyle\int_{0}^{1} |f'(x)| \, \mathrm{d}x\leqslant\displaystyle\int_{0}^{1} |f''(x)| \, \mathrm{d}x+8\displaystyle\int_{0}^{1} |f(x)| \, \mathrm{d}x$
4)试证：$\max\limits_{x\in[0,1]}|f'(x)|\leqslant|f(1)-f(0)|+\displaystyle\int_{0}^{1} |f''(x)| \, \mathrm{d}x$


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. (A2) </span>
设$f(x)$二次可微，试证明：$\exists \xi\in(a,b),s.t.f''(\xi)= \frac{24}{(b-a)^3}\displaystyle\int_{a}^{b} \left( f(x)-f\left( \frac{a+b}{2} \right) \right) \, \mathrm{d}x$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. (B2) </span>
函数$f(x)$在$[0,1]$上单调不增，试证：$\forall\alpha\in(0,1):\displaystyle\int_{0}^{\alpha} f(x) \, \mathrm{d}x\geqslant\alpha \displaystyle\int_{0}^{1} f(x) \, \mathrm{d}x$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. (B2) </span>
设$f'(x)\in C[a,b]$，试证：$\max\limits_{a\leqslant x\leqslant b}|f(x)|\leqslant| \frac{1}{b-a}\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x|+\displaystyle\int_{a}^{b} |f'(x)| \, \mathrm{d}x$


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. (C1) </span>
设$f(x)$在$(0,+\infty)$上单调不减，且$\forall A>0:f(x)\in R[0,A]$。试证明：$\lim_\limits{ x \to +\infty } \frac{1}{x}\displaystyle\int_{0}^{x} f(t) \, \mathrm{d}t=C \Longleftrightarrow \lim_\limits{ x \to +\infty }f(x)=C$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. (D2) </span>
设$f(x)\in C[a,b]\uparrow$，则成立不等式：$\displaystyle\int_{a}^{b} xf(x) \, \mathrm{d}x\geqslant \frac{a+b}{2}\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$


<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. (D5) </span>
设$f(x)\in C[0,\pi],\displaystyle\int_{0}^{\pi} f(x) \, \mathrm{d}x=0,\displaystyle\int_{0}^{\pi} f(x)\cos x \, \mathrm{d}x=0$，试证：$\exists \xi_{1},\xi_{2}\in(0,\pi),s.t.f(\xi_{1})=f(\xi_{2})=0$



### 2.4 定积分的计算
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:换元积分</span>
>设$f(x)\in C[a,b]$，$x=\varphi(t),\varphi'(t)\in R[\alpha,\beta]$，且$\varphi([\alpha,\beta])\subset[a,b],\varphi(\alpha)=a,\varphi(\beta)=b$，则$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=\displaystyle\int_{\alpha}^{\beta} f(\varphi(t))\varphi'(t) \, \mathrm{d}t$
>
>**Corollary** 如果将$f(x)\in C[a,b]$改为$f(x)\in R[a,b]$，需要把$\varphi([\alpha,\beta])\subset[a,b],\varphi(\alpha)=a,\varphi(\beta)=b$改为$\varphi(t)$在$[\alpha,\beta]$上严格单增，且$\varphi(\alpha)=a,\varphi(\beta)=b$
>
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:分部积分</span>
>设$u'(x),v'(x)\in R[a,b]$，则$\displaystyle\int_{a}^{b} u(x) \, \mathrm{d}v(x)=u(x)v(x)\big|_{a}^b-\displaystyle\int_{a}^{b} v(x) \, \mathrm{d}u(x)$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
用广义Newton-Leibniz公式证明即可


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:积分的对称性</span>
>1)(偶函数)设$f(x)\in R[0,a],f(x)=f(a-x)$，则有：$\displaystyle\int_{0}^{a} f(x) \, \mathrm{d}x=2\displaystyle\int_{0}^{ \frac{a}{2}} f(x) \, \mathrm{d}x$
>2)(奇函数)设$f(x)\in R[0,a],f(x)=-f(a-x)$，则有：$I=\displaystyle\int_{0}^{a} f(x) \, \mathrm{d}x=0$
>3)设$f(x)\in R[0,a],f(x)+f(a-x)=g(x)$，则有：$\displaystyle\int_{0}^{a} f(x) \, \mathrm{d}x=\displaystyle\int_{0}^{ \frac{a}{2}} g(x) \, \mathrm{d}x$(事实上，$f(x)+f(a-x)$关于点$x=\frac{a}{2}$总是偶函数)


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:积分的周期性</span>
>设$f(x)$是以$T$为周期的可积函数，则$\forall a:\displaystyle\int_{a}^{a+T} f(x) \, \mathrm{d}x=\displaystyle\int_{0}^{T} f(x) \, \mathrm{d}x$


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:积分作为上下限的函数</span>
>若$f(x)\in C_{I},\psi(x),\varphi(x)\in D_{I}$，则$F(x)\equiv \displaystyle\int_{\varphi(x)}^{\psi(x)} f(t) \, \mathrm{d}t\in D_{I}$，且$F'(x)=f(\psi(x))\psi'(x)-f(\varphi(x))\varphi'(x)\quad(x\in I)$



### 2.5 积分不等式

><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:积分不等式</span>
>**Hadamard不等式** 设$f(x)$是$(a,b)$上的下凸函数，则对于每一对$x_{1},x_{2}\in(a,b),x_{1}<x_{2}$，有：$f\left( \frac{x_{1}+x_{2}}{2} \right)\leqslant \frac{1}{x_{2}-x_{1}}\displaystyle\int_{x_{1}}^{x_{2}} f(t) \, \mathrm{d}t\leqslant \frac{f(x_{1})+f(x_{2})}{2}$
>**Schwarz不等式** 设$f(x),g(x)\in R[a,b]$，则$\left( \displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x \right)^2\leqslant \displaystyle\int_{a}^{b} f^2(x) \, \mathrm{d}x \displaystyle\int_{a}^{b} g^2(x) \, \mathrm{d}x$
>**Hölder不等式** 设$f(x),g(x)\in R[a,b]$，$p,q$为共轭数(即$p>0,q>0, \frac{1}{p}+\frac{1}{q}=1$)，则有：$\displaystyle\int_{a}^{b} |f(x)g(x)| \, \mathrm{d}x\leqslant\left( \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x \right)^{\frac{1}{p}}\left(\displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x  \right)^{\frac{1}{q}}$
>**Young不等式** 设$y=f(x)\in C[0,+\infty)$，且严格单调增加，且$f(0)=0$，记它的反函数为$x=f^{-1}(y)$，则有：$\displaystyle\int_{0}^{a} f(x) \, \mathrm{d}x+\displaystyle\int_{0}^{b} f^{-1}(y) \, \mathrm{d}y\geqslant ab\quad(a>0,b>0)$
>**Schwarz不等式** 设$f(x),g(x)\in R[a,b]$，则$\left[ \displaystyle\int_{a}^{b} f(x)g(x) \, \mathrm{d}x \right]^2\leqslant \displaystyle\int_{a}^{b} f^2(x) \, \mathrm{d}x+\displaystyle\int_{a}^{b} g^2(x) \, \mathrm{d}x$
>**Minkowski不等式** 设$f(x),g(x)\in R[a,b]$，则$\left\{  \displaystyle\int_{a}^{b} [f(x)+g(x)]^2 \, \mathrm{d}x  \right\}^{\frac{1}{2}}\leqslant \left[ \displaystyle\int_{a}^{b} f^2(x) \, \mathrm{d}x \right]^{\frac{1}{2}}+\left[ \displaystyle\int_{a}^{b} g^2(x) \, \mathrm{d}x \right]^{\frac{1}{2}}$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
**Hölder不等式**
当$f(x)\equiv0$或$g(x)\equiv0$时，上式显然成立
否则，令
$\varphi(x)= \frac{|f(x)|}{\left( \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x \right)^{\frac{1}{p}}},\psi(x)= \frac{|g(x)|}{\left( \displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x \right)^{\frac{1}{q}}},x\in[a,b]$
由保序性推论，$\displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x,\displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x$均大于0
由Hölder不等式普通形式：$ab\le \frac{1}{p}a^p+ \frac{1}{q}b^q$，有:$\varphi(x)\psi(x)\leqslant \frac{1}{p}\varphi(x)^p+ \frac{1}{q}\psi(x)^q$
即$\frac{|f(x)g(x)|}{\left( \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x \right)^{\frac{1}{p}}\left( \displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x \right)^{\frac{1}{q}}}\leqslant\frac{|f(x)|^p}{p \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x}+\frac{|g(x)|^q}{q \displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x},x\in[a,b]$
两边在$[a,b]$上求积分，利用定积分的性质得：
$\frac{1}{\left( \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x \right)^{\frac{1}{p}}\left( \displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x \right)^{\frac{1}{q}}}\displaystyle\int_{a}^{b} |f(x)g(x)| \, \mathrm{d}x\leqslant\frac{\displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x}{p \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x}+\frac{\displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x}{q \displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x}= \frac{1}{p}+ \frac{1}{q}=1$
两边同时乘以$\left( \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x \right)^{\frac{1}{p}}\left( \displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x \right)^{\frac{1}{q}}$，有：
$\displaystyle\int_{a}^{b} |f(x)g(x)| \, \mathrm{d}x\leqslant\left( \displaystyle\int_{a}^{b} |f(x)|^p \, \mathrm{d}x \right)^{\frac{1}{p}}\left(\displaystyle\int_{a}^{b} |g(x)|^q \, \mathrm{d}x  \right)^{\frac{1}{q}}$


### 2.6 定积分的应用
#### 2.6.1 弧长
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：弧长」</span>
> 设$C=\overset{\frown}{AB}$为$\mathbb{R}^2$中的曲线，在C上依次从A到B取分点：$A=P_{0},P_{1},\dots P_{n}=B$，它们成为对曲线C的一个分割，记为T
> 然后，用线段联结T中每相邻两点得到C的n条弦$\overline{P_{i-1}P_{i}}(i=1,2,\dots n)$，这n条弦又组成C的一条内接折线
> 记$||T||=\max\limits_{1\leqslant i\leqslant n}|P_{i-1}P_{i}|,s_{T}=\sum\limits_{i=1}^{n}|P_{i-1}P_{i}|$，它们分别表示最长弦的长度和折线的总长度
> 如果$\lim_\limits{ ||T|| \to 0 }s_{T}=s$，即$\forall \varepsilon>0,\exists\delta>0,\forall||T||<\delta:|s_{T}-s|<\varepsilon$，则称C是可求长的，并把极限s称为曲线C的弧长
> 
> <span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:可求长的充分条件</span>
> 设$\mathbb{R}^2$中的曲线C由参数方程$(x,y)=(x(t),y(t)),\quad t\in[\alpha,\beta]$给出，并且它是一条$C^1$光滑的正则曲线(即$x(t),y(t)$均连续可导，且$x'^2(t)+y'^2(t)\neq0$，满足此条件的曲线C称为正则点)，则C是可求长的，且弧长为$s=\displaystyle\int_{\alpha}^{\beta} \sqrt{ x'^2(t)+y'^2(t) } \, \mathrm{d}t$



## 3 反常积分

### 3.1 无穷积分与瑕积分
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：无穷积分」</span>
> 设函数$f(x)$在$[a,+\infty)$上有定义，且在任意有限区间$[a,A]\subset[a,+\infty)$上可积，若极限$\lim_\limits{ A \to +\infty }\displaystyle\int_{a}^{A} f(x) \, \mathrm{d}x$存在，则称反常积分$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛(或称$f(x)$在$[a,+\infty)$上可积)，其积分值为$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x=\lim_\limits{ A \to +\infty }\displaystyle\int_{a}^{A} f(x) \, \mathrm{d}x$，否则称它发散
> >[!note] 
> >只有当$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$和$\displaystyle\int_{-\infty}^{a} f(x) \, \mathrm{d}x$都收敛时，$\displaystyle\int_{-\infty}^{+\infty} f(x) \, \mathrm{d}x$才收敛
>  
>  <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：瑕积分」</span>
>  设函数$f(x)$在$x=b$的左邻域无界，若对于任意$\eta\in(0,b-a)$，$f(x)$在$[a,b-\eta]$上有界可积，且极限$\lim_\limits{ \eta \to 0^+ }\displaystyle\int_{a}^{b-\eta} f(x) \, \mathrm{d}x$存在，则称反常积分$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$收敛(或称无界函数$f(x)$在$[a,b]$上可积)，其积分值为$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x=\lim_\limits{ \eta \to 0^+ }\displaystyle\int_{a}^{b-\eta} f(x) \, \mathrm{d}x$，否则称反常积分$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$发散
>  
>  >[!note] 
>  >无穷区间上的反常积分和无界函数的反常积分往往是可以相互转换的

>[!note] 
>对于反常积分，线性性、保序性、区间可加性仍然成立，但是乘积可加性不再成立


> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：Cauchy主值」</span>
> 若$\lim_\limits{ A \to +\infty }\displaystyle\int_{-A}^{A} f(x) \, \mathrm{d}x=\lim_\limits{ A \to +\infty }[F(A)-F(-A)]$收敛，则称该极限值为Cauchy主值，记为$(\mathrm{cpv})\displaystyle\int_{-\infty}^{+\infty} f(x) \, \mathrm{d}x$
> 当$\displaystyle\int_{-\infty}^{+\infty} f(x) \, \mathrm{d}x$收敛时，有：$\displaystyle\int_{-\infty}^{+\infty} f(x) \, \mathrm{d}x=(\mathrm{cpv})\displaystyle\int_{-\infty}^{+\infty} f(x) \, \mathrm{d}x$
> 但是当$\displaystyle\int_{-\infty}^{+\infty} f(x) \, \mathrm{d}x$发散时，它的Cauchy主值仍有可能存在


### 3.2 反常积分审敛法
> <span style='background-image: linear-gradient(120deg, #89f7fe 0%, #66a6ff 100%);font-size:1.5em;font-style:normal;padding:2px;font-family:方正龙爪简体;font-weight:bold;border-radius:0 10px 0 0;box-shadow: 2px 2px 5px 3px #ccc;'>「Definition：绝对收敛与条件收敛」</span>
> 设$f(x)\in R[a,A]\subset[a,+\infty)$，且$\displaystyle\int_{a}^{+\infty} |f(x)| \, \mathrm{d}x$收敛，则称$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$绝对收敛(或称$f(x)$在$[a,+\infty)$上绝对可积)
> 若$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛而不绝对收敛，则称$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$条件收敛

#### 3.2.1 无穷积分
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Cauchy准则</span>
>无穷积分$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛的充要条件是$\forall \varepsilon>0,\exists A_{0}>\max\{ a,0 \},\forall A',A''>A_{0}:|\displaystyle\int_{a}^{A'} f(x) \, \mathrm{d}x-\displaystyle\int_{a}^{A''} f(x) \, \mathrm{d}x|=|\displaystyle\int_{A'}^{A''} f(x) \, \mathrm{d}x|<\varepsilon$
>
>由此可得，若$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$绝对收敛，那么它一定收敛

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
令$F(A)=\displaystyle\int_{a}^{A} f(x) \, \mathrm{d}x$，则：
$\begin{align}\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x收敛&\Longleftrightarrow \lim_\limits{ A \to +\infty }\displaystyle\int_{a}^{A} f(x) \, \mathrm{d}x=\lim_\limits{ A \to +\infty }F(A)存在且有限\\&\Longleftrightarrow \forall\varepsilon>0,\exists A_{0}>\max\{ a,0 \},\forall A',A''>A_{0}:|\displaystyle\int_{a}^{A'} f(x) \, \mathrm{d}x-\displaystyle\int_{a}^{A''} f(x) \, \mathrm{d}x|=|\displaystyle\int_{A'}^{A''} f(x) \, \mathrm{d}x|<\varepsilon\end{align}$
证毕

>[!example] 
>==p积分==
>对于反常积分$\displaystyle\int_{1}^{+\infty} \frac{1}{x^p} \, \mathrm{d}x$，
>当$p>1$时，收敛于$\frac{1}{p-1}$；当$p\leqslant1$时，发散
>
>对于反常积分$\displaystyle\int_{0}^{1} \frac{1}{x^p} \, \mathrm{d}x$，
>当$p<1$时，收敛于$\frac{1}{1-p}$；当$p\geqslant1$时，发散


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:比较判别法</span>
>设在$[a,+\infty)$上恒有$0\leqslant f(x)\leqslant Kg(x)$(K为正常数)，则：
>1)当$\displaystyle\int_{a}^{+\infty} g(x) \, \mathrm{d}x$收敛时，$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$也收敛
>2)当$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$发散时，$\displaystyle\int_{a}^{+\infty} g(x) \, \mathrm{d}x$也发散
>
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:极限形式</span>
>设在$[a,+\infty)$上恒有$f(x)\geqslant0,g(x)\geqslant0$，且$\lim_\limits{ x \to +\infty } \frac{f(x)}{g(x)}=l$则：
>1)若$0\leqslant l<+\infty$，则当$\displaystyle\int_{a}^{+\infty} g(x) \, \mathrm{d}x$收敛时，$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$也收敛
>2)若$0<l\leqslant+\infty$，则当$\displaystyle\int_{a}^{+\infty} g(x) \, \mathrm{d}x$发散时，$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$也发散
>亦即，若$0< l<+\infty$，$\displaystyle\int_{a}^{+\infty} g(x) \, \mathrm{d}x$与$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$同时收敛和发散
>
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:与p积分比较</span>
>设在$[a,+\infty)\subset(0,+\infty)$上恒有$f(x)\geqslant0$，则：
>1)若$f(x)\leqslant \frac{K}{x^p}$，且$p>1$，则$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛
>2)若$f(x)\geqslant\frac{K}{x^p}$，且$p\leqslant1$，则$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$发散
>
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:极限形式</span>
>设在$[a,+\infty)\subset(0,+\infty)$上恒有$f(x)\geqslant0$且$\lim_\limits{ x \to +\infty }x^pf(x)=l$，则：
>1)若$0\leqslant l<+\infty$，且$p>1$，则$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛
>2)若$0<l\leqslant+\infty$，且$p\leqslant1$，则$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$发散


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Abel-Dirichlet判别法</span>
>若下列两条件之一满足，则$\displaystyle\int_{a}^{+\infty} f(x)g(x) \, \mathrm{d}x$收敛：
>1)$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛，$g(x)$在$[a,+\infty)$上单调有界
>2)$F(A)=\displaystyle\int_{a}^{A} f(x) \, \mathrm{d}x$在$[a,+\infty)$上有界，$g(x)$在$[a,+\infty)$上单调且$\lim_\limits{ x \to +\infty }g(x)=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof ：</span>
**Abel**
设$|g(x)|<M(\forall x\in[a,+\infty))$
由于$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛，$\forall \varepsilon>0,\exists A_{0}>\max\{ a,0 \},\forall A''>A'>A_{0}:|\displaystyle\int_{A'}^{A''} f(x) \, \mathrm{d}x|< \frac{\varepsilon}{2M}$
因此，由一般形式的积分第二中值定理得：$\exists \xi\in[A',A''],s.t.$
$\begin{align}|\displaystyle\int_{A'}^{A''} f(x)g(x) \, \mathrm{d}x|&=|g(A')\displaystyle\int_{A'}^{\xi} f(x) \, \mathrm{d}x+g(A'')\displaystyle\int_{\xi}^{A''} f(x) \, \mathrm{d}x|\\&\leqslant|g(A')||\displaystyle\int_{A'}^{\xi} f(x) \, \mathrm{d}x|+|g(A'')||\displaystyle\int_{\xi}^{A''} f(x) \, \mathrm{d}x|\\&< M\cdot \frac{\varepsilon}{2M}+M\cdot \frac{\varepsilon}{2M}=\varepsilon\end{align}$
由Cauchy收敛准则，$\displaystyle\int_{a}^{+\infty} f(x)g(x) \, \mathrm{d}x$收敛

**Dirichlet**
与Abel判别法类似

#### 3.2.2 瑕积分
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Cauchy准则</span>
>瑕积分$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$收敛的充要条件是$\forall \varepsilon>0,\exists \delta>0,\forall \eta',\eta''\in(0,\delta):|\displaystyle\int_{a}^{b-\eta'} f(x) \, \mathrm{d}x-\displaystyle\int_{a}^{b-\eta''} f(x) \, \mathrm{d}x|=|\displaystyle\int_{b-\eta'}^{b-\eta''} f(x) \, \mathrm{d}x|<\varepsilon$



><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:与p积分比较</span>
>设在$[a,b)$上恒有$f(x)\geqslant0$，若当$x$属于$b$的某个左邻域$[b-\eta_{0},b]$时，存在正常数$K$，使得：
>1)$f(x)\leqslant \frac{K}{(b-x)^p}$，且$p<1$，则$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$收敛
>2)$f(x)\geqslant \frac{K}{(b-x)^p}$，且$p\geqslant1$，则$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$发散
>
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:极限形式</span>
>设在$[a,b)$上恒有$f(x)\geqslant0$，且$\lim_\limits{ x \to b^-}(b-a)^pf(x)=l$，则：
>1)若$0\leqslant l<+\infty$，且$p<1$，则$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$收敛
>2)若$0<l\leqslant+\infty$，且$p\geqslant1$，则$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$发散


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Abel-Dirichlet判别法</span>
>若下列两条件之一满足，则$\displaystyle\int_{a}^{+\infty} f(x)g(x) \, \mathrm{d}x$收敛：
>1)$\displaystyle\int_{a}^{b} f(x) \, \mathrm{d}x$收敛，$g(x)$在$[a,b)$上单调有界
>2)$F(\eta)=\displaystyle\int_{a}^{b-\eta} f(x) \, \mathrm{d}x$在$(0,b-a]$上有界，$g(x)$在$[a,b)$上单调且$\lim_\limits{ x \to b^- }g(x)=0$

### 3.3 特殊公式与积分
><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Wallis公式</span>
>$\lim_\limits{ n \to \infty } \frac{1}{2n+1}\left[ \frac{2\cdot4\cdots(2n)}{1\cdot3\cdots(2n-1)} \right]^2= \frac{\pi}{2}$
>等价形式：$\frac{(2n)!!}{(2n-1)!!}\sim \sqrt{ \pi n },\quad \frac{(n!)^22^{2n}}{(2n)!}\sim \sqrt{ \pi n }$


><span style='font-family:汉仪劲楷简 Regular,Stem;font-style: normal;font-weight: bold;color: #242424;text-decoration: none;text-shadow: 1px 1px 1px #eeece1;font-size:1.5em;background-image: linear-gradient(to right, #92fe9d 0%, #00c9ff 100%);border-radius:7px;box-shadow: 1px 1px 29px rgb(204, 204, 204, 0.68);padding:3px;'>Theorem:Stirling公式</span>
>$\ln n!=\ln \sqrt{ 2\pi }+\left( n+\frac{1}{2} \right)\ln n-n+ \frac{B_{2}}{1\cdot2n}+\frac{B_{4}}{3\cdot4n^3}+\dots+\frac{B_{2m}}{(2m-1)(2m)n^{2m-1}}+\theta_{n} \frac{B_{2m+2}}{(2m+1)(2m+2)n^{2m+1}}$
>等价形式：$n!\sim \sqrt{ 2\pi n }\left( \frac{n}{e} \right)^n\quad(n\to +\infty)$



<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1(Euler Integral) </span>
$I=\displaystyle\int_{0}^{\frac{\pi}{2}} \ln \sin x \, \mathrm{d}x$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2(Froullani Integral) </span>
$f(x)\in C[0,+\infty)$，极限$f(+\infty)$存在且有限，$0<a<b$，计算积分：$\displaystyle\int_{0}^{+\infty} \frac{f(ax)-f(bx)}{x} \, \mathrm{d}x$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3(Dirichlet Integral) </span>
$\displaystyle\int_{0}^{+\infty} \frac{\sin x}{x} \, \mathrm{d}x= \frac{\pi}{2}$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 4(Euler-Poisson Integral) </span>
$\displaystyle\int_{0}^{+\infty} e^{-t^2} \, \mathrm{d}t= \frac{\sqrt{ \pi }}{2}$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 5(Poisson Integral) </span>
$\displaystyle\int_{-\pi}^{\pi} \frac{1-r^2}{1-2r\cos x+r^2} \, \mathrm{d}x,\quad(0<r<1)$


### 3.4 收敛无穷积分的被积函数在无穷远处的性质
<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 1 </span>
设$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛，且$\lim_\limits{ x \to +\infty}f(x)$有意义，则它一定等于0

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 2 </span>
设$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛，且被积函数$f(x)$在$[a,+\infty)$上一致连续，则$\lim_\limits{ x \to +\infty }f(x)=0$

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 1：</span>
反正，如果$\lim_\limits{ x \to +\infty }f(x)\neq0$
即$\exists\varepsilon_{0}>0,\forall A>0,\exists x_{1}>A:|f(x_{1})|>\varepsilon_{0}$
由于$f(x)$在$[a,+\infty)$上一致连续，对于$\frac{\varepsilon_{0}}{2},\exists\delta>0,\forall x',x''(|x'-x''|<\delta):|f(x')-f(x'')|< \frac{\varepsilon_{0}}{2}$
因此，当$x\in[x_{1},x_{1}+\delta]$时，有$|f(x)|\geqslant||f(x_{1})|-|f(x_{1})-f(x)||> \frac{\varepsilon_{0}}{2}$
且$f(x)$与$f(x_{1})$同号(否则$|f(x)-f(x_{1})|>\delta$，矛盾)
不妨设$f(x),f(x_{1})>0$，从而$f(x)> \frac{\varepsilon_{0}}{2}$，因此：
$|\displaystyle\int_{x_{1}}^{x_{1}+\delta} f(x) \, \mathrm{d}x|\geqslant \frac{\varepsilon_{0}}{2}\displaystyle\int_{x_{1}}^{x_{1}+\delta}  \, \mathrm{d}x= \frac{\varepsilon_{0}}{2}\delta$
由Cauchy收敛准则，$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$发散，矛盾

<span style='color:#434343;background-image: linear-gradient(-20deg, #e9defa 0%, #fbfcdb 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'>Proof 2：</span>



<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 3 </span>
设$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x,\displaystyle\int_{a}^{+\infty} f'(x) \, \mathrm{d}x$收敛且$f(x)$连续可微，则$\lim_\limits{ x \to +\infty }f(x)=0$

<span style='color:#434343;background-image: linear-gradient(45deg, #93a5cf 0%, #e4efe9 100%);border-radius:7px;box-shadow: 1px 1px 30px 5px rgb(204, 204, 204, 0.52);font-family:Monotype Corsiva;font-size:2em;'> eg. 4 </span>
设$\displaystyle\int_{a}^{+\infty} f(x) \, \mathrm{d}x$收敛，
1)$f(x)$在$[a,+\infty)$单调下降，试证：$\lim_\limits{ x \to +\infty}xf(x)=0$
2)$xf(x)$在$[a,+\infty)$单调下降，试证：$\lim_\limits{ x \to +\infty}xf(x)\ln x=0$


